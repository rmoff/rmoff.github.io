<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>OBIEE and Load Runner - part 2</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2009/08/21/obiee-and-load-runner-part-2/">
		
		
		
		
		
		<meta property="og:title" content="OBIEE and Load Runner - part 2" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/img/default-header-img.jpg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2009/08/21/obiee-and-load-runner-part-2/" />
		<meta property="og:site_name" content="OBIEE and Load Runner - part 2" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<link rel="stylesheet" href="https://rmoff.net/css/tachyons.min.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/story.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/descartes.css" />
		
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans:400,400i,700,700i|Quattrocento:400,700|Spectral:400,400i,700,700i&amp;subset=latin-ext" rel="stylesheet">
		

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		
		<script src="https://rmoff.net/js/story.js"></script>

	</head>
	<body class="ma0 bg-white section-post page-kind-page is-page-true ">
		
		<header class="cover bg-top" style="background-image: url('https://rmoff.net/img/default-header-img.jpg'); background-position: center;">
			<div class="bg-black-30 bb bt">

				<nav class="hide-print sans-serif  border-box pa3 ph5-l">
					<a href="https://rmoff.net" title="Home">
						<img src="https://rmoff.net/img/logo.jpg" class="w2 h2 br-100" alt="rmoff&#39;s random ramblings" />
					</a>
					<div class="fr h2 pv2 tr">
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net/bio">about</a>
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net">talks</a>
						<a class="link f5 ml2 dim near-white" href="https://www.youtube.com/c/rmoff"><i class="fab fa-youtube-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://data-folks.masto.host/@rmoff"><i class="fab fa-mastodon"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://twitter.com/rmoff/"><i class="fab fa-twitter-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://github.com/rmoff/"><i class="fab fa-github-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://www.linkedin.com/in/robinmoffatt/"><i class="fab fa-linkedin"></i></a>
						<a class="link f5 ml2 dim near-white fas fa-rss-square" href="https://rmoff.net/index.xml" title="RSS Feed"></a>
						<a class="link f5 ml2 dim near-white fas fa-search" href="https://rmoff.net/search/" role="search" title="Search"></a>
					</div>
				</nav>

				<div id="hdr" class="tc-l pv4-ns pv5-l pv2 ph3 ph4-ns">
					<h1 class="near-white mt1-ns f2 fw3 mb0 mt0 lh-title">OBIEE and Load Runner - part 2</h1>
					<h2 class="near-white mt3-l mb4-l fw1 f6 f3-l measure-wide-l center lh-copy mt2 mb3">
						
						
							
								Published
								<time datetime="2009-08-21T00:00:00Z">Aug 21, 2009</time>
								<span class="display-print">by </span>
								 in <a href="https://rmoff.net/categories/loadrunner" class="no-underline category near-white dim">Loadrunner</a>, <a href="https://rmoff.net/categories/obiee" class="no-underline category near-white dim">Obiee</a>, <a href="https://rmoff.net/categories/performance" class="no-underline category near-white dim">Performance</a>, <a href="https://rmoff.net/categories/sawserver" class="no-underline category near-white dim">Sawserver</a>
								<span class="display-print">at https://rmoff.net/2009/08/21/obiee-and-load-runner-part-2/</span>
							
						
					</h2>
				</div>

				
				
				
				

			</div>
		</header>
		
		<main role="main">
		
<article class="center bg-white br-3 pv1 ph4 lh-copy f5 nested-links mw8">
	<p><strong>UPDATED: See a HOWTO for OBIEE and LoadRunner here: <a href="/2009/10/01/performance-testing-obiee-using-hp-performance-center-a.k.a.-loadrunner/">/2009/10/01/performance-testing-obiee-using-hp-performance-center-a.k.a.-loadrunner/</a></strong></p>
<hr>
<p>This is following on from <a href="/2009/08/19/obiee-and-load-runner-part-1/">my first post about OBIEE and LoadRunner</a>, in which I failed dismally to get a simple session replaying.</p>
<p>In a nutshell where I&rsquo;d got to was using the &ldquo;Web (Click and Script)&rdquo; function which worked fine for logging in but when running a report resulted in an error on the rendered page. Digging around showed the error was from the javascript of the OBIEE front end.</p>
<p>AJAX (Asynchronous Javascript And XML) is a combination of technologies but in essence lets a web page load once whilst refreshing its contents with calls back to the web server. In the context of OBIEE this means a dashboard page can load with placeholders for reports and as the data comes back (from the datasource via the BI Server and then parsed through sawserver) each dashboard report can update immediately, without the whole webpage reloading. I&rsquo;m sure this is where the problem lies with LoadRunner, and it&rsquo;s going to be important to get it right otherwise the numbers we get out won&rsquo;t be reliable.</p>
<p>I checked Metalink 3 for any entries and <a href="https://metalink3.oracle.com/od/faces/secure/km/DocumentDisplay.jspx?id=496417.1">Doc 496417.1</a> says that LoadRunner&rsquo;s been used with OBIEE successfully before..</p>
<p>VUGen (LoadRunner Virtual User Generator) offers several protocols. I&rsquo;d been working with &ldquo;Web (Click and Script)&rdquo; but after a fair bit of Googling tried &ldquo;AJAX (Click and Script)&rdquo; which didn&rsquo;t work any better, and then &ldquo;Web (HTTP/HTML)&rdquo;.</p>
<p>In the Options dialog prior to Recording there are some Siebel correlations defined including one called Siebel_Analytic_ViewState. Correlation is how LoadRunner deals with a data in a session that is passed back to the server in a subsequent step. For example, at login a user might get a sessionID of some sort which the web server requires in any subsequent calls back. LoadRunner can automatically detect some of these, and you have to define the rest. The correlations I picked up were:</p>
<ul>
<li>_scid</li>
<li>ViewState</li>
</ul>
<p>The replay still wasn&rsquo;t working properly, the replay screenshots showed this error: <img src="/images/rnm1978/invalidstate.png" alt="invalidstate" title="invalidstate"></p>
<p>Using Fiddler2 again to analyse the traffic showed this pattern of requests/responses:</p>
<p>saw.dll?Dashboard This is the main dashboard with placeholders for content saw.dll?DocPart&amp;_scid=3QNnUBQ3IJo&amp;StateID=943636977 this is a dashboard flash component saw.dll?DocPart&amp;_scid=3QNnUBQ3IJo&amp;StateID=943636978 this is a dashboard flash component saw.dll?DocPart&amp;_scid=3QNnUBQ3IJo&amp;StateID=943636979 this is a dashboard flash component saw.dll?DocPart&amp;_scid=3QNnUBQ3IJo&amp;StateID=943636980 this is a dashboard flash component</p>
<p>The StateID in the URL is embedded in the dashboard template, and is unique so can&rsquo;t be hardcoded in the VUser script. The script as recorded is hardcoding these numbers and thus requesting flash charts from a dashboard query long-gone, hence the very true &ldquo;invalid state identifier&rdquo;</p>
<p>LoadRunner has a feature called ContentCheck (accessed from the Run-time Settings dialog) which can be configured to halt the test if pre-defined text is found, so I added &ldquo;invalid state identifier&rdquo; and &ldquo;! Error : Response from server contained an error&rdquo; into it and clicked the Set as Default so they&rsquo;d come up for each script from now [edit] this doesn&rsquo;t fire for &ldquo;! Error : Response from server contained an error&rdquo;, maybe because it&rsquo;s inserted through ajax rather than the HTML response? [/edit] <img src="/images/rnm1978/contentcheck.png" alt="contentcheck" title="contentcheck"></p>
<p>After tinkering around a bit more I recorded another VUser, using &ldquo;Web (Click and Script)&rdquo; but on the Recording Options screen set it to URL mode instead of GUI. This captured <strong>all</strong> of the content requests (css, js, gif, etc), and gave a better replay: <img src="/images/rnm1978/replay03.png" alt="replay03" title="replay03"></p>
<p>The Help text explains:</p>
<ul>
<li>&ldquo;..GUI-based script option instructs VuGen to record HTML actions as context sensitive GUI functions such as web_text_link&hellip;&rdquo;</li>
<li>&ldquo;..URL-based script mode option instructs VuGen to record all browser requests and resources from the server that were sent due to the user&rsquo;s actions. It automatically records every HTTP resource as URL steps (web_url statements). For normal browser recordings, it is not recommended to use <em>the URL-based mode since is more prone to correlation related issues</em>&hellip;&rdquo;</li>
</ul>
<p>(my emphasis)</p>
<p>Looking at the script it&rsquo;s still got saw.dll?DocPart calls with a hardcoded StateID. This means that flash-content won&rsquo;t be being returned. To an extent this doesn&rsquo;t matter so long as it&rsquo;s still being generated (i.e. imposing the desired load on the server), but it&rsquo;s not a full simulation of user activity because there&rsquo;s less network traffic as a result.</p>
<p>So using the URL-based mode generates better results (i.e. no server error) but looks pretty much hardcoded to the specific scenario recorded. It&rsquo;s all very well getting a single dashboard working, but I want to simulate hundreds of users using tens of dashboards. In an ideal world I&rsquo;d define a login action with parametrised username/password, then a dashboard navigation / refresh action with a parametrised list of dashboard titles, and then a logout action.</p>
<p>With the caveat here that I have no training in LoadRunner, it appears to my untrained eye that the only way I&rsquo;m going to get repeatable, reusable scripts is using the GUI recording, that is, using the <strong>web_text_link</strong> function to simulate a user clicking, rather than the <strong>web_submit_data</strong> function which simulates the POST behaviour of ajax but is specific to the dashboard in question and needs some hardcore LR coding to correlate IDs embedded in the HTML with server requests to populate them.</p>
<p>Going back to the Click and Script (GUI Mode) and Fiddler2 I did a line-by-line comparison of the Fiddler-captured HTTP traffic between the recording session and replay. The login action was the same. The clicking onto the dashboard was as follows: <img src="/images/rnm1978/fiddler.png" alt="fiddler" title="fiddler"> This shows that the initial dashboard request works, and that the first &ldquo;ReloadDashboard&rdquo; ajax call correctly retrieves some of the data, but (a) this isn&rsquo;t &lsquo;rendered&rsquo; correctly, and (b) no further data is retrieved (there should be a second ReloadDashboard saw call, plus four flash charts). (<em>Fiddler&rsquo;s copy -&gt; full summary is useful for this, as is the breakpoint feature so you can pause after each response and see how it&rsquo;s rendered to determine what the content was.</em>)</p>
<p><strong>So</strong>, web_text_link is great for navigating but is the case that LR&rsquo;s replay engine doesn&rsquo;t honour the ajax sufficiently, and/or I&rsquo;m misunderstanding the principle of the tool? Using &ldquo;URL mode&rdquo; captures the ajax behaviour, eg:</p>
<p>[sourcecode language=&ldquo;html&rdquo;] web_submit_data(&ldquo;saw.dll_13&rdquo;, &ldquo;Action=http://myserver:7777/analytics/saw.dll?ReloadDashboard&amp;_scid={CSRule_1_UID2}&rdquo;, &ldquo;Method=POST&rdquo;, &ldquo;RecContentType=text/html&rdquo;, &ldquo;Referer=http://myserver:7777/analytics/saw.dll?Dashboard&amp;_scid={CSRule_1_UID2}&amp;PortalPath=/shared/Financials/_portal/General%20Ledger&amp;Page=Overview&amp;Action=RefreshAll&amp;ViewState={Siebel_Analytic_ViewState199}&amp;StateAction=samePageState&rdquo;, &ldquo;Snapshot=t96.inf&rdquo;, &ldquo;Mode=HTTP&rdquo;, ITEMDATA, &ldquo;Name=InFrameset&rdquo;, &ldquo;Value=false&rdquo;, ENDITEM, &ldquo;Name=Page&rdquo;, &ldquo;Value=Overview&rdquo;, ENDITEM, &ldquo;Name=_scid&rdquo;, &ldquo;Value={CSRule_1_UID2}&rdquo;, ENDITEM, &ldquo;Name=Embed&rdquo;, &ldquo;Value=true&rdquo;, ENDITEM, &ldquo;Name=PortalPath&rdquo;, &ldquo;Value=/shared/Financials/_portal/General Ledger&rdquo;, ENDITEM, &ldquo;Name=Caller&rdquo;, &ldquo;Value=Dashboard&rdquo;, ENDITEM, &ldquo;Name=ViewState&rdquo;, &ldquo;Value=tvr45qs2u7d1glbfaopqlvvinu&rdquo;, ENDITEM, &ldquo;Name=reloadTargets&rdquo;, &ldquo;Value=d:dashboard~p:d127730sp2eqcj54~r:ojn7k4k6te44d9ag&rdquo;, ENDITEM, &ldquo;Name=ajaxType&rdquo;, &ldquo;Value=iframe&rdquo;, ENDITEM, LAST); [/sourcecode]</p>
<p>but as you can see the POSTed data is full of IDs that I assume must correlate with the dashboard HTML. Given enough time and enough monkeys I&rsquo;m sure it would be possible to write a LR script that did this - but that would be with the net result of a <em>single</em> dashboard being replayable.</p>
<p>We can get a semblance of load testing on the database server by using web_text_link, but since the data coming back isn&rsquo;t rendered properly it&rsquo;s not possible to simulate a real user&rsquo;s session, only one-off hits of dashboards.</p>

</article>

		</main>
		
				<div class="hide-print sans-serif f6 f5-l mt5 ph3 pb6 center nested-copy-line-height lh-copy nested-links mw-100 measure-wide">
		<div class="about-the-author">
		
			
			
				
					<hr>
<p><img src="/images/2018/05/ksldn18-01.jpg" alt="Robin Moffatt"></p>
<p><a href="https://www.youtube.com/c/rmoff"><b class="fab fa-youtube-square"></b></a> <a href="https://www.linkedin.com/in/robinmoffatt/"><b class="fab fa-linkedin"></b></a> <em><a rel="me" href="https://data-folks.masto.host/@rmoff">Robin Moffatt</a> is a Principal DevEx Engineer at LakeFS. He likes writing about himself in the third person, eating good breakfasts, and drinking good beer.</em></p>

				
			
		
		</div>
		
	</div>

		
		
		
		<footer class="hide-print sans-serif f6 fw1 bg-black near-white bottom-0 w-100 pa3" role="contentinfo">
			<p class="w-50 fr tr">
			<a class="no-underline near-white" href="https://github.com/xaprb/story"><img class="dib" title="Made with Hugo and Story" alt="Story logo" src="https://rmoff.net/img/story-logo-white.svg" style="width: 1.5rem; height: 1.5rem" /></a>
			</p>
			<p class="w-50 near-white">
				&copy; 2023 
			</p>
		</footer>
		
	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-75492960-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

	
	</body>
</html>
