<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" as="image" href="https://rmoff.net/images/2024/10/why-cdc.png" >
		
		<title>Why Do I Need CDC?</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2024/10/15/why-do-i-need-cdc/">
		
		

		
		<meta property="og:title" content="Why Do I Need CDC?" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/images/2024/10/why-cdc.png" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2024/10/15/why-do-i-need-cdc/" />
		<meta property="og:site_name" content="Why Do I Need CDC?" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<style>
			html { background-color: #FAF8F5; color: #2D2926; }
			body { opacity: 0; transition: opacity 0.1s ease; }
			body.loaded { opacity: 1; }
			.site-header { height: 60px; background-color: #FAF8F5; border-bottom: 1px solid #E8421E; }
		</style>

		
		
		<link rel="stylesheet" href="https://rmoff.net/css/redesign.css" />
		
		<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap">
		<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
		<noscript><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet"></noscript>
		

		

		
		<script>
			!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
            posthog.init('phc_93NEP79Ju4xqXYWXnoLbr4HMW0Iaepj1BGOVoEXYX6P',{api_host:'https://eu.i.posthog.com', person_profiles: 'identified_only'})
		</script>

		
		<script src="https://rmoff.net/js/story.js"></script>
		<script src="https://rmoff.net/js/toc.js"></script>
		<script src="https://rmoff.net/js/medium-mirror.js"></script>
	</head>
	<body class="ma0 section-post page-kind-page is-page-true ">
		<script>document.body.classList.add('loaded');</script>

		<header class="site-header hide-print">
	<div class="site-header-inner">
		<a href="https://rmoff.net/" class="site-title">rmoff's random ramblings</a>
		<nav class="site-nav">
			<a href="/categories/interesting-links/" class="nav-il"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> Interesting Links</a>
			<span class="nav-sep"></span>
			<a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg> Categories</a>
			<a href="https://rmoff.net/search/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg> Search</a>
			<a href="https://rmoff.net/index.xml"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg> RSS</a>
			<div class="nav-social">
				<a href="https://www.linkedin.com/in/robinmoffatt/" title="linkedin"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
				<a href="https://twitter.com/rmoff/" title="twitter"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
				<a href="https://bsky.app/profile/rmoff.net" title="bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 568 501" fill="currentColor"><path d="M123.121 33.664C188.241 82.553 258.281 181.68 284 234.873c25.719-53.192 95.759-152.32 160.879-201.21C491.866-1.611 568-28.906 568 57.947c0 17.346-9.945 145.713-15.778 166.555-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281-2.462-7.227-3.614-10.608-3.631-7.733-.017-2.875-1.169.506-3.631 7.733-13.43 39.422-65.842 193.273-185.702 70.281-63.111-64.76-33.89-129.52 80.986-149.071-65.72 11.185-139.6-7.295-159.875-79.748C10.945 203.659 1 75.291 1 57.946 1-28.906 76.135-1.612 123.121 33.664z"/></svg></a>
				<a href="https://www.youtube.com/c/rmoff" title="youtube"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
				<a href="https://talks.rmoff.net" title="talks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="0"/><line x1="12" y1="17" x2="12" y2="22"/><line x1="8" y1="22" x2="16" y2="22"/><polyline points="7 8 12 12 17 8"/></svg></a>
				<a href="https://github.com/rmoff/" title="github"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
			</div>
		</nav>
		<button class="nav-toggle" onclick="document.querySelector('.mobile-nav').classList.toggle('open')" aria-label="Menu">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
		</button>
	</div>
	<nav class="mobile-nav">
		<a href="https://rmoff.net/">Home</a>
		<a href="/categories/">Categories</a>
		<a href="/categories/interesting-links/">Interesting Links</a>
		<a href="https://rmoff.net/search/">Search</a>
		<a href="https://rmoff.net/index.xml">RSS</a>
		<a href="https://www.linkedin.com/in/robinmoffatt/">linkedin</a>
		<a href="https://twitter.com/rmoff/">twitter</a>
		<a href="https://bsky.app/profile/rmoff.net">bluesky</a>
		<a href="https://www.youtube.com/c/rmoff">youtube</a>
		<a href="https://talks.rmoff.net">talks</a>
		<a href="https://github.com/rmoff/">github</a>
	</nav>
</header>


		<main role="main">
		

<div class="article-hero" style="background-image: url('https://rmoff.net/images/2024/10/why-cdc.png');">
	<div class="article-hero-overlay">
		<div class="article-hero-content">
			<h1>Why Do I Need CDC?</h1>
			<p class="article-hero-meta">
				
					<time datetime="2024-10-15T00:00:00Z">15 Oct 2024</time>
					<span class="display-print">by </span>
					 &middot; <a href="https://rmoff.net/categories/cdc">CDC</a>
					<span class="display-print">at https://rmoff.net/2024/10/15/why-do-i-need-cdc/</span>
				
			</p>
		</div>
	</div>
</div>


<details class="toc-mobile">
	<summary>Table of Contents</summary>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#_common_cdc_use_cases">Common CDC use cases</a></li>
    <li><a href="#_why_not_just_query_the_production_database">Why not just query the production database?</a></li>
    <li><a href="#_cdc_saves_the_day">CDC saves the day!</a></li>
    <li><a href="#_what_cdc_is_and_isnt">What CDC is (and isn‚Äôt)</a></li>
    <li><a href="#_the_best_way_to_do_cdc_is_log_based_cdc">The best way to do CDC is log-based CDC</a></li>
    <li><a href="#_pfff_i_dont_need_that_i_can_just_do">Pfff, I don‚Äôt need that, I can just do</a></li>
    <li><a href="#_limitations_of_log_based_cdc">Limitations of log-based CDC</a></li>
    <li><a href="#_is_cdc_expensive">Is CDC expensive?</a></li>
    <li><a href="#_cdc_can_be_more_complex_to_set_up">CDC can be more complex to set up</a></li>
    <li><a href="#_does_cdc_have_an_impact_on_the_operational_system">Does CDC have an impact on the operational system?</a></li>
    <li><a href="#_log_based_cdc_in_actionan_overview">Log-based CDC in action‚Äîan overview</a></li>
  </ul>
</nav>
</details>

<div class="container-fluid docs">
	<div class="row">
		<main class="docs-content" role="main">

<article class="article" data-pagefind-body>
	<span data-pagefind-filter="category" style="display:none">CDC</span>
	<img data-pagefind-meta="image[src]" src="https://rmoff.net/images/2024/10/why-cdc.png" style="display:none" alt="">
	<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This post originally appeared on the <a href="https://www.decodable.co/blog/why-do-i-need-cdc">Decodable blog</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Whether it‚Äôs <em>Understanding CDC</em> or <em>CDC Explained</em> or even <em>Five things about CDC; number four will shock you!</em>, the internet is awash with articles about  <a href="https://en.wikipedia.org/wiki/Change_data_capture">Change Data Capture (CDC)</a> .
CDC¬†is the process of incrementally extracting data change events as they occur within a database.
In this post I‚Äôd like to take a step back from these and look at the reasons why you might even want to consider CDC in the first place.
From here we‚Äôll then build on the requirements we identify to come up with a proposed solution.</p>
</div>
<div class="paragraph">
<p>The starting point for any exploration of CDC is your data in a database.
And most probably a transactional, or operational, one.
You‚Äôve got an order system, an inventory management system, you‚Äôve got any kind of system that‚Äôs built on an OLTP database‚Äîwhere the focus is on getting the data <em>in</em> quickly in a highly performant and resilient way.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2024/10/670e226e1f2a4fec8b668137_670d5e163a128c160a76c21c_AD_4nXf3o0BOdT2LF-cRdqT_0aFa0mAUoa6nM43dZ2b2GVZwDxutbks-xcixiZE1vEe4Jmz5AfaL2aFhudk7pACU0tOBWz1Nhlcmi_sK_-JFrKIIEaeZfMLK66fciRQVAsrx2NuXcqCd7ooZ10zz6Dnss6FxZ5GC.webp" alt="670e226e1f2a4fec8b668137 670d5e163a128c160a76c21c AD 4nXf3o0BOdT2LF cRdqT 0aFa0mAUoa6nM43dZ2b2GVZwDxutbks xcixiZE1vEe4Jmz5AfaL2aFhudk7pACU0tOBWz1Nhlcmi sK  JFrKIIEaeZfMLK66fciRQVAsrx2NuXcqCd7ooZ10zz6Dnss6FxZ5GC"/>
</div>
</div>
<div class="paragraph">
<p>With that data in the database, you want to do something else.
But before you can do it, you need the data out of the database.</p>
</div>
<div class="paragraph">
<p>Or do you?
Perhaps you could just use the data in place.
After all, who doesn‚Äôt enjoy baiting the friendly neighborhood DBA?
What could possibly go wrong with running unbounded queries on a production database that‚Äôs backing an operational system?
ü§°</p>
</div>
<div class="paragraph">
<p>OK, I jest, I jest.
A <em>huge</em> amount could go wrong.
OLTP systems are primarily optimized for writing and reading data for specific transactions, such as the creation or update of an individual customer order, rather than for efficiently extracting large volumes of data.
Depending on what kind of things you want to do with the data your query access paths could be both slow for you, and worse, slow down the production system.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2024/10/670e226e1f2a4fec8b66813f_670d5e16fdf3474b55b23bc7_AD_4nXeX0Vrcg_8W3KXzZ4rr6xjBUv83J_FOHGVebFtV85_Fdd6J1EnpUzINJQx7eRUZq6HghmQ70ioj8kVJodX8tJoV657HdMjOTMfY1jv7CTRi0d64oG5ZcG-fH-DtHoP7uOwbzPBnyo1UyZhexfdO5ADIb2zw.webp" alt="670e226e1f2a4fec8b66813f 670d5e16fdf3474b55b23bc7 AD 4nXeX0Vrcg 8W3KXzZ4rr6xjBUv83J FOHGVebFtV85 Fdd6J1EnpUzINJQx7eRUZq6HghmQ70ioj8kVJodX8tJoV657HdMjOTMfY1jv7CTRi0d64oG5ZcG fH DtHoP7uOwbzPBnyo1UyZhexfdO5ADIb2zw"/>
</div>
</div>
<div class="paragraph">
<p>So let‚Äôs assume you want the data out of the database.
Before we get onto <em>how</em> (and we‚Äôre not burying the lede here, the answer is in the title of the post üòâ) let‚Äôs take a moment to think about the kind of things that we might want to do with the data.</p>
</div>
<div class="sect1">
<h2 id="_common_cdc_use_cases">Common CDC use cases&nbsp;<a class="headline-hash" href="#_common_cdc_use_cases">üîó</a> </h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Analytics</strong> is the great big obvious one. Every man and his dog wants a dashboard or a data science notebook. Always has, and always will. The data to power these is not going to come from the operational database because it‚Äôs not optimized for that kind of querying. It‚Äôs going to be built on a data warehouse or data lake.</p>
</li>
<li>
<p>Perhaps a data lake is too slow, and we‚Äôre looking at <strong>real-time Analytics</strong>. The kind of things that power queries that are built into applications and need to return with low-latency. Again; you don‚Äôt want to be running this against your operational database. For quick response times you‚Äôll want decent indexing as well as pre-aggregations. Here, you‚Äôd be looking at dedicated technologies such as Clickhouse, Apache Pinot, or Apache Druid.</p>
</li>
<li>
<p><strong>Other applications</strong> might well want to use the data. Every time an order is placed, we probably want to think about updating the inventory system, right? Or our customer database, or a dozen other systems that users today will rightly assume are interconnected.</p>
</li>
<li>
<p>Boring, but important: <strong>audit logging</strong>. Your operational database will give you the current state, but it‚Äôd be rather handy to keep a record in cheap but reliable storage of every single change made and when, wouldn‚Äôt it?</p>
</li>
<li>
<p><strong>Query offload</strong> is a catch-all that encompasses several of the points above and a few others. It‚Äôs basically to say, you want to query the operational data? Fine, but you do it against this other database instead, where you can‚Äôt break operational systems with your queries.</p>
</li>
<li>
<p>A distinct subset of query offload is the requirement for <strong>streaming queries</strong>. These can incrementally recompute aggregations on the source data as it changes, avoiding the need to reprocess a full dataset each time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>You can read more about</em> <a href="https://www.decodable.co/blog/seven-ways-to-put-cdc-to-work">CDC use cases in this blog post</a> <em>from Gunnar Morling.</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_not_just_query_the_production_database">Why not just query the production database?&nbsp;<a class="headline-hash" href="#_why_not_just_query_the_production_database">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can look at this list another way.
There are some things that you want to do with the data but can‚Äôt against the operational database because you‚Äôll risk impacting the system that it‚Äôs serving.
Workloads like big number-crunching analytical queries is a great example.
We might well serve the data from the same database <em>platform</em> (e.g.
Postgres, Oracle, etc) but optimized for analytical queries (i.e.
OLAP) in configuration and table indexing and design strategies.</p>
</div>
<div class="paragraph">
<p>The other aspect here is that the database we‚Äôve built the operational system on is not the best one for serving what we want with our other uses of the data.
Analytics, as mentioned, could be served from a data lake (S3 + Iceberg, for example).
Real-time analytics from Pinot et al.
We‚Äôve not mentioned them yet but search indexes and application caches are two other important places where operational data is needed but in their own specialized serving technologies.
For example, OpenSearch (indexing) and Redis (cache).</p>
</div>
<div class="paragraph">
<p>The overarching point is; we need that operational data <em>out</em>, so that we put it somewhere else.
Doing so gives us the best of both worlds; a performant operational system protected from the performance impact of other uses, and those other uses being best served by the respective optimal technology.</p>
</div>
<div class="paragraph">
<p>My colleague, Gunnar Morling, put it succinctly:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Change data capture is one giant enabler; it lets you<br/>
<br/>
* replicate data<br/>
* feed search indexes<br/>
* update caches<br/>
* run streaming queries<br/>
* sync data between microservices<br/>
* maintain denormalized views<br/>
* create audit logs and so much more.*
*+
<br/>
Ultimately, it‚Äôs liberation for your data.</p>
</div>
<div class="paragraph">
<p>‚Äî Gunnar Morling üåç (@gunnarmorling)  <a href="https://twitter.com/gunnarmorling/status/1123191912800845825?ref_src=twsrc%5Etfw">April 30, 2019</a></p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cdc_saves_the_day">CDC saves the day!&nbsp;<a class="headline-hash" href="#_cdc_saves_the_day">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>This being a vendor blog, I am of course going to tell you that there is a silver bullet to all your problems, and that it‚Äôs CDC üòÅ.
The thing is, CDC <em>is</em> one of those patterns that <em>does</em> fit amazingly well into a lot of system architectures.</p>
</div>
<div class="paragraph">
<p>Before I get too evangelical, let‚Äôs pause to look at what CDC <em>is</em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_cdc_is_and_isnt">What CDC is (and isn‚Äôt)&nbsp;<a class="headline-hash" href="#_what_cdc_is_and_isnt">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDC, or Change Data Capture,  <a href="https://www.youtube.com/watch?v=zR2Ox4HWaXM">does what it says on the tin</a> .
It captures changes to data.
Specifically, changes made to data in one or more tables in a database.
For example, the creation of a new customer record, an update to a purchase order, or the deletion of an inventory item.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2024/10/670e226e1f2a4fec8b668133_670d5e16045ba6cb9857053e_AD_4nXeZgl2HxVecgenkknVMN9OpfXeTeqEKucuaV_IRcExRByHhDQDzrbQrJo5mYQ6sxQp6vpzRJQHgWOrbutOa1WHI5t4AIPaNUuUC0h0rJihXkT8LZ50Sh8N4cyWPFCfiLWp57wfVJiGJV73IFPrSS48RpNk.webp" alt="670e226e1f2a4fec8b668133 670d5e16045ba6cb9857053e AD 4nXeZgl2HxVecgenkknVMN9OpfXeTeqEKucuaV IRcExRByHhDQDzrbQrJo5mYQ6sxQp6vpzRJQHgWOrbutOa1WHI5t4AIPaNUuUC0h0rJihXkT8LZ50Sh8N4cyWPFCfiLWp57wfVJiGJV73IFPrSS48RpNk"/>
</div>
</div>
<div class="paragraph">
<p>So after three changes to the data by the application, we‚Äôd have three entries captured by CDC:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2024/10/670e226e1f2a4fec8b66813c_670d5e16ad5b3c699a70ad90_AD_4nXdqkz8RLL8GMrUN0Tq8cWmYIBbnzgyVv1-jiKHzB08tbpZC-yFBMKWhaF-chBqbXyIA30-3vJYKFPFZxPFBNWkPMUDhjY9FrYQJ8YWOuG-mRrzbhfsGj110OLBtiSIFSK6HIguAYm8Bb4kA6L2_on2V6zg.webp" alt="670e226e1f2a4fec8b66813c 670d5e16ad5b3c699a70ad90 AD 4nXdqkz8RLL8GMrUN0Tq8cWmYIBbnzgyVv1 jiKHzB08tbpZC yFBMKWhaF chBqbXyIA30 3vJYKFPFZxPFBNWkPMUDhjY9FrYQJ8YWOuG mRrzbhfsGj110OLBtiSIFSK6HIguAYm8Bb4kA6L2 on2V6zg"/>
</div>
</div>
<div class="paragraph">
<p>What happens to those changes is then up to the implementation of the CDC tool.
CDC is <em>just</em> the extraction of changes from a database.
This is where one of the big confusions seems to arise around CDC:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CDC does not load or ingest data</p>
</li>
<li>
<p>CDC is not a method of ETL</p>
</li>
<li>
<p>CDC is not real-time analytics</p>
</li>
<li>
<p>CDC does not transfer changes to a target database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CDC is often <em>part</em> of an ETL process, and the output from CDC is often written to a target system, perhaps even for real-time analytics.
But CDC itself is just getting the data out.</p>
</div>
<div class="paragraph">
<p>One of the reasons there are misunderstandings around what CDC is stems from the different ways in which CDC can be implemented.
Fortunately for you, dear reader, there is one way that is objectively better than the others.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_best_way_to_do_cdc_is_log_based_cdc">The best way to do CDC is log-based CDC&nbsp;<a class="headline-hash" href="#_the_best_way_to_do_cdc_is_log_based_cdc">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most databases are built on a concept known as the transaction log.</p>
</div>
<div class="paragraph">
<p>It goes by different names (binlog, redo log, write-ahead log) in different implementations, but the concept is the same throughout.</p>
</div>
<div class="paragraph">
<p>When you perform an <code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code> against a table, that operation is recorded in the transaction log.
This has nothing to do with CDC‚Äîthis is just how databases work.
The transaction log serves as a point of recovery should the server go bang.
If that happens, the database takes the last known-good point and <em>replays the transaction log forward</em>, thus applying all the committed changes that were made since.</p>
</div>
<div class="paragraph">
<p>What log-based CDC does is tap into the transaction log of the source database and expose it in a form that can be used downstream.
This is what makes log-based CDC so powerful.
The database itself uses the transaction log as its system of record, of absolute truth.
What better way to get the highest possible fidelity of what‚Äôs happening in a database than the component that the database itself uses?</p>
</div>
<div class="paragraph">
<p>+
<em>If theory is your thing, you‚Äôll love Martin Kleppmann‚Äôs talk</em> <a href="https://martin.kleppmann.com/2015/11/05/database-inside-out-at-oredev.html">Turning the database inside-out</a> <em>and the</em> <a href="https://queue.acm.org/detail.cfm?id=2884038">Immutability Changes Everything</a>  <em>paper from Pat Helland.</em></p>
</div>
<div class="paragraph">
<p>Log-based CDC has the following fantastically  <a href="https://debezium.io/blog/2018/07/19/advantages-of-log-based-change-data-capture/">powerful features</a> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Low impact on the database</p>
</li>
<li>
<p>Low latency availability of changes to the database</p>
</li>
<li>
<p>High fidelity of the changed data</p>
</li>
<li>
<p><em>All</em> changes are captured, including DELETEs</p>
</li>
<li>
<p>The current and previous version of a row is captured</p>
</li>
<li>
<p>Efficient (only captures rows that change)</p>
</li>
<li>
<p>Cross-platform (read from one database, write to another)</p>
</li>
<li>
<p>Available for all common databases</p>
</li>
<li>
<p>Since it‚Äôs based on events, log-based CDC is an excellent match for integration with streaming platforms like Apache Kafka</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rising star in this space is the open-source  <a href="https://debezium.io/">Debezium</a>  project.
Founded and led by Red Hat, and often rebadged by vendors as their own CDC tool, Debezium supports  <a href="https://debezium.io/documentation/reference/stable/connectors/index.html">numerous</a>  databases and has  <a href="https://debezium.io/community/users/">wide adoption</a> .</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pfff_i_dont_need_that_i_can_just_do">Pfff, I don‚Äôt need that, I can just do&nbsp;<a class="headline-hash" href="#_pfff_i_dont_need_that_i_can_just_do">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Okay, okay.
Whether it‚Äôs ‚Äú<em>Not Invented Here</em>‚Äù syndrome or simply skepticism about using the transaction log for CDC, you may well be thinking of other ways of capturing changes to data.
AirBnB have a  <a href="https://medium.com/airbnb-engineering/capturing-data-evolution-in-a-service-oriented-architecture-72f7c643ee6f">nice run-down</a>  from 2018 of the options available and their pros and cons.
Here‚Äôs a very quick look at the gotchas for other techniques, with reference to the list above of benefits of log-based CDC.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Query-based CDC,</strong> a.k.a., <strong>Polling</strong>. Relies on a data model for the tables that include a column by which differences since the last poll can be determined. Higher impact because you‚Äôre actively querying the database. Can‚Äôt capture deletes or before-state of changed rows.  <a href="https://youtu.be/4-MeJJt3B2Q?feature=shared&amp;t=639">Learn more</a> .</p>
</li>
<li>
<p>Friends don‚Äôt let friends do <strong>Dual Writes</strong>. If your application needs the same data being written to a database, one way to achieve this is to have the source send it to both your application and the database. You don‚Äôt impact the database but you run the real risk of data inconsistencies and divergence, and unintended coupling.  <a href="https://developers.redhat.com/articles/2021/07/30/avoiding-dual-writes-event-driven-applications#">Learn more</a> .</p>
</li>
<li>
<p><strong>Triggers</strong> are a feature of many databases, but using them for CDC requires you to literally code SQL in the source database for each condition you want to capture. You are then tied into needing to test, document, and maintain that code. When the code fires you need to do something with the event, which if you‚Äôre trying to replicate data outside of the database could get tricky. That‚Äôs before you‚Äôve considered the performance impact on the source database of a trigger firing for every single change.  <a href="https://asktom.oracle.com/Misc/oramag/the-trouble-with-triggers.html">Learn more</a> .</p>
</li>
<li>
<p><strong>Table replication</strong>. This is the sledgehammer-to-crack a nut approach. Instead of doing <strong>Change</strong> Data Capture you just do <strong>Data Capture</strong> and dump the full tables each time. Wasteful (unless every row changed), low fidelity (no change details per row), high latency, resource intensive on the source database.</p>
</li>
<li>
<p>Similar to the above would be <strong>in-built replication</strong> in which the database replicates tables to another instance of the database. This is fine if you want an exact replica of the tables being served by the same database, but not useful if you want the data on a different platform. It‚Äôs worth noting that built-in replication usually is built on the same transaction log concepts that log-based CDC uses.</p>
</li>
<li>
<p><strong>Comparing source and target</strong> tables might make sense for a one-off data replication scenario, but is not credible as a genuine way of replicating changes from a source database. Each comparison execution will put a query load on the source database, similar to replication discussed above.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_limitations_of_log_based_cdc">Limitations of log-based CDC&nbsp;<a class="headline-hash" href="#_limitations_of_log_based_cdc">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Remember, this is a vendor blog.
We‚Äôre supposed to present these silver bullets as infallible, right?
Whilst log-based CDC is pretty darn good and most of the time the correct answer, there are some challenges with it to be aware of.
Some are more real than others, some have better mitigations than others.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_is_cdc_expensive">Is CDC expensive?&nbsp;<a class="headline-hash" href="#_is_cdc_expensive">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>No, unless you‚Äôre in Oracle GoldenGate (OGG) world.
The Rolex-watch of the CDC world, OGG is well respected for a reason, but comes with a price tag to match.
There are other ‚Äòregular‚Äô enterprise offerings, not to mention the open source  <a href="https://debezium.io/">Debezium</a>  project which is, well, open source!</p>
</div>
<div class="paragraph">
<p><strong>Mitigation</strong>: Did I mention Debezium yet?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cdc_can_be_more_complex_to_set_up">CDC can be more complex to set up&nbsp;<a class="headline-hash" href="#_cdc_can_be_more_complex_to_set_up">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>OK, there‚Äôs a little bit more in this one, I‚Äôll admit.
Once you start diving into the world of transaction logs, you need to be on your DBA‚Äôs good side because you‚Äôll need to do some work to configure your CDC tool to access it.
Depending on what you‚Äôre then integrating with your CDC tool might also need some work to configure it to write the data where you want it.</p>
</div>
<div class="paragraph">
<p><strong>Mitigation:</strong> Log-based CDC is widely adopted and documentation is well-tested and thorough.</p>
</div>
<div class="paragraph">
<p><strong>Mitigation</strong>: If you use  <a href="https://decodable.co">a managed provider for Debezium</a>  a lot of the configuration and management is done for you.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_does_cdc_have_an_impact_on_the_operational_system">Does CDC have an impact on the operational system?&nbsp;<a class="headline-hash" href="#_does_cdc_have_an_impact_on_the_operational_system">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Yes and no.
The question is whether that impact is impactful or not.
Whilst log-based CDC <em>is</em> the lightest-touch way to get change data out of the system (see above for other, heavier, options), you are still interfacing with an operational system.
You need to watch out for things like the  <a href="https://www.morling.dev/blog/insatiable-postgres-replication-slot/">Postgres replication slot filling up</a>  and eating all the disk space.
You also need to make sure that whatever the source database, it‚Äôs configured to retain the transaction log for as long as needed for the CDC tool to read from it.
If you don‚Äôt then you‚Äôll miss change events.</p>
</div>
<div class="paragraph">
<p><strong>Mitigation</strong>: As above; log-based CDC is widely used at scale in production systems world-wide. Read the friendly manual, and you‚Äôll be fine. Just make sure your DBA is on-board üòÅ.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_log_based_cdc_in_actionan_overview">Log-based CDC in action‚Äîan overview&nbsp;<a class="headline-hash" href="#_log_based_cdc_in_actionan_overview">üîó</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here‚Äôs a very simple overview of what you might build with log-based CDC.
The requirement is populating a data lake from an operational database.
We‚Äôll use Postgres in the example, but the concept applies to any database.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2024/10/670e226f1f2a4fec8b66814f_670d5e17d16123873c4e0ff6_AD_4nXcdi7ZZf2LP4qXUXHtgBH6vfuteVWyhUCbDBxyTd656iKUfnBg4xjeuMX4dYcPUTj_PVQjWgVnyuD8NlujmScnKVIVp0OepUhtYxfu7TnqYvM4dVNwy0KADFwhCwDVE7Kf8RXGk3d3nGz5k82CtXXTgY3fO.webp" alt="670e226f1f2a4fec8b66814f 670d5e17d16123873c4e0ff6 AD 4nXcdi7ZZf2LP4qXUXHtgBH6vfuteVWyhUCbDBxyTd656iKUfnBg4xjeuMX4dYcPUTj PVQjWgVnyuD8NlujmScnKVIVp0OepUhtYxfu7TnqYvM4dVNwy0KADFwhCwDVE7Kf8RXGk3d3nGz5k82CtXXTgY3fO"/>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Any <code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code> is captured in the write-ahead-log (WAL)</p>
</li>
<li>
<p>Debezium streams the changes as they happen to an Apache Kafka topic (although it‚Äôs worth noting that these days  <a href="https://www.decodable.co/blog/understanding-cdc-with-debezium-server-and-debezium-engine">Debezium doesn‚Äôt have to use Kafka</a> ). The Kafka topic buffers the changes and makes them available for downstream use</p>
</li>
<li>
<p>A tool such as Apache Flink or Kafka Connect reads the data from the Kafka topic and writes it in Apache Iceberg format to S3</p>
</li>
</ul>
</div>
</div>
</div>
	<hr>
	<div class="giscus-container">
		<script src="https://giscus.app/client.js"
				data-repo="rmoff/rmoff-blog"
				data-repo-id="MDEwOlJlcG9zaXRvcnkxNTE3NDg2MTE="
				data-category="Announcements"
				data-category-id="DIC_kwDOCQuAA84CvP5T"
				data-mapping="pathname"
				data-strict="1"
				data-reactions-enabled="1"
				data-emit-metadata="0"
				data-input-position="bottom"
				data-theme="light"
				data-lang="en"
				crossorigin="anonymous"
				async>
		</script>
	</div>
</article>
      </main>
    
      
      <div class="docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">On this page</a></li>
        </ul>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#_common_cdc_use_cases">Common CDC use cases</a></li>
    <li><a href="#_why_not_just_query_the_production_database">Why not just query the production database?</a></li>
    <li><a href="#_cdc_saves_the_day">CDC saves the day!</a></li>
    <li><a href="#_what_cdc_is_and_isnt">What CDC is (and isn‚Äôt)</a></li>
    <li><a href="#_the_best_way_to_do_cdc_is_log_based_cdc">The best way to do CDC is log-based CDC</a></li>
    <li><a href="#_pfff_i_dont_need_that_i_can_just_do">Pfff, I don‚Äôt need that, I can just do</a></li>
    <li><a href="#_limitations_of_log_based_cdc">Limitations of log-based CDC</a></li>
    <li><a href="#_is_cdc_expensive">Is CDC expensive?</a></li>
    <li><a href="#_cdc_can_be_more_complex_to_set_up">CDC can be more complex to set up</a></li>
    <li><a href="#_does_cdc_have_an_impact_on_the_operational_system">Does CDC have an impact on the operational system?</a></li>
    <li><a href="#_log_based_cdc_in_actionan_overview">Log-based CDC in action‚Äîan overview</a></li>
  </ul>
</nav>
      </div>
      
    
    </div>
  </div>
</div>


		</main>

		

		
		<footer class="site-footer hide-print" role="contentinfo">
			<span>&copy; 2026 </span>
		</footer>
		

		
	</body>
</html>
