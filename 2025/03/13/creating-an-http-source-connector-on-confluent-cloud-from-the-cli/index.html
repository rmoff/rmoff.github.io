<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Creating an HTTP Source connector on Confluent Cloud from the CLI</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2025/03/13/creating-an-http-source-connector-on-confluent-cloud-from-the-cli/">
		
		
		
		

		
		<meta property="og:title" content="Creating an HTTP Source connector on Confluent Cloud from the CLI" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/images/2025/03/h_IMG_6392.webp" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2025/03/13/creating-an-http-source-connector-on-confluent-cloud-from-the-cli/" />
		<meta property="og:site_name" content="Creating an HTTP Source connector on Confluent Cloud from the CLI" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<link rel="stylesheet" href="https://rmoff.net/css/tachyons.min.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/story.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/descartes.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/toc.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/retro-cards.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/custom.css" />
		
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
		<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans:400,400i,700,700i|Quattrocento:400,700|Spectral:400,400i,700,700i&amp;subset=latin-ext" rel="stylesheet">
		
		
		<script>
			!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
            posthog.init('phc_93NEP79Ju4xqXYWXnoLbr4HMW0Iaepj1BGOVoEXYX6P',{api_host:'https://eu.i.posthog.com', person_profiles: 'identified_only' 
                })
		</script>
		
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		
		<script src="https://rmoff.net/js/story.js"></script>
		<script src="https://rmoff.net/js/toc.js"></script>

	</head>
	<body class="ma0 bg-white section-post page-kind-page is-page-true ">
		
		<header class="cover bg-top" style="background-image: url('https://rmoff.net/images/2025/03/h_IMG_6392.webp'); background-position: center;">
			<div class="bg-black-30 bb bt">

				<nav class="hide-print sans-serif  border-box pa3 ph5-l">
					<a href="https://rmoff.net" title="Home">
						<img src="https://rmoff.net/img/logo.jpg" class="w2 h2 br-100" alt="rmoff&#39;s random ramblings" />
					</a>
					<div class="fr h2 pv2 tr">
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net/bio">about</a>
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net">talks</a>
						<a class="link f5 ml2 dim near-white" href="https://bsky.app/profile/rmoff.net"><i class="fa-brands fa-bluesky"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://github.com/rmoff/"><i class="fab fa-github-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://www.youtube.com/c/rmoff"><i class="fab fa-youtube-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://www.linkedin.com/in/robinmoffatt/"><i class="fab fa-linkedin"></i></a>
						<a class="link f5 ml2 dim near-white fas fa-rss-square" href="https://rmoff.net/index.xml" title="RSS Feed"></a>
						<a class="link f5 ml2 dim near-white fas fa-search" href="https://rmoff.net/search/" role="search" title="Search"></a>
					</div>
				</nav>

				<div id="hdr" class="tc-l pv4-ns pv5-l pv2 ph3 ph4-ns">
					<h1 class="near-white mt1-ns f2 fw3 mb0 mt0 lh-title">
						<span class="terminal-title">Creating an HTTP Source connector on Confluent Cloud from the CLI<span class="terminal-cursor"></span></span>
					</h1>
					<h2 class="near-white mt3-l mb4-l fw1 f6 f3-l measure-wide-l center lh-copy mt2 mb3">
						
						
							
								Published
								<time datetime="2025-03-13T11:29:40Z">Mar 13, 2025</time>
								<span class="display-print">by </span>
								 in <a href="https://rmoff.net/categories/confluent-cloud" class="no-underline category near-white dim">Confluent Cloud</a>, <a href="https://rmoff.net/categories/kafka-connect" class="no-underline category near-white dim">Kafka Connect</a>, <a href="https://rmoff.net/categories/managed-connectors" class="no-underline category near-white dim">Managed Connectors</a>, <a href="https://rmoff.net/categories/rest-api" class="no-underline category near-white dim">REST API</a>, <a href="https://rmoff.net/categories/kcat-kafkacat" class="no-underline category near-white dim">Kcat (Kafkacat)</a>
								<span class="display-print">at https://rmoff.net/2025/03/13/creating-an-http-source-connector-on-confluent-cloud-from-the-cli/</span>
							
						
					</h2>
				</div>

				
				
				
				<div class="w-100 cf hide-print">
					<a class="fr f6 ma0 pa2 link white-50 dim fas fa-camera" href="https://bsky.app/profile/rmoff.net" title="Photo Credit"></a>
				</div>
				
				

			</div>
		</header>
		
		<main role="main">
		
<div class="container-fluid docs">
  <div class="row">
    <main class="docs-content" role="main">

<article class="article">
	
<div class="paragraph">
<p>In this blog article Iâ€™ll show you how you can use the <a href="https://docs.confluent.io/confluent-cli/current/overview.html"><code>confluent</code> CLI</a> to set up a Kafka cluster on Confluent Cloud, the necessary API keys, and then a managed connector.
The connector Iâ€™m setting up is the <a href="https://docs.confluent.io/cloud/current/connectors/cc-http-source-v2.html">HTTP Source (v2)</a> connector.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2025/03/managed-http-connector.webp" alt="managed http connector"/>
</div>
</div>
<div class="paragraph">
<p>Itâ€™s part of a pipeline that Iâ€™m working on to pull in <a href="https://environment.data.gov.uk/flood-monitoring/doc/reference">a feed of data from the UK Environment Agency</a> for processing.
The data is spread across three endpoints, and one of the nice features of the HTTP Source (v2) connector is that one connector can pull data from more than one endpoint.</p>
</div>
<div class="paragraph">
<p>As part of learning about Confluent Cloud and its support for Kafka Connect, I wanted to understand how to configure fully-managed connectors from the CLI.
The UI is nice, but the CLI is repeatable.
Whilst there is <a href="https://registry.terraform.io/providers/confluentinc/confluent/latest/docs/resources/confluent_connector">Terraform support for resources in Confluent Cloud</a>, Iâ€™ve yet to learn Terraform so this would take me off a whole different yak-shaving path that Iâ€™m going to save for another day.</p>
</div>
<div class="sect1">
<h2 id="_setup">Setup&nbsp;<a class="headline-hash" href="#_setup">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>To start with, login to Confluent Cloud:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent login --save</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To <em>actually</em> start with, you need to go and <a href="https://www.confluent.io/en-gb/get-started/">sign up for Confluent Cloud</a> (which you can even do from the CLI with <code>confluent cloud-signup</code>!). Then come back here :)
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Now weâ€™ll create an environment within our organisation and set it as the active environment for the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent environment create rmoff

# The above command with return an ID for the environment, which
# is what you specify in the next command here
$ confluent environment use env-253ngy</code></pre>
</div>
</div>
<div class="paragraph">
<p>What does any environment need? A Kafka cluster!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent kafka cluster create cluster00 --cloud aws --region us-west-2</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of this command tells us various things about the cluster, including its ID and broker.
Iâ€™m going to store these in local environment variables to make things easier later on when we want to use them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">+----------------------+---------------------------------------------------------+
[â€¦]
| ID                   | lkc-qnygo6                                              |
| Endpoint             | SASL_SSL://pkc-rgm37.us-west-2.aws.confluent.cloud:9092 |
[â€¦]
+----------------------+---------------------------------------------------------+

$ export CNFL_ENV=env-253ngy
$ export CNFL_KAFKA_CLUSTER=lkc-qnygo6
$ export CNFL_KAFKA_BROKER=pkc-rgm37.us-west-2.aws.confluent.cloud:9092</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having created the cluster, weâ€™ll set it as the active one for our CLI session:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent kafka cluster use $CNFL_KAFKA_CLUSTER
Set Kafka cluster lkc-qnygo6 as the active cluster for environment env-253ngy.</code></pre>
</div>
</div>
<div class="paragraph">
<p>When we created the cluster we got a Schema Registry with itâ€”we need to get the ID and endpoint details:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent schema-registry cluster describe
+----------------------+----------------------------------------------------+
| Name                 | Always On Stream Governance                        |
|                      | Package                                            |
| Cluster              | lsrc-g70zm3                                        |
| Endpoint URL         | https://psrc-13go8y7.us-west-2.aws.confluent.cloud |
[â€¦]
+----------------------+----------------------------------------------------+

export CNFL_SR_HOST=psrc-13go8y7.us-west-2.aws.confluent.cloud
export CNFL_SR_ID=lsrc-g70zm3</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_api_keys">API Keys&nbsp;<a class="headline-hash" href="#_api_keys">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Iâ€™m <em>obviously</em> not sharing the actual API keys generated by the commands below, and have instead put placeholders.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>We need to create some API keys for the calls weâ€™re going to be making to interact with the cluster.</p>
</div>
<div class="paragraph">
<p>First, one for the Kafka cluster itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent api-key create --resource $CNFL_KAFKA_CLUSTER
It may take a couple of minutes for the API key to be ready.
Save the API key and secret. The secret is not retrievable later.
+------------+------------------------------------------------------------------+
| API Key    | (XXXmy-kafka-api-keyXXX)                                         |
| API Secret | (XXXmy-kafka-api-secretXXX)                                      |
+------------+------------------------------------------------------------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then one for the cloud resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent api-key create --resource cloud
It may take a couple of minutes for the API key to be ready.
Save the API key and secret. The secret is not retrievable later.
+------------+------------------------------------------------------------------+
| API Key    | (XXXmy-cloud-api-keyXXX)                                         |
| API Secret | (XXXmy-cloud-api-secretXXX)                                      |
+------------+------------------------------------------------------------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, for the Schema Registry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent api-key create --resource $CNFL_SR_ID
It may take a couple of minutes for the API key to be ready.
Save the API key and secret. The secret is not retrievable later.
+------------+------------------------------------------------------------------+
| API Key    | (XXXmy-schema-registry-api-keyXXX)                               |
| API Secret | (XXXmy-schema-registry-api-secretXXX)                            |
+------------+------------------------------------------------------------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having done this, weâ€™ll store the API keys and secrets in local environment variables to make it easy to re-use them later on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export CNFL_KC_API_KEY=(XXXmy-kafka-api-keyXXX)
export CNFL_KC_API_SECRET=(XXXmy-kafka-api-secretXXX)

export CNFL_CLOUD_API_KEY=(XXXmy-cloud-api-keyXXX)
export CNFL_CLOUD_API_SECRET=(XXXmy-cloud-api-secretXXX)

export CNFL_SR_API_KEY=(XXXmy-schema-registry-api-keyXXX)
export CNFL_SR_API_SECRET=(XXXmy-schema-registry-api-secretXXX)</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Storing API details in environment variables is a risky thing to do if anyone were to get hold of your machine, your bash history, etc etc. There are much better ways to manage secrets; Iâ€™m just taking the easy (but insecure) route here.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_confluent_cloud_api">The Confluent Cloud API&nbsp;<a class="headline-hash" href="#_the_confluent_cloud_api">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the <a href="https://docs.confluent.io/confluent-cli/current/command-reference/connect/cluster/confluent_connect_cluster_create.html#confluent-connect-cluster-create"><code>confluent</code> CLI to create connectors</a>, but I ended up using a REST call directly.
If you do use the <code>confluent</code> CLI note that the terminology is to create a Connect &#34;Cluster&#34;, rather than a connector.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.confluent.io/cloud/current/api.html">Confluent Cloud API</a> uses an API key for authentication.
For working with connectors the API key should be created for access to the <code>cloud</code> resource (see <code>confluent api-key create --resource cloud</code> above).
The docs show how to create an <code>Authorization</code> header with a base64-encoded representation of the API key.
A simpler way is to pass it as a username/password combo, separated by a colon (i.e. <code>API_KEY:API_SECRET</code>).</p>
</div>
<div class="paragraph">
<p>In <code>curl</code> you use <code>--user</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">curl --request GET \
      --url https://api.confluent.cloud/org/v2/organizations \
      --user &#34;(XXXmy-cloud-api-keyXXX):(XXXmy-cloud-api-secretXXX)&#34;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <a href="https://httpie.io/">httpie</a> (my favourite tool for this kind of stuff) itâ€™s <code>--auth</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http GET https://api.confluent.cloud/org/v2/organizations \
      --auth &#34;(XXXmy-cloud-api-keyXXX):(XXXmy-cloud-api-secretXXX)&#34;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_an_http_source_connector_for_a_single_endpoint">Create an HTTP Source connector for a single endpoint&nbsp;<a class="headline-hash" href="#_create_an_http_source_connector_for_a_single_endpoint">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Weâ€™ll start simple and make sure that this thing works for a single endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http PUT \
    &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/env-agency--flood-monitoring-stations/config&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34; \
    content-type:application/json \
    connector.class=&#34;HttpSourceV2&#34; \
    name=&#34;&#34; \
    http.api.base.url=&#34;https://environment.data.gov.uk/flood-monitoring&#34; \
    api1.http.api.path=&#34;/id/stations&#34; \
    api1.http.offset.mode=&#34;SIMPLE_INCREMENTING&#34; \
    api1.http.initial.offset=&#34;0&#34; \
    api1.request.interval.ms=&#34;3600000&#34; \
    api1.topics=&#34;flood-monitoring-stations&#34; \
    kafka.api.key=$CNFL_KC_API_KEY \
    kafka.api.secret=$CNFL_KC_API_SECRET \
    output.data.format=&#34;AVRO&#34; \
    tasks.max=&#34;1&#34;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The documentation for the connector details all of <a href="https://docs.confluent.io/cloud/current/connectors/cc-http-source-v2.html#configuration-properties">the configuration options</a>.
Letâ€™s take a look at what weâ€™re going to configure:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;"/>
<col style="width: 50%;"/>
<col style="width: 25%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>connector.class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpSourceV2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the connector type weâ€™re going to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This config value isnâ€™t used, but the element must be specified for the config to be valid. The name of the connector is taken from the URL path (see below).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http.api.base.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>https://environment.data.gov.uk/flood-monitoring</code></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base URL for the API endpoint.
This will make a lot of sense later when we define more than one endpoint.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api1.http.api.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/id/stations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to the API endpoint (to be added to the base URL)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api1.http.offset.mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SIMPLE_INCREMENTING</code></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Since the endpoint provides a full set of the data each time we query it, these two settings are necessary to tell the connector to expect this and not try to page through the endpoint.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api1.http.initial.offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api1.request.interval.ms</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3600000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Poll the endpoint once an hour (60 minutes / 3600 seconds / 3600000 ms)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api1.topics</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flood-monitoring-stations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Which topic to write the endpoint response to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>output.data.format</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AVRO</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How to serialise the data when writing it</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kafka.api.key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$CNFL_KC_API_KEY</code></p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Credentials that the connector will use to write to the Kafka cluster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kafka.api.secret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$CNFL_KC_API_SECRET</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tasks.max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How many tasks the connector can run (less relevant for a single endpoint, but important when we add more later)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Confluent Cloud REST API endpoint that weâ€™re going to send this data to is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/flood-monitoring-stations/config&#34;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The component parts are broken out like this:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">URL Element</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>https://api.confluent.cloud/connect/v1</code></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>[fixed]</em> Base URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$CNFL_ENV</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confluent Cloud Environment ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$CNFL_KAFKA_CLUSTER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka Cluster ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>connectors</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>[fixed]</em> Resource Type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flood-monitoring-stations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name that you want to use for the connector</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>[fixed]</em> The configuration endpoint</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <a href="https://docs.confluent.io/cloud/current/api.html#tag/Connectors-(connectv1)/operation/createOrUpdateConnectv1ConnectorConfig"><code>/config</code> API</a> expects a <code>PUT</code> operation, and has the advantage over the related <a href="https://docs.confluent.io/cloud/current/api.html#tag/Connectors-(connectv1)/operation/createConnectv1Connector"><code>POST</code> to <code>/connectors</code></a> in that it does an &#39;upsert&#39;â€”if the connector doesnâ€™t exist it creates it, and if it does, it updates it. That makes the REST call idempotent (a fancy way of saying you can run it repeatedly with the same result).</p>
</div>
<div class="paragraph">
<p>When we run the command we get back an HTTP status code which if all has gone well is this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_checking_the_status_of_a_connector">Checking the status of a connector&nbsp;<a class="headline-hash" href="#_checking_the_status_of_a_connector">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://docs.confluent.io/cloud/current/api.html#tag/Status-(connectv1)/operation/readConnectv1ConnectorStatus">/status</a> endpoint tells us about the connector, including its health and details of the tasks within it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http GET &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/env-agency--flood-monitoring-stations/status&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Use the <code>-b</code> flag with httpie if you want to supress the response headers
</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
    &#34;connector&#34;: {
        &#34;state&#34;: &#34;RUNNING&#34;,
        &#34;trace&#34;: &#34;&#34;,
        &#34;worker_id&#34;: &#34;env-agency--flood-monitoring-stations&#34;
    },
    &#34;error_details&#34;: null,
    &#34;errors_from_trace&#34;: [],
    &#34;is_csfle_error&#34;: false,
    &#34;name&#34;: &#34;env-agency--flood-monitoring-stations&#34;,
    &#34;override_message&#34;: &#34;&#34;,
    &#34;tasks&#34;: [
        {
            &#34;id&#34;: 0,
            &#34;msg&#34;: &#34;&#34;,
            &#34;state&#34;: &#34;RUNNING&#34;,
            &#34;worker_id&#34;: &#34;env-agency--flood-monitoring-stations&#34;
        }
    ],
    &#34;type&#34;: &#34;source&#34;,
    &#34;validation_error_category_info&#34;: null,
    &#34;validation_errors&#34;: []
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You could use jq to simplify this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http GET &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/env-agency--flood-monitoring-stations/status&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34; | \
    jq &#39;.connector.state&#39;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">&#34;RUNNING&#34;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you prefer, you can use the Confluent CLI too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ # Get the connector ID
$ confluent connect cluster list
      ID     |                 Name                  | Status  |  Type  | Trace
-------------+---------------------------------------+---------+--------+--------
  lcc-r19wjk | env-agency--flood-monitoring-stations | RUNNING | source |

$ # Get its details, including status
$ confluent connect cluster describe lcc-r19wjk
Connector Details
+--------+---------------------------------------+
| ID     | lcc-r19wjk                            |
| Name   | env-agency--flood-monitoring-stations |
| Status | RUNNING                               |
| Type   | source                                |
+--------+---------------------------------------+


Task Level Details
  Task |  State
-------+----------
     0 | RUNNING


Configuration Details
           Config          |                          Value
---------------------------+----------------------------------------------------------
  api1.http.api.path       | /id/stations
  api1.http.initial.offset | 0
  api1.request.interval.ms | 3600000
  api1.topics              | flood-monitoring-stations
  cloud.environment        | prod
  cloud.provider           | aws
  connector.class          | HttpSourceV2
  http.api.base.url        | https://environment.data.gov.uk/flood-monitoring
  kafka.api.key            | ****************
  kafka.api.secret         | ****************
  kafka.endpoint           | SASL_SSL://pkc-rgm37.us-west-2.aws.confluent.cloud:9092
  kafka.region             | us-west-2
  name                     | env-agency--flood-monitoring-stations
  output.data.format       | AVRO
  tasks.max                | 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>For brevity, you can ask the Confluent CLI to return JSON that you then filter with jq:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">confluent connect cluster describe lcc-r19wjk --output json | jq &#39;.connector.status&#39;
&#34;RUNNING&#34;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_looking_at_the_data">Looking at the data&nbsp;<a class="headline-hash" href="#_looking_at_the_data">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Based on the above configuration and the fact that the connector is <code>RUNNING</code>, we should hopefully see data written to the <code>flood-monitoring-stations</code> topic.</p>
</div>
<div class="paragraph">
<p>As above, you can use the Confluent CLI, or your own approach for this.
Iâ€™m a big fan of <code>kcat</code> so tend to gravitate towards it, but itâ€™s up to you.</p>
</div>
<div class="paragraph">
<p>Hereâ€™s kcat listing (<code>-L</code>) the topics on my Confluent Cloud Kafka cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -L

Metadata for all topics (from broker -1: sasl_ssl://pkc-rgm37.us-west-2.aws.confluent.cloud:9092/bootstrap):
 6 brokers:
  broker 0 at b0-pkc-rgm37.us-west-2.aws.confluent.cloud:9092 (controller)
  broker 1 at b1-pkc-rgm37.us-west-2.aws.confluent.cloud:9092
  broker 2 at b2-pkc-rgm37.us-west-2.aws.confluent.cloud:9092
  broker 3 at b3-pkc-rgm37.us-west-2.aws.confluent.cloud:9092
  broker 4 at b4-pkc-rgm37.us-west-2.aws.confluent.cloud:9092
  broker 5 at b5-pkc-rgm37.us-west-2.aws.confluent.cloud:9092
 2 topics:
  topic &#34;error-lcc-r19wjk&#34; with 1 partitions:
    partition 0, leader 4, replicas: 4,2,0, isrs: 4,2,0
  topic &#34;flood-monitoring-stations&#34; with 1 partitions:
    partition 0, leader 2, replicas: 2,4,0, isrs: 2,4,0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Doing the same with Confluent CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent kafka topic list
              Name              | Internal | Replication Factor | Partition Count
--------------------------------+----------+--------------------+------------------
  error-lcc-r19wjk              | false    |                  3 |               1
  flood-monitoring-stations     | false    |                  3 |               1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To query the topic, bearing in mind that itâ€™s serialised with Avro and so we need the Schema Registry too, Iâ€™m using kcat.
Here is how to read (<code>-C</code>) a single message (<code>-c1</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-stations -c1</code></pre>
</div>
</div>
<div class="paragraph">
<p>It turns out the payload is hugeâ€”more than will fit on a terminal to inspect.
We can use the Linux tool <code>wc</code> to see quite how big it is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -q -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-stations -c1 | wc --bytes

5002406</code></pre>
</div>
</div>
<div class="paragraph">
<p>Huhâ€”4.77 MB! Weâ€™re gonna need a bigger monitor ;)</p>
</div>
<div class="paragraph">
<p>Letâ€™s look at the payload structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -q -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-stations -c1 | jq &#39;keys&#39;

[
  &#34;_40context&#34;,
  &#34;items&#34;,
  &#34;meta&#34;
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Based on the <a href="https://environment.data.gov.uk/flood-monitoring/doc/reference">source APIâ€™s documentation</a> we know <code>items</code> is an array, so letâ€™s inspect on element of it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -q -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-stations -c1 | jq &#39;.items[1]&#39;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  &#34;_40id&#34;: &#34;http://environment.data.gov.uk/flood-monitoring/id/stations/E2043&#34;,
  &#34;RLOIid&#34;: {
    &#34;string&#34;: &#34;6022&#34;
  },
  &#34;catchmentName&#34;: {
    &#34;string&#34;: &#34;Welland&#34;
  },
  &#34;dateOpened&#34;: {
    &#34;int&#34;: 8035
  },
  &#34;easting&#34;: {
    &#34;string&#34;: &#34;528000&#34;
  },
  &#34;label&#34;: &#34;Surfleet Sluice&#34;,
  [â€¦]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This all looks good.
Weâ€™re going to about adding the other two endpoints into this connector.
But firstâ€”letâ€™s tidy up after ourselves and remove this version of the connector.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deleting_a_managed_connector_on_confluent_cloud">Deleting a managed connector on Confluent Cloud&nbsp;<a class="headline-hash" href="#_deleting_a_managed_connector_on_confluent_cloud">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>My brain likes working with well-designed APIs and the HTTP vocabulary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You <code>PUT</code> a <code>/config</code></p>
</li>
<li>
<p>You <code>GET</code> a <code>/status</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To list the connectors that have been created? Itâ€™s a <a href="https://docs.confluent.io/cloud/current/api.html#tag/Connectors-(connectv1)/operation/listConnectv1Connectors"><code>GET</code> against <code>/connectors</code></a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ http GET &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34; -b

[
    &#34;foo&#34;,
    &#34;env-agency--flood-monitoring-stations&#34;,
    &#34;flood-monitoring&#34;,
    &#34;test&#34;
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>So you can pretty much guess the Confluent Cloud REST API for deleting a connectorâ€”you <a href="https://docs.confluent.io/cloud/current/api.html#tag/Connectors-(connectv1)/operation/deleteConnectv1Connector"><code>DELETE</code> a <code>$connector-name</code></a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ http DELETE \
    &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/env-agency--flood-monitoring-stations&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34;

HTTP/1.1 200 OK</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As discussed above, we could <code>PUT</code> the new config to this connector instead of deleting and recreating it, but I want to use a new nameâ€”plus this gives me an excuse to illustrate the <code>DELETE</code> endpoint :)
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_http_source_connector_for_multiple_api_endpoints">Creating an HTTP Source connector for multiple API endpoints&nbsp;<a class="headline-hash" href="#_creating_an_http_source_connector_for_multiple_api_endpoints">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>The HTTP source (v2) connector supports ingesting data with a single connector from <em>multiple API endpoints</em> with the same base URL.
Our endpoints here are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://environment.data.gov.uk/flood-monitoring/doc/reference#stations"><code>/id/stations</code></a> (as above)</p>
</li>
<li>
<p><a href="https://environment.data.gov.uk/flood-monitoring/doc/reference#measures"><code>/id/measures</code></a></p>
</li>
<li>
<p><a href="https://environment.data.gov.uk/flood-monitoring/doc/reference#readings"><code>/data/readings?latest</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The core parts of configuration stay as they were, but we now add in <code>api2</code> and <code>api3</code> configuration.
We also need to define <code>apis.num</code> since itâ€™s now greater than the default of one.
In the example below Iâ€™ve added in additional line breaks so that you can see the relevant groupings of the configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http PUT \
    &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/env-agency--flood-monitoring/config&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34; \
    content-type:application/json \
    connector.class=&#34;HttpSourceV2&#34; \
    name=&#34;&#34; \
    \
    http.api.base.url=&#34;https://environment.data.gov.uk/flood-monitoring&#34; \
    apis.num=&#34;3&#34; \
    api1.http.api.path=&#34;/id/stations&#34; \
    api1.http.offset.mode=&#34;SIMPLE_INCREMENTING&#34; \
    api1.http.initial.offset=&#34;0&#34; \
    api1.request.interval.ms=&#34;3600000&#34; \
    api1.topics=&#34;flood-monitoring-stations&#34; \
    \
    api2.http.api.path=&#34;/id/measures&#34; \
    api2.http.offset.mode=&#34;SIMPLE_INCREMENTING&#34; \
    api2.http.initial.offset=&#34;0&#34; \
    api2.request.interval.ms=&#34;3600000&#34; \
    api2.topics=&#34;flood-monitoring-measures&#34; \
    \
    api3.http.api.path=&#34;/data/readings?latest&#34; \
    api3.http.offset.mode=&#34;SIMPLE_INCREMENTING&#34; \
    api3.http.initial.offset=&#34;0&#34; \
    api3.request.interval.ms=&#34;900000&#34; \
    api3.topics=&#34;flood-monitoring-readings&#34; \
    \
    kafka.api.key=$CNFL_KC_API_KEY \
    kafka.api.secret=$CNFL_KC_API_SECRET \
    output.data.format=&#34;AVRO&#34; \
    \
    tasks.max=&#34;3&#34;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to run your connector with more than one task (<code>tasks.max</code>), your <a href="https://docs.confluent.io/cloud/current/clusters/cluster-types.html#cluster-types">Confluent Cloud cluster type</a> needs to be bigger than basic.
If itâ€™s not, youâ€™ll get this message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Failed to Claim the tasks requested: Failed to claim the task requested:
Max 1 task(s) allowed per connector with basic cluster type.
To use more than 1 task(s), please upgrade your cluster type from basic to standard.</code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Letâ€™s check the status:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http GET &#34;https://api.confluent.cloud/connect/v1/environments/$CNFL_ENV/clusters/$CNFL_KAFKA_CLUSTER/connectors/env-agency--flood-monitoring/status&#34; \
    --auth &#34;$CNFL_CLOUD_API_KEY:$CNFL_CLOUD_API_SECRET&#34; \
    --print b | jq &#39;.tasks[]&#39;
{
  &#34;id&#34;: 0,
  &#34;state&#34;: &#34;RUNNING&#34;,
  &#34;worker_id&#34;: &#34;env-agency--flood-monitoring&#34;,
  &#34;msg&#34;: &#34;&#34;
}
{
  &#34;id&#34;: 1,
  &#34;state&#34;: &#34;RUNNING&#34;,
  &#34;worker_id&#34;: &#34;env-agency--flood-monitoring&#34;,
  &#34;msg&#34;: &#34;&#34;
}
{
  &#34;id&#34;: 2,
  &#34;state&#34;: &#34;RUNNING&#34;,
  &#34;worker_id&#34;: &#34;env-agency--flood-monitoring&#34;,
  &#34;msg&#34;: &#34;&#34;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Three tasks, all up and running :)</p>
</div>
<div class="paragraph">
<p>What about the data?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ confluent kafka topic list
            Name            | Internal | Replication Factor | Partition Count
----------------------------+----------+--------------------+------------------
  error-lcc-3mpv1j          | false    |                  3 |               1
  error-lcc-5nx9on          | false    |                  3 |               1
  error-lcc-5nxknn          | false    |                  3 |               1
  flood-monitoring-measures | false    |                  3 |               1
  flood-monitoring-readings | false    |                  3 |               1
  flood-monitoring-stations | false    |                  3 |               1</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Measures:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -q -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-measures -c1 | jq &#39;.items[1]&#39;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  &#34;_40id&#34;: &#34;http://environment.data.gov.uk/flood-monitoring/id/measures/1029TH-level-stage-i-15_min-mASD&#34;,
  &#34;datumType&#34;: {
    &#34;string&#34;: &#34;http://environment.data.gov.uk/flood-monitoring/def/core/datumASD&#34;
  },
  &#34;label&#34;: &#34;RIVER DIKLER AT BOURTON ON THE WATER - level-stage-i-15_min-mASD&#34;,
[â€¦]</code></pre>
</div>
</div>
</li>
<li>
<p>Stations:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -q -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-stations -c1 | jq &#39;.items[1]&#39;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  &#34;_40id&#34;: &#34;http://environment.data.gov.uk/flood-monitoring/id/stations/E2043&#34;,
  &#34;RLOIid&#34;: {
    &#34;string&#34;: &#34;6022&#34;
  },
  &#34;catchmentName&#34;: {
    &#34;string&#34;: &#34;Welland&#34;
  },
  &#34;dateOpened&#34;: {
    &#34;int&#34;: 8035
  },
  &#34;easting&#34;: {
    &#34;string&#34;: &#34;528000&#34;
  },
  &#34;label&#34;: &#34;Surfleet Sluice&#34;,
[â€¦]</code></pre>
</div>
</div>
</li>
<li>
<p>Readings:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ kcat -q -b $CNFL_KAFKA_BROKER \
    -X security.protocol=sasl_ssl -X sasl.mechanisms=PLAIN \
    -X sasl.username=$CNFL_KC_API_KEY -X sasl.password=$CNFL_KC_API_SECRET \
    -s avro -r https://$CNFL_SR_API_KEY:$CNFL_SR_API_SECRET@$CNFL_SR_HOST \
    -C -t flood-monitoring-readings -c1 | jq &#39;.items[1]&#39;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  &#34;_40id&#34;: &#34;http://environment.data.gov.uk/flood-monitoring/data/readings/5312TH-level-stage-i-15_min-mASD/2025-02-21T13-45-00Z&#34;,
  &#34;dateTime&#34;: 1740145500000,
  &#34;measure&#34;: &#34;http://environment.data.gov.uk/flood-monitoring/id/measures/5312TH-level-stage-i-15_min-mASD&#34;,
  &#34;value&#34;: 22.664999999999999
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>

</article>
      </main>
    
      
      <div class="docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
        </ul>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#_setup">Setup</a></li>
    <li><a href="#_api_keys">API Keys</a></li>
    <li><a href="#_the_confluent_cloud_api">The Confluent Cloud API</a></li>
    <li><a href="#_create_an_http_source_connector_for_a_single_endpoint">Create an HTTP Source connector for a single endpoint</a></li>
    <li><a href="#_checking_the_status_of_a_connector">Checking the status of a connector</a></li>
    <li><a href="#_looking_at_the_data">Looking at the data</a></li>
    <li><a href="#_deleting_a_managed_connector_on_confluent_cloud">Deleting a managed connector on Confluent Cloud</a></li>
    <li><a href="#_creating_an_http_source_connector_for_multiple_api_endpoints">Creating an HTTP Source connector for multiple API endpoints</a></li>
  </ul>
</nav>
      </div>
      
      <div class="toc-mobile-label">TABLE OF CONTENTS</div>
      
    
    </div>
  </div>
</div>


		</main>
		
				<div class="hide-print sans-serif f6 f5-l mt5 ph3 pb6 center nested-copy-line-height lh-copy nested-links mw-100 measure-wide">
		<div class="about-the-author">
		
			
			
				
					<hr>
<p><img src="/images/2018/05/ksldn18-01.jpg" alt="Robin Moffatt"></p>
<p><a href="https://bsky.app/profile/rmoff.net"><b class="fa-brands fa-bluesky"></b></a>  <em>Robin Moffatt works on the DevRel team at Confluent. He likes writing about himself in the third person, eating good breakfasts, and drinking good beer.</em></p>

				
			
		
		</div>
		
	</div>

		
		
		
		<footer class="hide-print sans-serif f6 fw1 bg-black near-white bottom-0 w-100 pa3" role="contentinfo">
			<p class="w-50 fr tr">
			<a class="no-underline near-white" href="https://github.com/xaprb/story"><img class="dib" title="Made with Hugo and Story" alt="Story logo" src="https://rmoff.net/img/story-logo-white.svg" style="width: 1.5rem; height: 1.5rem" /></a>
			</p>
			<p class="w-50 near-white">
				&copy; 2025 
			</p>
		</footer>
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-75492960-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

	</body>
</html>
