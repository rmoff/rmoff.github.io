<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8" />

  
  <title>Lifting the Lid on OBIEE 12c Web Services - Part 2</title>

  
  
  <link href="//cdn.jsdelivr.net" rel="dns-prefetch">
  <link href="//cdnjs.cloudflare.com" rel="dns-prefetch">
  <link href="//at.alicdn.com" rel="dns-prefetch">
  <link href="//fonts.googleapis.com" rel="dns-prefetch">
  <link href="//fonts.gstatic.com" rel="dns-prefetch">
  <link href="///disqus.com" rel="dns-prefetch">
  <link href="//c.disquscdn.com" rel="dns-prefetch">
  
  
  

  

  
  <meta name="author" content="Robin Moffatt">
  <meta name="description" content="In OBIEE 12c data-model-cmd is a wrapper for some java code which ultimately calls an internal RESTful web service in OBIEE 12c, bi-lcm. We saw in the previous post how these internal web services can be opened up slightly, and we&amp;rsquo;re going to do the same again here. Which means, time for the same caveat:
None of these Web Services are documented, and they should therefore be assumed to be completely unsupported by Oracle.">

  
  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gohugoio">
    <meta name="twitter:title" content="Lifting the Lid on OBIEE 12c Web Services - Part 2">
    <meta name="twitter:description" content="In OBIEE 12c data-model-cmd is a wrapper for some java code which ultimately calls an internal RESTful web service in OBIEE 12c, bi-lcm. We saw in the previous post how these internal web services can be opened up slightly, and we&amp;rsquo;re going to do the same again here. Which means, time for the same caveat:
None of these Web Services are documented, and they should therefore be assumed to be completely unsupported by Oracle.">
    <meta name="twitter:image" content="/images/avatar.jpg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Lifting the Lid on OBIEE 12c Web Services - Part 2">
  <meta property="og:description" content="In OBIEE 12c data-model-cmd is a wrapper for some java code which ultimately calls an internal RESTful web service in OBIEE 12c, bi-lcm. We saw in the previous post how these internal web services can be opened up slightly, and we&amp;rsquo;re going to do the same again here. Which means, time for the same caveat:
None of these Web Services are documented, and they should therefore be assumed to be completely unsupported by Oracle.">
  <meta property="og:url" content="https://rmoff.github.io/2016/05/28/lifting-the-lid-on-obiee-12c-web-services-part-2/">
  <meta property="og:image" content="/images/avatar.jpg">




<meta name="generator" content="Hugo 0.52">


<link rel="canonical" href="https://rmoff.github.io/2016/05/28/lifting-the-lid-on-obiee-12c-web-services-part-2/">

<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no,email=no,adress=no">
<meta http-equiv="Cache-Control" content="no-transform">


<meta name="robots" content="index,follow">
<meta name="referrer" content="origin-when-cross-origin">







<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="rmoff.net">
<meta name="msapplication-tooltip" content="rmoff.net">
<meta name='msapplication-navbutton-color' content="#5fbf5e">
<meta name="msapplication-TileColor" content="#5fbf5e">
<meta name="msapplication-TileImage" content="/images/tile-image-windows.png">
<link rel="icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" sizes="192x192" href="/images/touch-icon-android.png">
<link rel="apple-touch-icon" href="/images/touch-icon-apple.png">


<link rel="preload" href="/styles/main.min.css" as="style">
<link rel="preload" href="https://fonts.googleapis.com/css?family=Lobster" as="style">
<link rel="preload" href="/images/avatar.jpg" as="image">
<link rel="preload" href="/images/grey-prism.svg" as="image">


<style>
  body {
    background: rgb(244, 243, 241) url('/images/grey-prism.svg') repeat fixed;
  }
</style>
<link rel="stylesheet" href="/styles/main.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster">


<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.2/dist/medium-zoom.min.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video-js.min.css">



  
  
<!--[if lte IE 8]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-ie8@1.1.2/dist/videojs-ie8.min.js"></script>
<![endif]-->

<!--[if lte IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20180112/classList.min.js"></script>
<![endif]-->


<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@14.2.1/dist/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
        <a title="Go to comments" class="to-comment" href="#disqus_thread"><span class="icon icon-comment"></span></a>
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="/images/avatar.jpg" alt="Avatar">
  
  <h2 class="title">rmoff.net</h2>
  
  <p class="subtitle"></p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item
            
            
            ">
            <a href="/about-me/">about me</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="/presentations/">presentations</a>
          </li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list"></ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Lifting the Lid on OBIEE 12c Web Services - Part 2</h1>
      <p class="post-meta">@Robin Moffatt · May 28, 2016 · 6 min read</p>
    </header>
    <article class="post-content"><p>In OBIEE 12c <code>data-model-cmd</code> is a wrapper for some java code which ultimately calls an internal RESTful web service in OBIEE 12c, <code>bi-lcm</code>. We saw in the <a href="http://rmoff.net/2016/05/24/lifting-the-lid-on-obiee-12c-web-services-part-1/">previous post</a> how these internal web services can be opened up slightly, and we&rsquo;re going to do the same again here. Which means, time for the same caveat:</p>

<hr />

<p><strong>None of these Web Services are documented, and they should therefore be assumed to be completely unsupported by Oracle. This article is purely for geek interest. Using undocumented APIs leaves you at risk of the API changing at any time.</strong></p>

<hr />

<p>With that out of the way, let&rsquo;s go! Firstly, a simple example of downloading the RPD. The way that OBIEE 12c works with RPDs is significantly different from previous versions, since there is now the concept of customisations and layering. You may have noticed <code>liverpd.rpd</code> or <code>default_diff.xml</code>, both of which are related to this. The nett result is that there is no longer a single RPD file uploaded to the server which can be downloaded again for editing, as there was in 11g and before. You now need to submit a request to OBIEE to retrieve the latest version of the RPD, which it will pull together on the fly and pass back to you. This is done using <code>data-model-cmd</code>:</p>

<pre><code>$ /app/oracle/biee/user_projects/domains/bi/bitools/bin/data-model-cmd.sh downloadrpd -O ~/myRPD.rpd -W Admin123 -U weblogic -P Admin123 -SI ssi
</code></pre>

<p>This writes a local file, myRPD.rpd. In the background, it&rsquo;s calling <code>bi-lcm</code> to retrieve the file, as we can see from two diagnostic routes:</p>

<ul>
<li><p>First, my favourite, <code>sysdig</code>, sniffing any traffic on ports 7780 (managed server public listen port) and 7783 (managed server internal listen port, as used by intra-component REST calls etc):</p>

<pre><code>sudo sysdig -s 2000 -A -c echo_fds &quot;(fd.port=7780 or fd.port=7783)&quot;
</code></pre>

<p>This captures the following <code>POST</code> request:</p>

<pre><code>POST /bi-lcm/v1/si/ssi/rpd/downloadrpd HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: Basic d2VibG9naWM6QWRtaW4xMjM=
User-Agent: Jersey/2.21.1 (HttpUrlConnection 1.8.0_51)
Host: demo.us.oracle.com:7780
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
Content-Length: 24
</code></pre></li>

<li><p>Just as useful, in this case, is the <code>bi-lcm</code> log file itself, <code>DOMAIN_HOME/servers/bi_server1/logs/bi-lcm-rest.log.0</code>:</p>

<pre><code>47 &gt; POST http://demo.us.oracle.com:7780/bi-lcm/v1/si/ssi/rpd/downloadrpd
47 &gt; Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
47 &gt; Authorization: Basic d2VibG9naWM6QWRtaW4xMjM=
47 &gt; Connection: keep-alive
47 &gt; Content-Length: 24
47 &gt; Content-Type: application/x-www-form-urlencoded
47 &gt; Host: demo.us.oracle.com:7780
47 &gt; User-Agent: Jersey/2.21.1 (HttpUrlConnection 1.8.0_51)
target-password=Admin123
</code></pre></li>
</ul>

<p>So the syntax of the RESTful call is pretty simple &ndash; call the <code>downloadrpd</code> endpoint, passing in the password that is to be used to encrypt the generated RPD. Authentication is done by Basic HTTP.</p>

<p>What can we do with this? Two things - neither of which are spectacularly useful as such, but additional ways and means to achieve the same. It may be you&rsquo;ve got a bespoke code integration system that needs to integrate with a RESTful endpoint, or simply it&rsquo;s just another useful tool to have at one&rsquo;s disposal. Before we get into it, it&rsquo;s probably time for that caveat again:</p>

<hr />

<p><strong>None of these Web Services are documented, and they should therefore be assumed to be completely unsupported by Oracle. This article is purely for geek interest. Using undocumented APIs leaves you at risk of the API changing at any time.</strong></p>

<hr />

<p><a href="https://curl.haxx.se/"><code>cURL</code></a> is a commandline utility for sending HTTP (amongst other) requests. We can use it to request the RPD to be downloaded to any machine on which we can run cURL. Because it adheres to the *nix philosophy of making the output available as a pipe, we can redirect it to a file:  (<em>if you don&rsquo;t, you&rsquo;ll get a screen full of gibberish&hellip;</em>)</p>

<pre><code class="language-bash">curl -X &quot;POST&quot; &quot;http://192.168.56.101:7780/bi-lcm/v1/si/ssi/rpd/downloadrpd&quot; \
--data-urlencode &quot;target-password=Admin123&quot; \
--basic --user weblogic:Admin123 \
&gt; downloadedRPD.rpd
</code></pre>

<p>Note that I&rsquo;ve used <code>\</code> line continuation character to break the command over multiple lines simply for legibility.</p>

<p>It&rsquo;s pretty clear, hopefully, how to parameterise this for your own use. The server and port are your OBIEE managed server and port (the same that <code>/analytics</code> is on). The rest are credentials, for the downloaded RPD, and to access the OBIEE system, respectively.</p>

<p>Taking the same method, but via a web page, we can run this HTML file anywhere we want:</p>

<pre><code class="language-html">&lt;html&gt;
   &lt;head&gt;&lt;/head&gt;
   &lt;body&gt;
      &lt;FORM action=&quot;http://192.168.56.101:7780/bi-lcm/v1/si/ssi/rpd/downloadrpd&quot;
         enctype=&quot;application/x-www-form-urlencoded&quot;
         method=&quot;post&quot;&gt;
         &lt;P&gt;
           New password for downloaded RPD file? &lt;INPUT type=&quot;text&quot; name=&quot;target-password&quot;&gt;&lt;BR&gt;
            &lt;INPUT type=&quot;submit&quot; value=&quot;Send&quot;&gt; &lt;INPUT type=&quot;reset&quot;&gt;
      &lt;/FORM&gt;
   &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Load it into a web browser, enter a password for the generated RPD:</p>

<p><img src="/content/images/2016/05/rpd_download_html.png" alt="" /></p>

<p>and enter your credentials for OBIEE when prompted:</p>

<p><img src="/content/images/2016/05/rpddl02.png" alt="" /></p>

<p>The RPD file is downloaded as <code>downloadrpd</code>, which you can rename to whatever you want.</p>

<hr />

<p>So, we can do <code>downloadrpd</code> &ndash; what about <code>uploadrpd</code>? Because that really would be useful for some people, being able to deploy an RPD without needing to dive into the commandline.</p>

<p>Here&rsquo;s the <code>uploadrpd</code> command:</p>

<pre><code class="language-bash">$ /app/oracle/biee/user_projects/domains/bi/bitools/bin/data-model-cmd.sh \ 
uploadrpd -I /home/oracle/chng1.rpd -W Admin123 -U weblogic -P Admin123 -SI ssi
</code></pre>

<p>The resulting POST request looks like this:</p>

<pre><code>POST http://demo.us.oracle.com:7780/bi-lcm/v1/si/ssi/rpd/uploadrpd
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Authorization: Basic d2VibG9naWM6QWRtaW4xMjM=
Connection: keep-alive
Content-Length: 1221056
Content-Type: multipart/form-data;boundary=Boundary_1_1010953501_1464461679148
Host: demo.us.oracle.com:7780
MIME-Version: 1.0
User-Agent: Jersey/2.21.1 (HttpUrlConnection 1.8.0_51)
</code></pre>

<p>The upload has two parts; the RPD password, and the RPD itself.</p>

<pre><code>--Boundary_1_1010953501_1464461679148
Content-Type: text/plain
Content-Disposition: form-data; name=&quot;rpd-password&quot;

Admin123
--Boundary_1_1010953501_1464461679148
Content-Type: application/vnd.oracle.rpd
Content-Disposition: form-data; filename=&quot;myRPD.rpd&quot;; modification-date=&quot;Sat, 28 May 2016 18:53:14 GMT&quot;; size=1220668; name=&quot;file&quot;

[whole bunch of encoded RPD binary file]
</code></pre>

<p><del>But - I couldn&rsquo;t replicate this HTTP request successfully; called manually through Paw, or cURL, or a manual webpage like the above, it would fail with the error:</del></p>

<pre><code>oracle.bi.lcm.rest.si.rpd.RpdEndpointV1 SEVERE - Exception during RPD file upload: java.lang.NullPointerException
</code></pre>

<p><del>Or on other attempts:</del></p>

<pre><code>java.net.SocketTimeoutException : Read time out after 30000 millis
</code></pre>

<p><del>My guess (based on ruling out all the other stuff) is it&rsquo;s down to how I was encoding the file and/or specifying its length. A challenge for <a href="https://oracleus.activeevents.com/2014/connect/fileDownload/session/75F302D730BDB9CA14ADAB3477574D4D/UGF9144_Berg-OOW_Neos_Voyage_2014.pdf">you Neos</a> out there to crack?</del></p>

<p><strong>Update:</strong> <a href="https://twitter.com/fomin_andrew/status/739189964097851393">Neo has risen to the challenge</a>, showing that the force is strong in this one&hellip; Andrew Fomin (<a href="https://twitter.com/fomin_andrew">twitter</a> | <a href="https://bisoftdiary.com/">blog</a>) has figured out the correct syntax in order to use <code>curl</code> to upload an RPD:</p>

<pre><code class="language-bash">curl -X POST \
     &quot;http://192.168.1.41:7780/bi-lcm/v1/si/ssi/rpd/uploadrpd&quot; \
     --form &quot;file=@myRPD.rpd;type=application/vnd.oracle.rpd&quot; \
     --form &quot;rpd-password=Password01&quot; \
     --basic --user weblogic:Admin123
</code></pre>

<p>The key bit in this is that the content-type of the upload RPD file is set to <code>application/vnd.oracle.rpd</code> &ndash; without this the upload fails.</p>

<p>When run, the JSON payload returned shows success (parsed here through <code>jq</code>):</p>

<pre><code class="language-json">{
  &quot;clazz&quot;: [
    &quot;rpd-response&quot;
  ],
  &quot;links&quot;: [
    {
      &quot;href&quot;: &quot;http://192.168.1.41:7780/bi-lcm/v1/si/ssi/rpd/uploadrpd&quot;,
      &quot;rel&quot;: [
        &quot;self&quot;
      ]
    }
  ],
  &quot;properties&quot;: {
    &quot;entry&quot;: [
      {
        &quot;key&quot;: &quot;si&quot;,
        &quot;value&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;value&quot;: &quot;ssi&quot;
        }
      },
      {
        &quot;key&quot;: &quot;description&quot;,
        &quot;value&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;value&quot;: &quot;RPD upload completed successfully.&quot;
        }
      },
      {
        &quot;key&quot;: &quot;desc_code&quot;,
        &quot;value&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;value&quot;: &quot;DESC_CODE_RPD_UPLOAD_SUCCESSFUL&quot;
        }
      },
      {
        &quot;key&quot;: &quot;status&quot;,
        &quot;value&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;value&quot;: &quot;SUCCESS&quot;
        }
      }
    ]
  },
  &quot;title&quot;: &quot;RPD-LCM response, SI=ssi, action=Upload RPD&quot;
}
</code></pre>

<p>Thanks Andrew!</p>

<hr />

<p><strong>None of these Web Services are documented, and they should therefore be assumed to be completely unsupported by Oracle. This article is purely for geek interest. Using undocumented APIs leaves you at risk of the API changing at any time.</strong></p>

<hr />
</article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="/tags/obiee"><span class="tag">Obiee</span></a></li>
        
          <li><a href="/tags/obiee12c"><span class="tag">Obiee12c</span></a></li>
        
          <li><a href="/tags/rpd"><span class="tag">Rpd</span></a></li>
        
          <li><a href="/tags/downloadrpd"><span class="tag">Downloadrpd</span></a></li>
        
          <li><a href="/tags/uploadrpd"><span class="tag">Uploadrpd</span></a></li>
        
          <li><a href="/tags/data-model-cmd"><span class="tag">Data-Model-Cmd</span></a></li>
        
          <li><a href="/tags/web-service"><span class="tag">Web Service</span></a></li>
        
          <li><a href="/tags/rest"><span class="tag">Rest</span></a></li>
        
          <li><a href="/tags/curl"><span class="tag">Curl</span></a></li>
        
          <li><a href="/tags/sysdig"><span class="tag">Sysdig</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        This post was published <strong>931</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.
      </p>
    </footer>
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "rmoff" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    
  </section>
  


<footer class="site-footer">
  <p>© 2017-2018 rmoff.net</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video.min.js"></script>




<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    },
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>



<script src="/scripts/index.min.js"></script>








  </body>
</html>
