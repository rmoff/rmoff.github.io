<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8" />

  
  <title>Running a Docker Container on Proxmox for BitTorrent Sync</title>

  
  
  <link href="//cdn.jsdelivr.net" rel="dns-prefetch">
  <link href="//cdnjs.cloudflare.com" rel="dns-prefetch">
  <link href="//at.alicdn.com" rel="dns-prefetch">
  <link href="//fonts.googleapis.com" rel="dns-prefetch">
  <link href="//fonts.gstatic.com" rel="dns-prefetch">
  <link href="///disqus.com" rel="dns-prefetch">
  <link href="//c.disquscdn.com" rel="dns-prefetch">
  
  
  

  

  
  <meta name="author" content="Robin Moffatt">
  <meta name="description" content="(Previously, previously, previously)
Since Proxmox 4 has a recent Linux kernel and mainline one at that, it means that Docker can be run on it. I&amp;rsquo;ve yet to really dig into Docker and work out when it makes sense in place of Linux Containers (LXC), so this is going to be a learning experience for me.
To install Docker, add Backports repo to apt:
root@proxmox01:~# cat /etc/apt/sources.list.d/backports.list deb http://ftp.debian.org/debian jessie-backports main  And then install:">

  
  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gohugoio">
    <meta name="twitter:title" content="Running a Docker Container on Proxmox for BitTorrent Sync">
    <meta name="twitter:description" content="(Previously, previously, previously)
Since Proxmox 4 has a recent Linux kernel and mainline one at that, it means that Docker can be run on it. I&amp;rsquo;ve yet to really dig into Docker and work out when it makes sense in place of Linux Containers (LXC), so this is going to be a learning experience for me.
To install Docker, add Backports repo to apt:
root@proxmox01:~# cat /etc/apt/sources.list.d/backports.list deb http://ftp.debian.org/debian jessie-backports main  And then install:">
    <meta name="twitter:image" content="/images/avatar.jpg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Running a Docker Container on Proxmox for BitTorrent Sync">
  <meta property="og:description" content="(Previously, previously, previously)
Since Proxmox 4 has a recent Linux kernel and mainline one at that, it means that Docker can be run on it. I&amp;rsquo;ve yet to really dig into Docker and work out when it makes sense in place of Linux Containers (LXC), so this is going to be a learning experience for me.
To install Docker, add Backports repo to apt:
root@proxmox01:~# cat /etc/apt/sources.list.d/backports.list deb http://ftp.debian.org/debian jessie-backports main  And then install:">
  <meta property="og:url" content="https://rmoff.github.io/2016/06/07/running-a-docker-container-on-proxmox-for-bittorrent-sync/">
  <meta property="og:image" content="/images/avatar.jpg">




<meta name="generator" content="Hugo 0.52">


<link rel="canonical" href="https://rmoff.github.io/2016/06/07/running-a-docker-container-on-proxmox-for-bittorrent-sync/">

<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no,email=no,adress=no">
<meta http-equiv="Cache-Control" content="no-transform">


<meta name="robots" content="index,follow">
<meta name="referrer" content="origin-when-cross-origin">







<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="rmoff.net">
<meta name="msapplication-tooltip" content="rmoff.net">
<meta name='msapplication-navbutton-color' content="#5fbf5e">
<meta name="msapplication-TileColor" content="#5fbf5e">
<meta name="msapplication-TileImage" content="/images/tile-image-windows.png">
<link rel="icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" sizes="192x192" href="/images/touch-icon-android.png">
<link rel="apple-touch-icon" href="/images/touch-icon-apple.png">


<link rel="preload" href="/styles/main.min.css" as="style">
<link rel="preload" href="https://fonts.googleapis.com/css?family=Lobster" as="style">
<link rel="preload" href="/images/avatar.jpg" as="image">
<link rel="preload" href="/images/grey-prism.svg" as="image">


<style>
  body {
    background: rgb(244, 243, 241) url('/images/grey-prism.svg') repeat fixed;
  }
</style>
<link rel="stylesheet" href="/styles/main.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster">


<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.2/dist/medium-zoom.min.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video-js.min.css">



  
  
<!--[if lte IE 8]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-ie8@1.1.2/dist/videojs-ie8.min.js"></script>
<![endif]-->

<!--[if lte IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20180112/classList.min.js"></script>
<![endif]-->


<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@14.2.1/dist/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
        <a title="Go to comments" class="to-comment" href="#disqus_thread"><span class="icon icon-comment"></span></a>
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="/images/avatar.jpg" alt="Avatar">
  
  <h2 class="title">rmoff.net</h2>
  
  <p class="subtitle"></p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item
            
            
            ">
            <a href="/about-me/">about me</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="/presentations/">presentations</a>
          </li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list"></ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Running a Docker Container on Proxmox for BitTorrent Sync</h1>
      <p class="post-meta">@Robin Moffatt · Jun 7, 2016 · 4 min read</p>
    </header>
    <article class="post-content"><p>(<a href="http://rmoff.net/2016/06/07/a-new-arrival/">Previously</a>, <a href="http://rmoff.net/2016/06/07/commissioning-my-proxmox-server/">previously</a>, <a href="http://rmoff.net/2016/06/07/importing-vmware-and-virtualbox-vms-to-proxmox/">previously</a>)</p>

<p>Since Proxmox 4 has a recent Linux kernel and mainline one at that, it means that Docker can be run on it. I&rsquo;ve yet to really dig into Docker and work out when it makes sense in place of Linux Containers (LXC), so this is going to be a learning experience for me.</p>

<p>To install Docker, add Backports repo to apt:</p>

<pre><code class="language-bash">root@proxmox01:~# cat /etc/apt/sources.list.d/backports.list
deb http://ftp.debian.org/debian jessie-backports main
</code></pre>

<p>And then install:</p>

<pre><code class="language-bash">apt-get update &amp;&amp; apt-get install docker.io
</code></pre>

<p>Once installed, run a test to validate it&rsquo;s all working:</p>

<pre><code class="language-bash">root@proxmox01:~# docker run --rm hello-world

Hello from Docker.
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker Hub account:
 https://hub.docker.com

For more examples and ideas, visit:
 https://docs.docker.com/engine/userguide/
</code></pre>

<hr />

<p><a href="https://getsync.com">Resilio Sync</a> (previously known as BitTorrent Sync) is a Peer-To-Peer (P2P) tool that is a great way for sharing and synchronising folders across machines, both local and remote. Think Dropbox, but without the central &ldquo;Cloud&rdquo; bit. I like using it for sharing VM images particularly, for two reasons:</p>

<ol>
<li>It trickles data down as and when and as fast or slow as the internet connection permits. If your wifi drops, it&rsquo;s no biggie. If someone&rsquo;s transferring data from you, you can reboot your machine without causing everything to fail. Sync just keeps plodding away at transferring the data. Whether transferring between two LAN machines, or LAN to another person&rsquo;s machine, or even up to Amazon S3 (via an EC2 machine running Sync), it&rsquo;s a great tool.</li>
<li>Because it&rsquo;s P2P, the more people who are sharing a file, the faster you can receive it. If two people have the file you want, and one goes offline, you can still continue to receive it from the other. If both are online an your bandwidth supports it, you can get it twice as fast.</li>
</ol>

<p>You can use it for one-off transfers of single huge files, or just folders of documents that you want to keep in sync.</p>

<p>BitTorrent|Resilio Sync is nothing to do with the somewhat-infamous BitTorrent, other than similar technology &ndash; which is presumably why they replaced the &lsquo;BitTorrent&rsquo; part of the name.</p>

<p>I&rsquo;ve run BitTorrent Sync in the past in an OpenVZ container, but thought this would be a good chance to see if Docker was going to be useful for me. I found a <a href="(https://hub.docker.com/r/bittorrent/sync/)">Docker image existing for Sync already</a>, so ran it:</p>

<pre><code class="language-bash">rmoff@proxmox01:~$ DATA_FOLDER=/data04/sync
rmoff@proxmox01:~$ mkdir $DATA_FOLDER
rmoff@proxmox01:~$ WEBUI_PORT=8888
rmoff@proxmox01:~$ sudo docker run -d --name Sync   -p $WEBUI_PORT:8888 -p 55555   -v $DATA_FOLDER:/mnt/sync -v /data04:/mnt/mounted_folders/data04  --restart on-failure   bittorrent/sync
</code></pre>

<p>It was as simple that that. I pointed my web browser at port 8888 on my Proxmox server (the Docker host), and it worked perfectly.</p>

<p><img src="/content/images/2016/06/Sync___c7415250d7a3.png" alt="" /></p>

<p>To see what Docker containers are running use <code>ps</code>:</p>

<pre><code class="language-bash">root@proxmox01:~# docker ps
CONTAINER ID        IMAGE                    COMMAND                CREATED             STATUS              PORTS                                              NAMES
b9081e03570b        bittorrent/sync:latest   &quot;/opt/run_sync --log   11 hours ago        Up 11 hours         0.0.0.0:8888-&gt;8888/tcp, 0.0.0.0:32770-&gt;55555/tcp   Sync
</code></pre>

<p>and to terminate one use <code>docker rm</code> (with <code>-f</code> if you want to just crash it and get rid)</p>

<p>So why&rsquo;s that better as a Docker container than a VM? Or a Linux Container (LXC)? Well the VM one is easy - way fewer resources needed on the host machine to run it. Better than a LXC? Not sure yet. On the plus side, it&rsquo;s even more minimalistic than LXC. On the downside&hellip; it&rsquo;s more minimalistic than LXC. This may be my inexperience with Docker, but I like the fact that an LXC I can still SSH into and it&rsquo;s (up to a certain point) still a &ldquo;real&rdquo; server. Another upside to LXC is that Proxmox&rsquo;s web GUI can be used to manage them. I&rsquo;ve yet to dig into whether there are good Web GUIs for Docker.</p>
</article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="/tags/docker"><span class="tag">Docker</span></a></li>
        
          <li><a href="/tags/proxmox"><span class="tag">Proxmox</span></a></li>
        
          <li><a href="/tags/bittorrent-sync"><span class="tag">Bittorrent Sync</span></a></li>
        
          <li><a href="/tags/dropbox"><span class="tag">Dropbox</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        This post was published <strong>921</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.
      </p>
    </footer>
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "rmoff" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    
  </section>
  


<footer class="site-footer">
  <p>© 2017-2018 rmoff.net</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video.min.js"></script>




<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    },
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>



<script src="/scripts/index.min.js"></script>








  </body>
</html>
