<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" as="image" href="https://rmoff.net/images/2016/06/1__screen-1.png" >
		
		<title>Reviving a bricked EdgeRouter Lite (ERL) from a Mac</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2016/06/08/reviving-a-bricked-edgerouter-lite-erl-from-a-mac/">
		
		

		
		<meta property="og:title" content="Reviving a bricked EdgeRouter Lite (ERL) from a Mac" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/images/2016/06/1__screen-1.png" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2016/06/08/reviving-a-bricked-edgerouter-lite-erl-from-a-mac/" />
		<meta property="og:site_name" content="Reviving a bricked EdgeRouter Lite (ERL) from a Mac" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<style>
			html { background-color: #FAF8F5; color: #2D2926; }
			body { opacity: 0; transition: opacity 0.1s ease; }
			body.loaded { opacity: 1; }
			.site-header { height: 60px; background-color: #FAF8F5; border-bottom: 1px solid #E8421E; }
		</style>

		
		
		<link rel="stylesheet" href="https://rmoff.net/css/redesign.css" />
		
		<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap">
		<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
		<noscript><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet"></noscript>
		

		

		
		<script>
			!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
            posthog.init('phc_93NEP79Ju4xqXYWXnoLbr4HMW0Iaepj1BGOVoEXYX6P',{api_host:'https://eu.i.posthog.com', person_profiles: 'identified_only'})
		</script>

		
		<script src="https://rmoff.net/js/story.js"></script>
		<script src="https://rmoff.net/js/toc.js"></script>
		<script src="https://rmoff.net/js/medium-mirror.js"></script>
	</head>
	<body class="ma0 section-post page-kind-page is-page-true ">
		<script>document.body.classList.add('loaded');</script>

		<header class="site-header hide-print">
	<div class="site-header-inner">
		<a href="https://rmoff.net/" class="site-title">rmoff's random ramblings</a>
		<nav class="site-nav">
			<a href="/categories/interesting-links/" class="nav-il"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> Interesting Links</a>
			<span class="nav-sep"></span>
			<a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg> Categories</a>
			<a href="https://rmoff.net/search/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg> Search</a>
			<a href="https://rmoff.net/index.xml"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg> RSS</a>
			<div class="nav-social">
				<a href="https://www.linkedin.com/in/robinmoffatt/" title="linkedin"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
				<a href="https://twitter.com/rmoff/" title="twitter"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
				<a href="https://bsky.app/profile/rmoff.net" title="bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 568 501" fill="currentColor"><path d="M123.121 33.664C188.241 82.553 258.281 181.68 284 234.873c25.719-53.192 95.759-152.32 160.879-201.21C491.866-1.611 568-28.906 568 57.947c0 17.346-9.945 145.713-15.778 166.555-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281-2.462-7.227-3.614-10.608-3.631-7.733-.017-2.875-1.169.506-3.631 7.733-13.43 39.422-65.842 193.273-185.702 70.281-63.111-64.76-33.89-129.52 80.986-149.071-65.72 11.185-139.6-7.295-159.875-79.748C10.945 203.659 1 75.291 1 57.946 1-28.906 76.135-1.612 123.121 33.664z"/></svg></a>
				<a href="https://www.youtube.com/c/rmoff" title="youtube"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
				<a href="https://talks.rmoff.net" title="talks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="0"/><line x1="12" y1="17" x2="12" y2="22"/><line x1="8" y1="22" x2="16" y2="22"/><polyline points="7 8 12 12 17 8"/></svg></a>
				<a href="https://github.com/rmoff/" title="github"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
			</div>
		</nav>
		<button class="nav-toggle" onclick="document.querySelector('.mobile-nav').classList.toggle('open')" aria-label="Menu">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
		</button>
	</div>
	<nav class="mobile-nav">
		<a href="https://rmoff.net/">Home</a>
		<a href="/categories/">Categories</a>
		<a href="/categories/interesting-links/">Interesting Links</a>
		<a href="https://rmoff.net/search/">Search</a>
		<a href="https://rmoff.net/index.xml">RSS</a>
		<a href="https://www.linkedin.com/in/robinmoffatt/">linkedin</a>
		<a href="https://twitter.com/rmoff/">twitter</a>
		<a href="https://bsky.app/profile/rmoff.net">bluesky</a>
		<a href="https://www.youtube.com/c/rmoff">youtube</a>
		<a href="https://talks.rmoff.net">talks</a>
		<a href="https://github.com/rmoff/">github</a>
	</nav>
</header>


		<main role="main">
		

<div class="article-hero" style="background-image: url('https://rmoff.net/images/2016/06/1__screen-1.png');">
	<div class="article-hero-overlay">
		<div class="article-hero-content">
			<h1>Reviving a bricked EdgeRouter Lite (ERL) from a Mac</h1>
			<p class="article-hero-meta">
				
					<time datetime="2016-06-08T15:58:30Z">08 Jun 2016</time>
					<span class="display-print">by </span>
					 &middot; <a href="https://rmoff.net/categories/edgemax">edgemax</a>, <a href="https://rmoff.net/categories/erl">erl</a>, <a href="https://rmoff.net/categories/edgerouter-lite">edgerouter lite</a>, <a href="https://rmoff.net/categories/tftp">tftp</a>, <a href="https://rmoff.net/categories/rj45">rj45</a>, <a href="https://rmoff.net/categories/screen">screen</a>, <a href="https://rmoff.net/categories/squashfs">squashfs</a>, <a href="https://rmoff.net/categories/router">router</a>, <a href="https://rmoff.net/categories/networking">networking</a>
					<span class="display-print">at https://rmoff.net/2016/06/08/reviving-a-bricked-edgerouter-lite-erl-from-a-mac/</span>
				
			</p>
		</div>
	</div>
</div>


<details class="toc-mobile">
	<summary>Table of Contents</summary>
	<nav id="TableOfContents"></nav>
</details>

<div class="container-fluid docs">
	<div class="row">
		<main class="docs-content" role="main">

<article class="article" data-pagefind-body>
	<span data-pagefind-filter="category" style="display:none">edgemax</span><span data-pagefind-filter="category" style="display:none">erl</span><span data-pagefind-filter="category" style="display:none">edgerouter lite</span><span data-pagefind-filter="category" style="display:none">tftp</span><span data-pagefind-filter="category" style="display:none">rj45</span><span data-pagefind-filter="category" style="display:none">screen</span><span data-pagefind-filter="category" style="display:none">squashfs</span><span data-pagefind-filter="category" style="display:none">router</span><span data-pagefind-filter="category" style="display:none">networking</span>
	<img data-pagefind-meta="image[src]" src="https://rmoff.net/images/2016/06/1__screen-1.png" style="display:none" alt="">
	<p>I&rsquo;ve got an <a href="https://www.ubnt.com/edgemax/edgerouter-lite/">EdgeRouter LITE</a> (ERL) which I used as my home router until a powercut fried it a while ago (<a href="https://community.ubnt.com/t5/EdgeMAX/2nd-Failed-ERLite/m-p/601815">looks like I&rsquo;m not the only one to have this issue</a>). The symptoms were it powering on but not giving any DHCP addresses, or after a factory reset responding on the default IP of 192.168.1.1. It was a real shame, because it had been a great bit of kit up until then. I am a complete hack when it comes to networking, and it struck the balance right between letting me do what I needed to do, without overwhelming me with complexity.
I&rsquo;d replaced it with a SonicWall TZ105 but having utterly failed to get the latter to permit OpenVPN traffic (so I can access my home server when on the road), which I had done with no problem on the ERL I thought I&rsquo;d try and resurrect the ERL using <a href="https://help.ubnt.com/hc/en-us/articles/204959514-EdgeMAX-Last-resort-recovery-of-failed-EdgeOS-device">the instructions here</a>.</p>
<p>I bought a <a href="https://www.amazon.co.uk/dp/B01A6OS6FK">RJ45-USB</a> cable from Amazon, and connected it to <strong>Console</strong> on the ERL and the USB to my Macbook Pro.</p>
<p>On my Mac, I determined USB device:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rmoff@asgard:~&gt; ls -l /dev/tty.usbserial*
</span></span><span style="display:flex;"><span>crw-rw-rw-  <span style="color:#666">1</span> root  wheel   18,   <span style="color:#666">4</span>  <span style="color:#666">8</span> Jun 17:01 /dev/tty.usbserial-AI038A4A
</span></span></code></pre></div><p>Using the eternally brilliant GNU <code>screen</code> as serial terminal client from standard Terminal/iTerm on the Mac:
(the 115200 is the <a href="https://help.ubnt.com/hc/en-us/articles/205202630-EdgeMAX-Connect-to-serial-console-port-default-settings">baud rate</a>)</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>screen /dev/tty.usbserial-AI038A4A <span style="color:#666">115200</span>
</span></span></code></pre></div><p>Powering up the router showed:</p>
<pre tabindex="0"><code>[...]
SQUASHFS error: zlib_inflate error, data probably corrupt
SQUASHFS error: squashfs_read_data failed to read block 0x29767f3
SQUASHFS error: Unable to read fragment cache entry [29767f3]
SQUASHFS error: Unable to read page, block 29767f3, size b168
SQUASHFS error: Unable to read fragment cache entry [29767f3]
SQUASHFS error: Unable to read page, block 29767f3, size b168
SQUASHFS error: Unable to read fragment cache entry [29767f3]
SQUASHFS error: Unable to read page, block 29767f3, size b168
SQUASHFS error: Unable to read fragment cache entry [29767f3]
SQUASHFS error: Unable to read page, block 29767f3, size b168
SQUASHFS error: Unable to read fragment cache entry [29767f3]
SQUASHFS error: Unable to read page, block 29767f3, size b168
start-stop-daemon: unable to start /usr/sbin/atd (Input/output error)
Starting routing daemon: rib.
Starting EdgeOS router: migrate rl-system configure.

Welcome to EdgeOS ubnt ttyS0

By logging in, accessing, or using the Ubiquiti product, you
acknowledge that you have read and understood the Ubiquiti
License Agreement (available in the Web UI at, by default,
http://192.168.1.1) and agree to be bound by its terms.

ubnt login:

[...]
</code></pre><p>And on a second occasion showed:</p>
<pre tabindex="0"><code> 0:0:0:0: [sda] No Caching mode page found
sd 0:0:0:0: [sda] Assuming drive cache: write through
sd 0:0:0:0: [sda] Attached SCSI removable disk
VFS: Cannot open root device &#34;sda2&#34; or unknown-block(8,2): error -17
Please append a correct &#34;root=&#34; boot option; here are the available partitions:
1f00             512 mtdblock0  (driver?)
1f01             512 mtdblock1  (driver?)
1f02              64 mtdblock2  (driver?)
0800         3789504 sda  driver: sd
  0801          145408 sda1 35e60000-01
  0802         1709056 sda2 35e60000-02
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(8,2)

*** NMI Watchdog interrupt on Core 0x00 ***
        $0      0x0000000000000000      at      0x0000000010000ce0
        v0      0xffffffffc0620000      v1      0x0000000000000000
        a0      0xffffffffc07b0478      a1      0x0000000000000001
        a2      0x0000000000000000      a3      0xffffffffc05f8028
        a4      0x0000000000000000      a5      0x0000000000000002
        a6      0x0000000000000002      a7      0x0000000000000000
        t0      0xffffffffc07c0000      t1      0xffffffffc05f8028
        t2      0xffffffffc07b0000      t3      0x0000000000000006
        s0      0xffffffffc0590000      s1      0xffffffffc058bdd0
        s2      0xffffffffc0590000      s3      0x0000000000000014
        s4      0xffffffffc05df940      s5      0xffffffffc0688a60
        s6      0x0000000000000004      s7      0x0000000000000001
        t8      0x0000000000000000      t9      0x000000000000032b
        k0      0xdab0f2c75931f243      k1      0xd0f77c4765a7af0b
        gp      0xffffffffc05dc000      sp      0xffffffffc05df6f0
        s8      0x0000000862f59974      ra      0xffffffffc04ea078
        err_epc 0xffffffffc00a1070      epc     0xffffffffc007a140
        status  0x0000000010480ce4      cause   0x0000000040808800
        sum0    0x000000f000000000      en0     0x0100000400000000
*** Chip soft reset soon ***
</code></pre><p>(<a href="https://community.ubnt.com/t5/EdgeMAX/SQUASHFS-error-and-repair/td-p/892730">this also looks worth trying</a>, but means opening up the ERL)</p>
<p>Started TFTP server on my Mac (<a href="http://www.barryodonovan.com/2014/11/08/os-x-built-in-tftp-server">h/t</a>):</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo launchctl load -F /System/Library/LaunchDaemons/tftp.plist
</span></span><span style="display:flex;"><span>sudo launchctl start com.apple.tftpd
</span></span></code></pre></div><p>Downloaded <code>emrk-0.9c.bin</code> from <a href="http://packages.vyos.net/tools/emrk/">http://packages.vyos.net/tools/emrk/</a> and copied it to the TFTP folder, to be used as a boot image for the ERL to run from across the network.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget http://packages.vyos.net/tools/emrk/0.9c/emrk-0.9c.bin
</span></span><span style="display:flex;"><span>sudo cp emrk-0.9c.bin /private/tftpboot/
</span></span></code></pre></div><p>Power up the ERL (or restart it if it&rsquo;s already on) and keep pressing a key in the Console window, which will interupt the boot sequence and land you at the bootloader console:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Looking <span style="color:#008000;font-weight:bold">for</span> valid bootloader image....
</span></span><span style="display:flex;"><span>Jumping to start of image at address 0xbfc80000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>U-Boot 1.1.1 <span style="color:#666">(</span>UBNT Build ID: 4493936-g009d77b<span style="color:#666">)</span> <span style="color:#666">(</span>Build time: Sep <span style="color:#666">20</span> <span style="color:#666">2012</span> - 15:48:51<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BIST check passed.
</span></span><span style="display:flex;"><span>UBNT_E100 r1:2, r2:14, serial <span style="color:#408080;font-style:italic">#: DC9FDB282DDB</span>
</span></span><span style="display:flex;"><span>Core clock: <span style="color:#666">500</span> MHz, DDR clock: <span style="color:#666">266</span> MHz <span style="color:#666">(</span><span style="color:#666">532</span> Mhz data rate<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>DRAM:  <span style="color:#666">512</span> MB
</span></span><span style="display:flex;"><span>Clearing DRAM....... <span style="color:#008000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>Flash:  <span style="color:#666">4</span> MB
</span></span><span style="display:flex;"><span>Net:   octeth0, octeth1, octeth2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USB:   <span style="color:#666">(</span>port 0<span style="color:#666">)</span> scanning bus <span style="color:#008000;font-weight:bold">for</span> devices... <span style="color:#666">1</span> USB Devices found
</span></span><span style="display:flex;"><span>       scanning bus <span style="color:#008000;font-weight:bold">for</span> storage devices...
</span></span><span style="display:flex;"><span>  Device 0: Vendor:          Prod.: USB DISK 2.0     Rev: PMAP
</span></span><span style="display:flex;"><span>            Type: Removable Hard Disk
</span></span><span style="display:flex;"><span>            Capacity: 3700.6 <span style="color:#19177c">MB</span> <span style="color:#666">=</span> 3.6 GB <span style="color:#666">(</span><span style="color:#666">7579008</span> x 512<span style="color:#666">)</span>                                                                                                                           <span style="color:#666">0</span>
</span></span><span style="display:flex;"><span>Octeon ubnt_e100#
</span></span></code></pre></div><p>Connect the ERL to your network (I used port 0), and then configure its network details:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Octeon ubnt_e100# <span style="color:#008000">set</span> ipaddr 192.168.10.2
</span></span><span style="display:flex;"><span>Octeon ubnt_e100# <span style="color:#008000">set</span> netmask 255.255.255.0
</span></span><span style="display:flex;"><span>Octeon ubnt_e100# <span style="color:#008000">set</span> serverip 192.168.10.79
</span></span><span style="display:flex;"><span>Octeon ubnt_e100# <span style="color:#008000">set</span> gatewayip 192.168.10.1
</span></span></code></pre></div><p>where:</p>
<ul>
<li><code>ipaddr</code> - the IP address to assign to the ERL</li>
<li><code>netmask</code> - <code>255.255.255.0</code> (I don&rsquo;t profess to be a networking expert; maybe this would vary in some cases?)</li>
<li><code>serverip</code> - the IP address of the TFTP server (my Mac, in this case)</li>
<li><code>gatewayip</code> - the IP address of the router currently in use (not the ERL, but the one acting as your current gateway). <a href="https://help.ubnt.com/hc/en-us/articles/204959514-EdgeMAX-Last-resort-recovery-of-failed-EdgeOS-device">According to the doc</a> this is optional.</li>
</ul>
<p>Then define the boot image to use, and transfer it to the ERL:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Octeon ubnt_e100# <span style="color:#008000">set</span> bootfile emrk-0.9c.bin
</span></span><span style="display:flex;"><span>Octeon ubnt_e100# tftpboot
</span></span><span style="display:flex;"><span>Using octeth0 device
</span></span><span style="display:flex;"><span>TFTP from server 192.168.10.79; our IP address is 192.168.10.2
</span></span><span style="display:flex;"><span>Filename <span style="color:#ba2121">&#39;emrk-0.9c.bin&#39;</span>.
</span></span><span style="display:flex;"><span>Load address: 0x9f00000
</span></span><span style="display:flex;"><span>Loading: <span style="color:#408080;font-style:italic">#################################################################</span>
</span></span><span style="display:flex;"><span>         <span style="color:#408080;font-style:italic">#############################################</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>Bytes <span style="color:#19177c">transferred</span> <span style="color:#666">=</span> <span style="color:#666">15665511</span> <span style="color:#666">(</span>ef0967 hex<span style="color:#666">)</span>, <span style="color:#666">9502</span> Kbytes/sec
</span></span><span style="display:flex;"><span>Octeon ubnt_e100#
</span></span></code></pre></div><p>Finally, initiate the boot sequence from the newly-transferred image:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Octeon ubnt_e100# bootoctlinux <span style="color:#19177c">$loadaddr</span>
</span></span><span style="display:flex;"><span>ELF file is <span style="color:#666">64</span> bit
</span></span><span style="display:flex;"><span>Allocating memory <span style="color:#008000;font-weight:bold">for</span> ELF segment: addr: 0xffffffff81100000 <span style="color:#666">(</span>adjusted to: 0x1100000<span style="color:#666">)</span>, size 0xe83940
</span></span><span style="display:flex;"><span>Allocated memory <span style="color:#008000;font-weight:bold">for</span> ELF segment: addr: 0xffffffff81100000, size 0xe83940
</span></span><span style="display:flex;"><span>Processing PHDR <span style="color:#666">0</span>
</span></span><span style="display:flex;"><span>  Loading e23d80 bytes at ffffffff81100000
</span></span><span style="display:flex;"><span>  Clearing 5fbc0 bytes at ffffffff81f23d80
</span></span><span style="display:flex;"><span><span style="color:#666">[</span>...<span style="color:#666">]</span>
</span></span></code></pre></div><p>On boot I got some errors:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Checking system image MD5 sum
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> Unhandled sense code
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> Result: <span style="color:#19177c">hostbyte</span><span style="color:#666">=</span>0x00 <span style="color:#19177c">driverbyte</span><span style="color:#666">=</span>0x08
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> Sense Key : 0x3 <span style="color:#666">[</span>current<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> <span style="color:#19177c">ASC</span><span style="color:#666">=</span>0x11 <span style="color:#19177c">ASCQ</span><span style="color:#666">=</span>0x0
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> CDB: cdb<span style="color:#666">[</span>0<span style="color:#666">]=</span>0x28: <span style="color:#666">28</span> <span style="color:#666">00</span> <span style="color:#666">00</span> <span style="color:#666">12</span> a4 <span style="color:#666">18</span> <span style="color:#666">00</span> <span style="color:#666">00</span> f0 <span style="color:#666">00</span>
</span></span><span style="display:flex;"><span>end_request: I/O error, dev sda, sector <span style="color:#666">1221656</span>
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> Unhandled sense code
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> Result: <span style="color:#19177c">hostbyte</span><span style="color:#666">=</span>0x00 <span style="color:#19177c">driverbyte</span><span style="color:#666">=</span>0x08
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> Sense Key : 0x3 <span style="color:#666">[</span>current<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> <span style="color:#19177c">ASC</span><span style="color:#666">=</span>0x11 <span style="color:#19177c">ASCQ</span><span style="color:#666">=</span>0x0
</span></span><span style="display:flex;"><span>sd 0:0:0:0: <span style="color:#666">[</span>sda<span style="color:#666">]</span> CDB: cdb<span style="color:#666">[</span>0<span style="color:#666">]=</span>0x28: <span style="color:#666">28</span> <span style="color:#666">00</span> <span style="color:#666">00</span> <span style="color:#666">13</span> d6 <span style="color:#666">60</span> <span style="color:#666">00</span> <span style="color:#666">00</span> f0 <span style="color:#666">00</span>
</span></span><span style="display:flex;"><span>end_request: I/O error, dev sda, sector <span style="color:#666">1300064</span>
</span></span><span style="display:flex;"><span>System image MD5 sum is not correct! Your image may be corrupted.
</span></span></code></pre></div><p>And then a prompt for accepting the licence and whether I wanted to use DHCP, to both of which I answered <code>yes</code>:</p>
<pre tabindex="0"><code>**********************************************
Welcome to EdgeMax Rescue Kit!

This tool is distributed under the terms of
GNU General Public License and other licenses

Brought to you by SO3 Group

[...]
</code></pre><p>At the <code>EMRK&gt;</code> prompt, I opted for the complete reinstall:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>EMRK&gt;emrk-reinstall
</span></span><span style="display:flex;"><span>WARNING: This script will reinstall EdgeOS from scratch
</span></span><span style="display:flex;"><span>If you have any usable data on your router storage,
</span></span><span style="display:flex;"><span>it will be irrecoverably destroyed!
</span></span><span style="display:flex;"><span>Do you want to <span style="color:#008000;font-weight:bold">continue</span>?
</span></span><span style="display:flex;"><span>yes or no: yes
</span></span><span style="display:flex;"><span>Unmounting boot partition
</span></span><span style="display:flex;"><span>Unmounting root partition
</span></span><span style="display:flex;"><span>Re-creating partition table
</span></span><span style="display:flex;"><span>Creating boot partition
</span></span><span style="display:flex;"><span>Formatting boot partition
</span></span><span style="display:flex;"><span>mkfs.vfat 3.0.9 <span style="color:#666">(</span><span style="color:#666">31</span> Jan 2010<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>Creating root partition
</span></span><span style="display:flex;"><span>Formatting root partition
</span></span><span style="display:flex;"><span>Mounting boot parition
</span></span><span style="display:flex;"><span>Mounting root partition
</span></span><span style="display:flex;"><span>kjournald starting.  Commit interval <span style="color:#666">5</span> seconds
</span></span><span style="display:flex;"><span>EXT3 FS on sda2, internal journal
</span></span><span style="display:flex;"><span>EXT3-fs: mounted filesystem with writeback data mode.
</span></span><span style="display:flex;"><span>Enter EdgeOS image url:http://dl.ubnt.com/firmwares/edgemax/v1.8.0/ER-e100.v1.8.0.4853089.tar
</span></span></code></pre></div><p>You&rsquo;re then prompted for the EdgeOS image, which you can find on the <a href="https://www.ubnt.com/download/edgemax/">Ubiquiti website</a>. I went for the one matching my router, <strong>ERLite</strong> (<code>EdgeRouter ERLite-3/ERPoe-5 Firmware v1.8.0</code>)</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Unpacking EdgeOS release image
</span></span><span style="display:flex;"><span>Verifying EdgeOS kernel
</span></span><span style="display:flex;"><span>Copying EdgeOS kernel to boot partition
</span></span><span style="display:flex;"><span>Verifying EdgeOS system image
</span></span><span style="display:flex;"><span>Copying EdgeOS system image to root partition
</span></span><span style="display:flex;"><span>Copying version file to the root partition
</span></span><span style="display:flex;"><span>Creating EdgeOS writable data directory
</span></span><span style="display:flex;"><span>Cleaning up
</span></span><span style="display:flex;"><span>Installation finished
</span></span><span style="display:flex;"><span>Please reboot your router
</span></span></code></pre></div><p>Now enter <code>reboot</code> to restart your hopefully-healthy ERL!</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>EMRK&gt;reboot
</span></span></code></pre></div><p>After the reboot things looked <em>much</em> healthier!</p>
<pre tabindex="0"><code>scsi 0:0:0:0: Direct-Access              USB DISK 2.0     PMAP PQ: 0 ANSI: 4
sd 0:0:0:0: [sda] 7579008 512-byte logical blocks: (3.88 GB/3.61 GiB)
sd 0:0:0:0: [sda] Write Protect is off
sd 0:0:0:0: [sda] No Caching mode page found
sd 0:0:0:0: [sda] Assuming drive cache: write through
sd 0:0:0:0: [sda] No Caching mode page found
sd 0:0:0:0: [sda] Assuming drive cache: write through
 sda: sda1 sda2
sd 0:0:0:0: [sda] No Caching mode page found
sd 0:0:0:0: [sda] Assuming drive cache: write through
sd 0:0:0:0: [sda] Attached SCSI removable disk
kjournald starting.  Commit interval 3 seconds
EXT3-fs (sda2): using internal journal
EXT3-fs (sda2): mounted filesystem with journal data mode
VFS: Mounted root (unionfs filesystem) on device 0:11.
Freeing unused kernel memory: 288K (ffffffffc0648000 - ffffffffc0690000)
Algorithmics/MIPS FPU Emulator v1.5
INIT: version 2.88 booting
INIT: Entering runlevel: 2
[ ok ] Starting routing daemon: rib nsm ribd.
[ ok ] Starting EdgeOS router: migrate rl-system configure.

Welcome to EdgeOS ubnt ttyS0

By logging in, accessing, or using the Ubiquiti product, you
acknowledge that you have read and understood the Ubiquiti
License Agreement (available in the Web UI at, by default,
http://192.168.1.1) and agree to be bound by its terms.

ubnt login:
</code></pre><p><em>If you accidently close your <code>screen</code> you&rsquo;ll find you get a &ldquo;Resource Busy&rdquo; and &ldquo;Sorry, could not find a PTY.&rdquo; error. Simply unplug the USB cable from your Mac and then plug it back in, and you&rsquo;ll be good to go again from where you left off</em></p>

	<hr>
	<div class="giscus-container">
		<script src="https://giscus.app/client.js"
				data-repo="rmoff/rmoff-blog"
				data-repo-id="MDEwOlJlcG9zaXRvcnkxNTE3NDg2MTE="
				data-category="Announcements"
				data-category-id="DIC_kwDOCQuAA84CvP5T"
				data-mapping="pathname"
				data-strict="1"
				data-reactions-enabled="1"
				data-emit-metadata="0"
				data-input-position="bottom"
				data-theme="light"
				data-lang="en"
				crossorigin="anonymous"
				async>
		</script>
	</div>
</article>
      </main>
    
      
      <div class="docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">On this page</a></li>
        </ul>
        <nav id="TableOfContents"></nav>
      </div>
      
    
    </div>
  </div>
</div>


		</main>

		

		
		<footer class="site-footer hide-print" role="contentinfo">
			<span>&copy; 2026 </span>
		</footer>
		

		
	</body>
</html>
