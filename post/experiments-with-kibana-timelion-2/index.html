<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8" />

  
  <title>Experiments with Kibana Timelion</title>

  
  
  <link href="//cdn.jsdelivr.net" rel="dns-prefetch">
  <link href="//cdnjs.cloudflare.com" rel="dns-prefetch">
  <link href="//at.alicdn.com" rel="dns-prefetch">
  <link href="//fonts.googleapis.com" rel="dns-prefetch">
  <link href="//fonts.gstatic.com" rel="dns-prefetch">
  
  
  
  
  

  

  
  <meta name="author" content="Robin Moffatt">
  <meta name="description" content="Timelion was released in November 2015 and with the 4.4.2 release of Kibana is available as a native visualisation once installed. It adds some powerful capabilities to Kibana as an timeseries analysis tool, using its own data manipulation language.
Installing Timelion is a piece of cake:
./bin/kibana plugin -i kibana/timelion  After restarting Kibana, you&amp;rsquo;ll see it as an option from the application picker
There&amp;rsquo;s a bit of a learning curve with Timelion, but it&amp;rsquo;s worth it.">

  
  
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@gohugoio">
    <meta name="twitter:title" content="Experiments with Kibana Timelion">
    <meta name="twitter:description" content="Timelion was released in November 2015 and with the 4.4.2 release of Kibana is available as a native visualisation once installed. It adds some powerful capabilities to Kibana as an timeseries analysis tool, using its own data manipulation language.
Installing Timelion is a piece of cake:
./bin/kibana plugin -i kibana/timelion  After restarting Kibana, you&amp;rsquo;ll see it as an option from the application picker
There&amp;rsquo;s a bit of a learning curve with Timelion, but it&amp;rsquo;s worth it.">
    <meta name="twitter:image" content="/images/avatar.jpg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:title" content="Experiments with Kibana Timelion">
  <meta property="og:description" content="Timelion was released in November 2015 and with the 4.4.2 release of Kibana is available as a native visualisation once installed. It adds some powerful capabilities to Kibana as an timeseries analysis tool, using its own data manipulation language.
Installing Timelion is a piece of cake:
./bin/kibana plugin -i kibana/timelion  After restarting Kibana, you&amp;rsquo;ll see it as an option from the application picker
There&amp;rsquo;s a bit of a learning curve with Timelion, but it&amp;rsquo;s worth it.">
  <meta property="og:url" content="https://rmoff.github.io/post/experiments-with-kibana-timelion-2/">
  <meta property="og:image" content="/images/avatar.jpg">




<meta name="generator" content="Hugo 0.52">


<link rel="canonical" href="https://rmoff.github.io/post/experiments-with-kibana-timelion-2/">

<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no,email=no,adress=no">
<meta http-equiv="Cache-Control" content="no-transform">


<meta name="robots" content="index,follow">
<meta name="referrer" content="origin-when-cross-origin">







<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="rmoff.net">
<meta name="msapplication-tooltip" content="rmoff.net">
<meta name='msapplication-navbutton-color' content="#5fbf5e">
<meta name="msapplication-TileColor" content="#5fbf5e">
<meta name="msapplication-TileImage" content="/images/tile-image-windows.png">
<link rel="icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" sizes="192x192" href="/images/touch-icon-android.png">
<link rel="apple-touch-icon" href="/images/touch-icon-apple.png">


<link rel="preload" href="/styles/main.min.css" as="style">
<link rel="preload" href="https://fonts.googleapis.com/css?family=Lobster" as="style">
<link rel="preload" href="/images/avatar.jpg" as="image">
<link rel="preload" href="/images/grey-prism.svg" as="image">


<style>
  body {
    background: rgb(244, 243, 241) url('/images/grey-prism.svg') repeat fixed;
  }
</style>
<link rel="stylesheet" href="/styles/main.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster">


<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.2/dist/medium-zoom.min.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video-js.min.css">



  
  
<!--[if lte IE 8]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/videojs-ie8@1.1.2/dist/videojs-ie8.min.js"></script>
<![endif]-->

<!--[if lte IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20180112/classList.min.js"></script>
<![endif]-->


<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@14.2.1/dist/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="/images/avatar.jpg" alt="Avatar">
  
  <h2 class="title">rmoff.net</h2>
  
  <p class="subtitle"></p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list"></ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Experiments with Kibana Timelion</h1>
      <p class="post-meta">@Robin Moffatt · Mar 29, 2016 · 4 min read</p>
    </header>
    <article class="post-content"><p><a href="https://www.elastic.co/blog/timelion-timeline">Timelion</a> was released in November 2015 and with the 4.4.2 release of <a href="https://www.elastic.co/products/kibana">Kibana</a> is available as a native visualisation once installed. It adds some powerful capabilities to Kibana as an timeseries analysis tool, using its own data manipulation language.</p>

<p>Installing Timelion is a piece of cake:</p>

<pre><code>./bin/kibana plugin -i kibana/timelion
</code></pre>

<p>After restarting Kibana, you&rsquo;ll see it as an option from the application picker</p>

<p><img src="/content/images/2016/03/2016-03-29_23-13-49.png" alt="" /></p>

<p>There&rsquo;s a bit of a learning curve with Timelion, but it&rsquo;s worth it. <a href="https://www.elastic.co/blog/timelion-timeline">The blog</a> gives some basics, and the built-in help is really good too:</p>

<p><img src="/content/images/2016/03/2016-03-29_23-12-28-1.png" alt="" /></p>

<p>Best of all is the built-in context completion when you&rsquo;re building up your expression:</p>

<p><img src="/content/images/2016/03/2016-03-29_23-16-18.png" alt="" /></p>

<p>The default expression, <code>.es(*)</code> shows a count of everything in Elasticsearch:</p>

<p><img src="/content/images/2016/03/2016-03-29_23-31-40.png" alt="" /></p>

<p>We can access metrics and perform aggregations on them. In this example I&rsquo;m using OS data collected from <a href="https://www.elastic.co/products/beats/topbeat">Topbeat</a>, and showing the system 1-minute load average:</p>

<pre><code>.es(metric='max:load.load1')
</code></pre>

<p><img src="/content/images/2016/03/2016-03-29_23-37-23.png" alt="" /></p>

<p>You can specify multiple metrics to plot, by comma-separating each expression:</p>

<pre><code>.es(metric='max:load.load1'), .es(metric='max:load.load5')
</code></pre>

<p><img src="/content/images/2016/03/2016-03-29_23-39-53.png" alt="" /></p>

<p>It starts to get really cool when you consider the chaining you can do with the Timelion functions within each expression. For example, adding a moving average to the data is as simple as including the function on the end of the expression:</p>

<pre><code>.es(index=logstash-*).movingaverage(12)
</code></pre>

<p><img src="/content/images/2016/03/2016-03-29_23-43-44.png" alt="" /></p>

<p>As well as data manipulation you can do formatting and labelling too, for example here with the <code>.label</code> function, and combined with the second time series to plot the actual and the moving average:</p>

<pre><code>.es(index=logstash-*),.es(index=logstash-*).movingaverage(12).label('12hr moving average')
</code></pre>

<p>In this syntax you can also see how you restrict the timeseries to a given set of Elasticsearch indices.</p>

<p><img src="/content/images/2016/03/2016-03-29_23-45-18.png" alt="" /></p>

<p>So that&rsquo;s data from Elasticsearch - but Timelion does more than that. It has support for pulling in data from other sources, including <a href="https://www.quandl.com/">Quandl</a>. This is useful as it provides a great way to access complex datasets for experimenting with Timelion.</p>

<p>Quandl gives free access to a whole bunch of time series data, including financial, economic and commodity prices. There&rsquo;s a paid option too for the most recent or intra-day data, but plenty of free stuff to play with. To get started simply sign up, which gives you access to your API key. Take this, and add it to the Timelion configuration file</p>

<pre><code class="language-bash">cd my-kibana-install-folder
cd installedPlugins/timelion/
cp timelion.json timelion.json.bak
vi timelion.json
</code></pre>

<p>Add your API key into the <code>quandl</code> part of the configuration:</p>

<pre><code class="language-json">{
  &quot;quandl&quot;: {
    &quot;key&quot;: &quot;nevergonnagiveyouup&quot;
  },
[...]
</code></pre>

<p>Restart Kibana, and you&rsquo;re good to go. To use Quandl find the timeseries of interest on the Quandl website. In this example we&rsquo;ve got the stock price of <a href="https://www.quandl.com/data/EURONEXT/HEIA">Heineken</a>. In the top-right you&rsquo;ll see the Quandl API code (in this example, it&rsquo;s <code>EURONEXT/HEIA</code>):</p>

<p><img src="/content/images/2016/03/2016-03-30_00-00-13.png" alt="" /></p>

<p>Head over to Timelion and create a new timeseries expression, using the Quandl API code you just got and the Timelion <code>.quandl</code> function:</p>

<pre><code>.quandl('EURONEXT/HEIA')
</code></pre>

<p><img src="/content/images/2016/03/2016-03-30_00-03-25.png" alt="" /></p>

<p>As before, you can plot multiple series on the same chart (note the use of the <code>.yaxis</code> function here to put the second series on the right-hand y-axis:</p>

<pre><code>.quandl('EURONEXT/HEIA'), .quandl('DY2/I3020000060').yaxis(2)
</code></pre>

<p><img src="/content/images/2016/03/2016-03-30_00-07-36.png" alt="" /></p>

<p>Multiple charts can be included on the same sheet, using the &ldquo;Add Chart&rdquo; button available from the options menu on the top-right of the page:</p>

<p><img src="/content/images/2016/03/2016-03-30_00-08-28-1.png" alt="" /></p>

<p>With multiple charts note that the hover-over cursor is mirrored on all charts for aiding comprehension:</p>

<p><img src="/content/images/2016/03/timelion01.gif" alt="" /></p>

<hr />

<p>The Timelion plugin as seen above is a good place to start for trying it out, but as of 4.4.2 release of Kibana once you&rsquo;ve installed Timelion it&rsquo;s available within Kibana itself:</p>

<p><img src="/content/images/2016/03/2016-03-30_00-22-33.png" alt="" /></p>

<p>You can build up the visualisation using the same syntax as before:</p>

<pre><code>.quandl('EURONEXT/HEIA'),.quandl('GOOG/NASDAQ_MLHR')
</code></pre>

<p><img src="/content/images/2016/03/2016-03-30_00-23-18-1.png" alt="" /></p>

<p>Since it&rsquo;s a native visualisation object in Kibana, this means that you can include Timelion in your Kibana dashboards too:</p>

<p><img src="/content/images/2016/03/2016-03-30_00-26-39-1.png" alt="" /></p>

<p>(<em>Just in case you ever want to show CPU performance against the stock price of a beer company&hellip;</em>)</p>

<hr />

<p>So I think Timelion is pretty damned neat. It&rsquo;s worth taking the time to figure out the syntax, as its potential is great - and its close integration with Kibana bodes well for its future in the product.</p>

<p>What are you waiting for? Even if you&rsquo;ve not got any data in Elasticsearch, you can use Quandl to start exploring the potential for Timelion. <a href="https://www.elastic.co/blog/timelion-timeline">Go get it now</a>!</p>
</article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="/tags/kibana"><span class="tag">Kibana</span></a></li>
        
          <li><a href="/tags/timelion"><span class="tag">Timelion</span></a></li>
        
          <li><a href="/tags/quandl"><span class="tag">Quandl</span></a></li>
        
          <li><a href="/tags/topbeat"><span class="tag">Topbeat</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        This post was published <strong>991</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.
      </p>
    </footer>
    
      
    
  </section>
  


<footer class="site-footer">
  <p>© 2017-2018 rmoff.net</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="https://cdn.jsdelivr.net/npm/video.js@7.3.0/dist/video.min.js"></script>




<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    },
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>



<script src="/scripts/index.min.js"></script>








  </body>
</html>
