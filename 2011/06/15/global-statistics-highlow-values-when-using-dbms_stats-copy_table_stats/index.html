<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" as="image" href="https://rmoff.net/img/default-header-img.webp" type="image/webp">
		
		<title>Global statistics high/low values when using DBMS_STATS.COPY_TABLE_STATS</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2011/06/15/global-statistics-highlow-values-when-using-dbms_stats-copy_table_stats/">
		
		

		
		<meta property="og:title" content="Global statistics high/low values when using DBMS_STATS.COPY_TABLE_STATS" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/img/default-header-img.jpg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2011/06/15/global-statistics-highlow-values-when-using-dbms_stats-copy_table_stats/" />
		<meta property="og:site_name" content="Global statistics high/low values when using DBMS_STATS.COPY_TABLE_STATS" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<style>
			html { background-color: #FAF8F5; color: #2D2926; }
			body { opacity: 0; transition: opacity 0.1s ease; }
			body.loaded { opacity: 1; }
			.site-header { height: 60px; background-color: #FAF8F5; border-bottom: 1px solid #E8421E; }
		</style>

		
		
		<link rel="stylesheet" href="https://rmoff.net/css/redesign.css" />
		
		<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap">
		<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
		<noscript><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet"></noscript>
		

		

		
		<script>
			!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
            posthog.init('phc_93NEP79Ju4xqXYWXnoLbr4HMW0Iaepj1BGOVoEXYX6P',{api_host:'https://eu.i.posthog.com', person_profiles: 'identified_only'})
		</script>

		
		<script src="https://rmoff.net/js/story.js"></script>
		<script src="https://rmoff.net/js/toc.js"></script>
		<script src="https://rmoff.net/js/medium-mirror.js"></script>
	</head>
	<body class="ma0 section-post page-kind-page is-page-true ">
		<script>document.body.classList.add('loaded');</script>

		<header class="site-header hide-print">
	<div class="site-header-inner">
		<a href="https://rmoff.net/" class="site-title">rmoff's random ramblings</a>
		<nav class="site-nav">
			<a href="/categories/interesting-links/" class="nav-il"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> Interesting Links</a>
			<span class="nav-sep"></span>
			<a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg> Categories</a>
			<a href="https://rmoff.net/search/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg> Search</a>
			<a href="https://rmoff.net/index.xml"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg> RSS</a>
			<div class="nav-social">
				<a href="https://www.linkedin.com/in/robinmoffatt/" title="linkedin"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
				<a href="https://twitter.com/rmoff/" title="twitter"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
				<a href="https://bsky.app/profile/rmoff.net" title="bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 568 501" fill="currentColor"><path d="M123.121 33.664C188.241 82.553 258.281 181.68 284 234.873c25.719-53.192 95.759-152.32 160.879-201.21C491.866-1.611 568-28.906 568 57.947c0 17.346-9.945 145.713-15.778 166.555-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281-2.462-7.227-3.614-10.608-3.631-7.733-.017-2.875-1.169.506-3.631 7.733-13.43 39.422-65.842 193.273-185.702 70.281-63.111-64.76-33.89-129.52 80.986-149.071-65.72 11.185-139.6-7.295-159.875-79.748C10.945 203.659 1 75.291 1 57.946 1-28.906 76.135-1.612 123.121 33.664z"/></svg></a>
				<a href="https://www.youtube.com/c/rmoff" title="youtube"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
				<a href="https://talks.rmoff.net" title="talks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="0"/><line x1="12" y1="17" x2="12" y2="22"/><line x1="8" y1="22" x2="16" y2="22"/><polyline points="7 8 12 12 17 8"/></svg></a>
				<a href="https://github.com/rmoff/" title="github"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
			</div>
		</nav>
		<button class="nav-toggle" onclick="document.querySelector('.mobile-nav').classList.toggle('open')" aria-label="Menu">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
		</button>
	</div>
	<nav class="mobile-nav">
		<a href="https://rmoff.net/">Home</a>
		<a href="/categories/">Categories</a>
		<a href="/categories/interesting-links/">Interesting Links</a>
		<a href="https://rmoff.net/search/">Search</a>
		<a href="https://rmoff.net/index.xml">RSS</a>
		<a href="https://www.linkedin.com/in/robinmoffatt/">linkedin</a>
		<a href="https://twitter.com/rmoff/">twitter</a>
		<a href="https://bsky.app/profile/rmoff.net">bluesky</a>
		<a href="https://www.youtube.com/c/rmoff">youtube</a>
		<a href="https://talks.rmoff.net">talks</a>
		<a href="https://github.com/rmoff/">github</a>
	</nav>
</header>


		<main role="main">
		

<div class="article-hero" style="background-image: url('https://rmoff.net/img/default-header-img.webp');">
	<div class="article-hero-overlay">
		<div class="article-hero-content">
			<h1>Global statistics high/low values when using DBMS_STATS.COPY_TABLE_STATS</h1>
			<p class="article-hero-meta">
				
					<time datetime="2011-06-15T00:00:00Z">15 Jun 2011</time>
					<span class="display-print">by </span>
					 &middot; <a href="https://rmoff.net/categories/copy_table_stats">copy_table_stats</a>, <a href="https://rmoff.net/categories/dbms_stats">dbms_stats</a>, <a href="https://rmoff.net/categories/dwh">dwh</a>, <a href="https://rmoff.net/categories/oracle">oracle</a>, <a href="https://rmoff.net/categories/statistics">statistics</a>
					<span class="display-print">at https://rmoff.net/2011/06/15/global-statistics-highlow-values-when-using-dbms_stats-copy_table_stats/</span>
				
			</p>
		</div>
	</div>
</div>


<details class="toc-mobile">
	<summary>Table of Contents</summary>
	<nav id="TableOfContents"></nav>
</details>

<div class="container-fluid docs">
	<div class="row">
		<main class="docs-content" role="main">

<article class="article" data-pagefind-body>
	<span data-pagefind-filter="category" style="display:none">copy_table_stats</span><span data-pagefind-filter="category" style="display:none">dbms_stats</span><span data-pagefind-filter="category" style="display:none">dwh</span><span data-pagefind-filter="category" style="display:none">oracle</span><span data-pagefind-filter="category" style="display:none">statistics</span>
	<img data-pagefind-meta="image[src]" src="https://rmoff.net/img/default-header-img.jpg" style="display:none" alt="">
	<p>There is a well-documented problem relating to DBMS_STATS.COPY_TABLE_STATS between partitions where high/low values of the partitioning key column were just copied verbatim from the source partition. This particular problem has now been patched (see <a href="https://supporthtml.oracle.com/ep/faces/secure/km/DocumentDisplay.jspx?id=8318020.8">8318020.8</a>). For background, see Doug Burns&rsquo; <a href="http://oracledoug.com/serendipity/">blog</a> and his <a href="http://oracledoug.com/serendipity/index.php?/archives/1632-Symposium-2011-My-Presentation.html">excellent paper</a> which covers the whole topic of statistics on partitioned tables.</p>
<p>This post <a href="http://blogs.oracle.com/optimizer/2009/02/maintaining_statistics_on_large_partitioned_tables.html">Maintaining statistics on large partitioned tables</a> on the Oracle Optimizer blog details what the dbms_stats.copy_table_stats does with regards to the high/low values:</p>
<blockquote>
<p><em>It adjusts the minimum and maximum values of the partitioning column as follows; it uses the high bound partitioning value as the maximum value of the first partitioning column (it is possible to have concatenated partition columns) and high bound partitioning value of the previous partition as the minimum value of the first partitioning column for range partitioned table</em></p>
</blockquote>
<p>However, two problems as I see them remain:</p>
<ol>
<li>Table global stats don&rsquo;t update high_value for partitioning key</li>
<li>high_value of one partition overlaps with low_value of the next.
<ul>
<li>Partition high-bound values are defined as <strong>LESS THAN</strong>, not <strong>LESS THAN OR EQUAL TO</strong> - therefore the maximum possible value of the column is <strong>less</strong> than this, not <strong>equal</strong> to it.</li>
<li>The minimum value of the partitioning column <strong>is correct</strong> using this method (although be aware of <a href="https://supporthtml.oracle.com/ep/faces/secure/km/DocumentDisplay.jspx?id=10233186.8&amp;h=Y">10233186</a> if you use a MAXVALUE in your range partitioning).</li>
</ul>
</li>
</ol>
<p>Here&rsquo;s a script that demonstrates the two issues, written and commented based on execution on 11.1.0.7:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">/* copy_stats_1.sql
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">Illustrate apparent problem with high_val on partition statistics when using partition to partition statistics copy
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">  * Table global stats do not update high_value for partitioning key
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">  * high_value of one partition overlaps with low_value of the next.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">Requires display_raw function by Greg Rahn, see here: http://tinyurl.com/display-raw
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">https://rnm1978.wordpress.com/
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">*/</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>timing<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>feedback<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>linesize<span style="color:#bbb"> </span><span style="color:#666">156</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>pagesize<span style="color:#bbb"> </span><span style="color:#666">57</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>a10<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>a30<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>a30<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>a20<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span>low_val<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>a10<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span>high_val<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>a10<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span>num_rows<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span><span style="color:#666">999</span>,<span style="color:#666">999</span>,<span style="color:#666">999</span>,<span style="color:#666">999</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>col<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;sum of num_rows&#34;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span><span style="color:#666">999</span>,<span style="color:#666">999</span>,<span style="color:#666">999</span>,<span style="color:#666">999</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>break<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb"> </span>skip<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>duplicates<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>clear<span style="color:#bbb"> </span>screen<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">=====</span><span style="color:#bbb"> </span>This<span style="color:#bbb"> </span>script<span style="color:#bbb"> </span>uses<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>DISPLAY_RAW<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">function</span><span style="color:#bbb"> </span><span style="color:#666">=======</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>Available<span style="color:#bbb"> </span>here:<span style="color:#bbb"> </span>http:<span style="color:#666">//</span>structureddata.org<span style="color:#666">/</span><span style="color:#666">2007</span><span style="color:#666">/</span><span style="color:#666">10</span><span style="color:#666">/</span><span style="color:#666">16</span><span style="color:#666">/</span>how<span style="color:#666">-</span><span style="color:#008000;font-weight:bold">to</span><span style="color:#666">-</span>display<span style="color:#666">-</span>high_valuelow_value<span style="color:#666">-</span>columns<span style="color:#666">-</span><span style="color:#008000;font-weight:bold">from</span><span style="color:#666">-</span>user_tab_col_statistics<span style="color:#666">/</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">========================================================</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">1</span>.<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Set</span><span style="color:#bbb"> </span>up<span style="color:#bbb"> </span>an<span style="color:#bbb"> </span>partitioned<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">with</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">data</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>examine<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">statistics</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Create fact table
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">drop</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span>BASE_DATA;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span>BASE_DATA<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>day_key<span style="color:#bbb"> </span><span style="color:#008000">integer</span>,<span style="color:#bbb"> </span>store_key<span style="color:#bbb"> </span><span style="color:#008000">INTEGER</span>,<span style="color:#bbb">  </span>item_key<span style="color:#bbb">  </span><span style="color:#008000">INTEGER</span>,<span style="color:#bbb"> </span>fact_001<span style="color:#bbb"> </span><span style="color:#008000">NUMBER</span>(<span style="color:#666">15</span>,<span style="color:#666">0</span>),<span style="color:#bbb"> </span>fact_002<span style="color:#bbb"> </span><span style="color:#008000">NUMBER</span>(<span style="color:#666">15</span>,<span style="color:#666">0</span>),<span style="color:#bbb"> </span>fact_003<span style="color:#bbb"> </span><span style="color:#008000">NUMBER</span>(<span style="color:#666">18</span>,<span style="color:#666">2</span>))<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>PARTITION<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">BY</span><span style="color:#bbb"> </span>RANGE<span style="color:#bbb"> </span>(DAY_KEY)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>SUBPARTITION<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">BY</span><span style="color:#bbb"> </span>HASH<span style="color:#bbb"> </span>(store_key)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>SUBPARTITION<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">TEMPLATE</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>SUBPARTITION<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;SP1&#34;</span><span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>SUBPARTITION<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;SP2&#34;</span><span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>SUBPARTITION<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;SP3&#34;</span><span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>SUBPARTITION<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;SP4&#34;</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>PARTITION<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;PART_20110401&#34;</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">VALUES</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">LESS</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">THAN</span><span style="color:#bbb"> </span>(<span style="color:#666">20110402</span>))<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>PARALLEL;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Create indexes
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">UNIQUE</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">INDEX</span><span style="color:#bbb"> </span>BASE_DATA_PK<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">ON</span><span style="color:#bbb"> </span>BASE_DATA<span style="color:#bbb"> </span>(<span style="color:#ba2121">&#34;DAY_KEY&#34;</span>,<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;STORE_KEY&#34;</span>,<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;ITEM_KEY&#34;</span>)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">LOCAL</span><span style="color:#bbb"> </span>parallel;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">create</span><span style="color:#bbb"> </span>bitmap<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">index</span><span style="color:#bbb"> </span>base_data_ix2<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span>(store_key)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">local</span><span style="color:#bbb"> </span>parallel;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">create</span><span style="color:#bbb"> </span>bitmap<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">index</span><span style="color:#bbb"> </span>base_data_ix3<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span>(item_key)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">local</span><span style="color:#bbb"> </span>parallel;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Populate fact table
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">exec</span><span style="color:#bbb"> </span>DBMS_RANDOM.SEED(<span style="color:#ba2121">&#39;StraussCookPieterson&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">into</span><span style="color:#bbb"> </span>BASE_DATA<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span>(<span style="color:#666">20110401</span>,<span style="color:#666">101</span>,<span style="color:#666">2000</span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">into</span><span style="color:#bbb"> </span>BASE_DATA<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span>(<span style="color:#666">20110401</span>,<span style="color:#666">102</span>,<span style="color:#666">2000</span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">commit</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Gather full stats on table
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>feedback<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">exec</span><span style="color:#bbb"> </span>dbms_stats.gather_table_stats(<span style="color:#bbb">     </span>ownname<span style="color:#666">=&gt;</span><span style="color:#008000;font-weight:bold">USER</span>,<span style="color:#bbb"> </span>tabname<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span>,<span style="color:#bbb"> </span>granularity<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;AUTO&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>feedback<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span>day_key;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Examine statistics
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_TABLES<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partitioning_type,<span style="color:#bbb"> </span>subpartitioning_type,<span style="color:#bbb"> </span>partition_count<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_part_tables<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATS_HISTORY<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,<span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">FROM</span><span style="color:#bbb">   </span>dba_tab_stats_history<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">WHERE</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">AND</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">ORDER</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">BY</span><span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">asc</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(<span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">only</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span><span style="color:#666">**************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>compute<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">sum</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>num_rows<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>report<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(Partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">*************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>subpartition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>clear<span style="color:#bbb"> </span>computes<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.partition_name,a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>Observe:<span style="color:#bbb"> </span>Partition<span style="color:#bbb"> </span>high<span style="color:#666">/</span>low<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>DAY_KEY<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span>currently<span style="color:#bbb"> </span><span style="color:#666">1</span>st<span style="color:#bbb"> </span>April<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">***********************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>Observe:<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Table</span><span style="color:#bbb"> </span>high<span style="color:#666">/</span>low<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>DAY_KEY<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span>currently<span style="color:#bbb"> </span><span style="color:#666">1</span>st<span style="color:#bbb"> </span>April<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">2</span>.<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Create</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">new</span><span style="color:#bbb"> </span>partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>use<span style="color:#bbb"> </span>dbms_stats.copy_table_stats<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">to</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>stats<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>it.<span style="color:#bbb"> </span>Leave<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">data</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">in</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span>unchanged.<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>feedback<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">alter</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">add</span><span style="color:#bbb"> </span>PARTITION<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;PART_20110402&#34;</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">VALUES</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">LESS</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">THAN</span><span style="color:#bbb"> </span>(<span style="color:#666">20110403</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">exec</span><span style="color:#bbb"> </span>dbms_stats.copy_table_stats(ownname<span style="color:#666">=&gt;</span><span style="color:#008000;font-weight:bold">USER</span>,<span style="color:#bbb"> </span>tabname<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span>,SRCPARTNAME<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;PART_20110401&#39;</span>,DSTPARTNAME<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;PART_20110402&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>feedback<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span>day_key;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Examine statistics
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_TABLES<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partitioning_type,<span style="color:#bbb"> </span>subpartitioning_type,<span style="color:#bbb"> </span>partition_count<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_part_tables<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATS_HISTORY<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,<span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">FROM</span><span style="color:#bbb">   </span>dba_tab_stats_history<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">WHERE</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">AND</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">ORDER</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">BY</span><span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">asc</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(<span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">only</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span><span style="color:#666">**************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>compute<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">sum</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>num_rows<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>report<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(Partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">*************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>subpartition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>clear<span style="color:#bbb"> </span>computes<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>Side<span style="color:#bbb"> </span>note:<span style="color:#bbb"> </span>Oracle<span style="color:#bbb"> </span>doesn<span style="color:#ba2121">&#39;t aggregate the partition num_rows statistic up to global when doing a copy stats, 
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">prompt            so whilst the sum of partition num_rows is four, the global num_rows is still two.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">prompt            Of course, at this point, there are only actually two rows of data in the table.
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">prompt   
</span></span></span><span style="display:flex;"><span><span style="color:#ba2121">prompt (also, observe that LAST_ANALYZED for the new partition is that of the partition from where the stats were copied, and isn&#39;</span>t<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span>the<span style="color:#bbb"> </span>same<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>STATS_UPDATE_TIME<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>DBA_TAB_STATS_HISTORY<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span>which<span style="color:#bbb"> </span>makes<span style="color:#bbb"> </span>sense<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">when</span><span style="color:#bbb"> </span>you<span style="color:#bbb"> </span>think<span style="color:#bbb"> </span>about<span style="color:#bbb"> </span>it)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_PARTITIONS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">********************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_tab_partitions<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>table_owner<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.partition_name,a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>See<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>Partition<span style="color:#bbb"> </span>high<span style="color:#666">/</span>low<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>DAY_KEY<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">in</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">new</span><span style="color:#bbb"> </span>partition<span style="color:#bbb"> </span>(PART_20110402)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">into</span><span style="color:#bbb"> </span>which<span style="color:#bbb"> </span>we<span style="color:#bbb"> </span>copied<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>stats:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#408080;font-style:italic">--&gt; low_value is correct
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>prompt<span style="color:#bbb"> </span><span style="color:#408080;font-style:italic">--&gt; high_value is out of range for possible data in that partition
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>prompt<span style="color:#bbb"> </span><span style="color:#408080;font-style:italic">-----&gt; high_value of the partition is USER, tabname=&gt;&#39;BASE_DATA&#39;,SRCPARTNAME=&gt;&#39;PART_20110401&#39;,DSTPARTNAME=&gt;&#39;PART_20110403&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>feedback<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span>day_key;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Examine statistics
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_TABLES<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partitioning_type,<span style="color:#bbb"> </span>subpartitioning_type,<span style="color:#bbb"> </span>partition_count<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_part_tables<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATS_HISTORY<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,<span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">FROM</span><span style="color:#bbb">   </span>dba_tab_stats_history<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">WHERE</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">AND</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">ORDER</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">BY</span><span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">asc</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(<span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">only</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span><span style="color:#666">**************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>compute<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">sum</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>num_rows<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>report<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(Partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">*************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>subpartition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>clear<span style="color:#bbb"> </span>computes<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_PARTITIONS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">********************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_tab_partitions<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>table_owner<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.partition_name,a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>You<span style="color:#bbb"> </span>can<span style="color:#bbb"> </span>see<span style="color:#bbb"> </span>that<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">new</span><span style="color:#bbb"> </span>partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span>again<span style="color:#bbb"> </span>too<span style="color:#bbb"> </span>high<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>possible<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>partition<span style="color:#bbb"> </span>could<span style="color:#bbb"> </span>contain<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>But<span style="color:#bbb"> </span>this<span style="color:#bbb"> </span>time<span style="color:#bbb"> </span>we<span style="color:#bbb"> </span>can<span style="color:#bbb"> </span>also<span style="color:#bbb"> </span>see<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>overlapping<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>previous<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">column</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">with</span><span style="color:#bbb"> </span>low_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">next</span>.<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">   </span>PART_20110401<span style="color:#bbb"> </span>has<span style="color:#bbb"> </span><span style="color:#008000">real</span><span style="color:#bbb"> </span>stats<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">   </span>PART_20110402<span style="color:#bbb"> </span>has<span style="color:#bbb"> </span>copied<span style="color:#bbb"> </span>stats,<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">with</span><span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>(wrong)<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span><span style="color:#666">20110403</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">   </span>PART_20110403<span style="color:#bbb"> </span>has<span style="color:#bbb"> </span>copied<span style="color:#bbb"> </span>stats,<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">with</span><span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>low_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span><span style="color:#666">20110403</span><span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span>which<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>same<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>previous<span style="color:#bbb"> </span>partition<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">***********************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Table</span><span style="color:#bbb"> </span>high<span style="color:#666">/</span>low<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>DAY_KEY<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span>still<span style="color:#bbb"> </span><span style="color:#666">1</span>st<span style="color:#bbb"> </span>April,<span style="color:#bbb"> </span>even<span style="color:#bbb"> </span>though<span style="color:#bbb"> </span>the<span style="color:#bbb"> </span>stats<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>individual<span style="color:#bbb"> </span>partitions<span style="color:#bbb"> </span>has<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>(wrong)<span style="color:#bbb"> </span>high_val<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span><span style="color:#666">4</span>th<span style="color:#bbb"> </span>April.<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Add</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">data</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">to</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table</span>,<span style="color:#bbb"> </span>gather<span style="color:#bbb"> </span><span style="color:#008000">real</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">statistics</span>,<span style="color:#bbb"> </span>examine<span style="color:#bbb"> </span>them.<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Populate fact table
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">into</span><span style="color:#bbb"> </span>BASE_DATA<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span>(<span style="color:#666">20110402</span>,<span style="color:#666">101</span>,<span style="color:#666">2000</span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">into</span><span style="color:#bbb"> </span>BASE_DATA<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span>(<span style="color:#666">20110403</span>,<span style="color:#666">101</span>,<span style="color:#666">2000</span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>,<span style="color:#bbb"> </span>dbms_random.value(<span style="color:#666">0</span>,<span style="color:#666">999</span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">commit</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- gather full stats
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">exec</span><span style="color:#bbb"> </span>dbms_stats.gather_table_stats(<span style="color:#bbb">     </span>ownname<span style="color:#666">=&gt;</span><span style="color:#008000;font-weight:bold">USER</span>,<span style="color:#bbb"> </span>tabname<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span>,<span style="color:#bbb"> </span>granularity<span style="color:#666">=&gt;</span><span style="color:#ba2121">&#39;AUTO&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>base_data<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span>day_key;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">-- Examine statistics
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">set</span><span style="color:#bbb"> </span>echo<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">off</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_TABLES<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partitioning_type,<span style="color:#bbb"> </span>subpartitioning_type,<span style="color:#bbb"> </span>partition_count<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_part_tables<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATS_HISTORY<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,<span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">FROM</span><span style="color:#bbb">   </span>dba_tab_stats_history<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">WHERE</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">AND</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">ORDER</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">BY</span><span style="color:#bbb"> </span>stats_update_time<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">asc</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(<span style="color:#008000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">only</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">  </span><span style="color:#666">**************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>compute<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">sum</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">of</span><span style="color:#bbb"> </span>num_rows<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>report<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb"> </span>(Partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">level</span>):<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">*************************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name,num_rows,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>to_char(LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_STATISTICS<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>subpartition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">order</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span>,partition_name<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>clear<span style="color:#bbb"> </span>computes<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Table</span><span style="color:#bbb"> </span>num_rows<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span>now<span style="color:#bbb"> </span>accurate<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_PARTITIONS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">********************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>partition_name,<span style="color:#bbb"> </span>high_value<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>dba_tab_partitions<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>table_owner<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">************************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.partition_name,a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_PART_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.partition_name<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>Partition<span style="color:#bbb"> </span>high<span style="color:#666">/</span>low<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>DAY_KEY<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">in</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">each</span><span style="color:#bbb"> </span>partition<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">is</span><span style="color:#bbb"> </span>correct<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span>DBA_TAB_COL_STATISTICS:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#666">***********************</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">select</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span>,to_char(a.LAST_ANALYZED,<span style="color:#ba2121">&#39;YYYY-MM-DD-HH24:MI:SS&#39;</span>)<span style="color:#bbb"> </span><span style="color:#ba2121">&#34;LAST_ANALYZED&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>display_raw(a.low_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>low_val,display_raw(a.high_value,b.data_type)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">as</span><span style="color:#bbb"> </span>high_val<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">from</span><span style="color:#bbb"> </span>DBA_TAB_COL_STATISTICS<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">inner</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">join</span><span style="color:#bbb"> </span>dba_tab_cols<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">on</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span>b.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#008000;font-weight:bold">where</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">table_name</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;BASE_DATA&#39;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">owner</span><span style="color:#666">=</span><span style="color:#008000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">and</span><span style="color:#bbb"> </span>a.<span style="color:#008000;font-weight:bold">column_name</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;DAY_KEY&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>prompt<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">Table</span><span style="color:#bbb"> </span>high<span style="color:#666">/</span>low<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">for</span><span style="color:#bbb"> </span>DAY_KEY<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">are</span><span style="color:#bbb"> </span>now<span style="color:#bbb"> </span>correct<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>pause<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#408080;font-style:italic">/* #EOF */</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>From everything that I&rsquo;ve read, representative stats are essential for Oracle to generate the most efficient explain plan to give the most optimal performance. Out of range problems caused by inaccurate statistics is something frequently referenced. However I&rsquo;m out of my depth here to determine whether that&rsquo;s true for the global statistics of this partitioning column not getting updated.</p>
<p>Copying stats have never been intended as a replacement for real stats, that much is clear and frequently stated. They should be part of a carefully designed stats gathering method, based on your applications data and frequency of loading. Hopefully the above, along with the other articles about copy stats out there, will add to the understanding of the functionality and importantly, its limitations. Copying the stats will just buy you time in a critical load schedule, postponing the point at which you do a proper gather. All copy stats is doing is making the statistics a bit more representative of the data - it&rsquo;s not a proper sample of the data so the quality of the stats will never be as good as if you do a proper gather. When you do the real gather should be whichever comes first of:</p>
<ul>
<li>the point at which you have time in your batch schedule<br>
or,</li>
<li>the stats are too unrepresentative of your data for the Oracle optimizer to generate a sufficiently efficient explain plan in order for your queries to run in the time which the users require.</li>
</ul>
<hr>
<p>Maria Colgan from Oracle has kindly reviewed my script and findings, and commented:</p>
<blockquote>
<p>Your argument that copy stats sets the high_value wrongly (to high), is correct. We do over estimate the high value by setting it to the partition definition. As you correctly point out no value in the partition will have reach that high_value because a range partition is always specified as less than. We did this so that we can ensure there will be no greater value than this in the partition, otherwise we would have to guess what the max value is.</p>
</blockquote>
<p>Maria also pointed out that with regards to the overlapping high/low values</p>
<blockquote>
<p>However, this is not the expected behavior. The goal of copy_stats is to provide a temporary fix to the out of range problem by providing a representative set of statistics for a new partition. It is not supposed to be a replacement for statistics gathering.</p>
</blockquote>
<hr>
<p>Reading:</p>
<ul>
<li>Doug Burns&rsquo; series of blog postings about <a href="http://oracledoug.com/serendipity/index.php?/archives/1590-Statistics-on-Partitioned-Tables-Contents.html">Statistics on Partitioned Tables</a></li>
<li><a href="http://structureddata.org/2008/03/26/choosing-an-optimal-stats-gathering-strategy/">Greg Rahn - Choosing An Optimal Stats Gathering Strategy</a></li>
<li><a href="http://blogs.oracle.com/optimizer/2009/02/maintaining_statistics_on_large_partitioned_tables.html">Oracle Optimizer - Maintaining statistics on large partitioned tables</a></li>
<li><a href="http://seilerwerks.wordpress.com/2007/08/17/dr-statslove-or-how-i-learned-to-stop-guessing-and-love-the-10053-trace/">Don Seiler - Dr. Statslove or: How I Learned to Stop Guessing and Love the 10053 Trace</a></li>
<li><a href="http://structureddata.org/2007/11/21/troubleshooting-bad-execution-plans/">Greg Rahn - Troubleshooting Bad Execution Plans</a></li>
<li><a href="http://structureddata.org/2007/09/17/oracle-11g-enhancements-to-dbms_stats/">Greg Rahn - Oracle 11g: Enhancements to DBMS_STATS</a></li>
<li>Amit Bansal has written about this problem here <a href="http://askdba.org/weblog/?p=496">here</a> and includes a script for copying the statistics between partitions manually.</li>
</ul>
<p>Watch out for these other bugs that I came across reference to:</p>
<ul>
<li><a href="https://supporthtml.oracle.com/ep/faces/secure/km/DocumentDisplay.jspx?id=10234419.8&amp;h=Y">10234419</a> Extend dbms_stats.copy_table_stats to all range partitioning key columns</li>
<li><a href="https://supporthtml.oracle.com/ep/faces/secure/km/DocumentDisplay.jspx?id=1292269.1&amp;h=Y">Doc ID 1292269.1</a>ORA-01422 While running dbms_stats.copy_table_stats
<ul>
<li>&quot; This issue would occur when there are more than one schema with same table name.&quot;</li>
</ul>
</li>
</ul>
<p><em>Many thanks to Maria Colgan and Doug Burns for reviewing this post and providing useful feedback.</em></p>

	<hr>
	<div class="giscus-container">
		<script src="https://giscus.app/client.js"
				data-repo="rmoff/rmoff-blog"
				data-repo-id="MDEwOlJlcG9zaXRvcnkxNTE3NDg2MTE="
				data-category="Announcements"
				data-category-id="DIC_kwDOCQuAA84CvP5T"
				data-mapping="pathname"
				data-strict="1"
				data-reactions-enabled="1"
				data-emit-metadata="0"
				data-input-position="bottom"
				data-theme="light"
				data-lang="en"
				crossorigin="anonymous"
				async>
		</script>
	</div>
</article>
      </main>
    
      
      <div class="docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">On this page</a></li>
        </ul>
        <nav id="TableOfContents"></nav>
      </div>
      
    
    </div>
  </div>
</div>


		</main>

		

		
		<footer class="site-footer hide-print" role="contentinfo">
			<span>&copy; 2026 </span>
		</footer>
		

		
	</body>
</html>
