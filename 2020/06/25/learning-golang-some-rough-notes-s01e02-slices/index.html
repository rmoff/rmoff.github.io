<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Learning Golang (some rough notes) - S01E02 - Slices</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2020/06/25/learning-golang-some-rough-notes-s01e02-slices/">
		
		
		
		<meta name="generator" content="Hugo 0.75.1" />

		
		<meta property="og:title" content="Learning Golang (some rough notes) - S01E02 - Slices" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/images/2020/06/IMG_5288.jpeg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2020/06/25/learning-golang-some-rough-notes-s01e02-slices/" />
		<meta property="og:site_name" content="Learning Golang (some rough notes) - S01E02 - Slices" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<link rel="stylesheet" href="https://rmoff.net/css/tachyons.min.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/story.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/descartes.css" />
		
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans:400,400i,700,700i|Quattrocento:400,700|Spectral:400,400i,700,700i&amp;subset=latin-ext" rel="stylesheet">
		

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		
		<script src="https://rmoff.net/js/story.js"></script>

	</head>
	<body class="ma0 bg-white section-post page-kind-page is-page-true ">
		
		<header class="cover bg-top" style="background-image: url('https://rmoff.net/images/2020/06/IMG_5288.jpeg'); background-position: center;">
			<div class="bg-black-30 bb bt">

				<nav class="hide-print sans-serif  border-box pa3 ph5-l">
					<a href="https://rmoff.net" title="Home">
						<img src="https://rmoff.net/img/logo.jpg" class="w2 h2 br-100" alt="rmoff&#39;s random ramblings" />
					</a>
					<div class="fr h2 pv2 tr">
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net/bio">about</a>
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net">talks</a>
						<a class="link f5 ml2 dim near-white" href="https://www.youtube.com/c/rmoff"><i class="fab fa-youtube-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://twitter.com/rmoff/"><i class="fab fa-twitter-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://github.com/rmoff/"><i class="fab fa-github-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://www.linkedin.com/in/robinmoffatt/"><i class="fab fa-linkedin"></i></a>
						<a class="link f5 ml2 dim near-white fas fa-rss-square" href="https://rmoff.net/index.xml" title="RSS Feed"></a>
						<a class="link f5 ml2 dim near-white fas fa-search" href="https://rmoff.net/search/" role="search" title="Search"></a>
					</div>
				</nav>

				<div id="hdr" class="tc-l pv4-ns pv5-l pv2 ph3 ph4-ns">
					<h1 class="near-white mt1-ns f2 fw3 mb0 mt0 lh-title">Learning Golang (some rough notes) - S01E02 - Slices</h1>
					<h2 class="near-white mt3-l mb4-l fw1 f6 f3-l measure-wide-l center lh-copy mt2 mb3">
						
						
							
								Published
								<time datetime="2020-06-25T11:20:23&#43;01:00">Jun 25, 2020</time>
								<span class="display-print">by </span>
								 in <a href="https://rmoff.net/categories/go" class="no-underline category near-white dim">Go</a>, <a href="https://rmoff.net/categories/golang" class="no-underline category near-white dim">Golang</a>, <a href="https://rmoff.net/categories/slices" class="no-underline category near-white dim">Slices</a>
								<span class="display-print">at https://rmoff.net/2020/06/25/learning-golang-some-rough-notes-s01e02-slices/</span>
							
						
					</h2>
				</div>

				
				
				
				<div class="w-100 cf hide-print">
					<a class="fr f6 ma0 pa2 link white-50 dim fas fa-camera" href="https://twitter.com/rmoff/" title="Photo Credit"></a>
				</div>
				
				

			</div>
		</header>
		
		<main role="main">
		
<article class="center bg-white br-3 pv1 ph4 lh-copy f5 nested-links mw7">
	<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="/2020/06/25/learning-golang-some-rough-notes-s01e00/">Learning Go : Background</a>
</td>
</tr>
</tbody></table>
</div>
<hr/>
<div class="paragraph">
<p>ðŸ‘‰ <a href="https://tour.golang.org/moretypes/7">A Tour of Go : Slices</a></p>
</div>
<div class="paragraph">
<p>Slices made sense, until I got to <a href="https://tour.golang.org/moretypes/11"><em>Slice length and capacity</em></a>. Two bits puzzled me in this code:</p>
</div>
<div class="paragraph">
<div class="highlight"><div style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#008000;font-weight:bold">package</span> main

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#34;fmt&#34;</span>

<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
	s <span style="color:#666">:=</span> []<span style="color:#b00040">int</span>{<span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#666">5</span>, <span style="color:#666">7</span>, <span style="color:#666">11</span>, <span style="color:#666">13</span>}
	<span style="color:#00f">printSlice</span>(s)
	<span style="color:#408080;font-style:italic">// len=6 cap=6 [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>
	<span style="color:#408080;font-style:italic">// --
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// Slice the slice to give it zero length.
</span><span style="color:#408080;font-style:italic"></span>	s = s[:<span style="color:#666">0</span>]
	<span style="color:#00f">printSlice</span>(s)
	<span style="color:#408080;font-style:italic">// len=0 cap=6 []
</span><span style="color:#408080;font-style:italic"></span>

	<span style="color:#408080;font-style:italic">// --
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// Extend its length.
</span><span style="color:#408080;font-style:italic"></span>	s = s[:<span style="color:#666">4</span>]
	<span style="color:#00f">printSlice</span>(s)
	<span style="color:#408080;font-style:italic">// len=4 cap=6 [2 3 5 7]
</span><span style="color:#408080;font-style:italic"></span>

	<span style="color:#408080;font-style:italic">// --
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// Drop its first two values.
</span><span style="color:#408080;font-style:italic"></span>	s = s[<span style="color:#666">2</span>:]
	<span style="color:#00f">printSlice</span>(s)
	<span style="color:#408080;font-style:italic">// len=2 cap=4 [5 7]
</span><span style="color:#408080;font-style:italic"></span>}

<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">printSlice</span>(s []<span style="color:#b00040">int</span>) {
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;len=%d cap=%d %v\n&#34;</span>, <span style="color:#008000">len</span>(s), <span style="color:#008000">cap</span>(s), s)
}
</code></pre></td></tr></table>
</div>
</div>
</div>
<div class="paragraph">
<p>First up, and again this is my non-coding background coming through, but if <code>s</code> starts off as something</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s <span style="color:#666">:=</span> []<span style="color:#b00040">int</span>{<span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#666">5</span>, <span style="color:#666">7</span>, <span style="color:#666">11</span>, <span style="color:#666">13</span>}
<span style="color:#408080;font-style:italic">// [2 3 5 7 11 13]
</span></code></pre></div>
</div>
<div class="paragraph">
<p>and then we change it to something else</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[:<span style="color:#666">0</span>]
<span style="color:#408080;font-style:italic">// []
</span></code></pre></div>
</div>
<div class="paragraph">
<p>how can it revert to something based on its previous incarnation?</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[:<span style="color:#666">4</span>]
<span style="color:#408080;font-style:italic">// [2 3 5 7]
</span></code></pre></div>
</div>
<div class="paragraph">
<p>Which eventually made sense to me once it was explained that because <code>s</code> is a slice, it is a pointer to the underlying array. This is explained <a href="https://tour.golang.org/moretypes/9">here</a>, and so</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s <span style="color:#666">:=</span> []<span style="color:#b00040">int</span>{<span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#666">5</span>, <span style="color:#666">7</span>, <span style="color:#666">11</span>, <span style="color:#666">13</span>}
</code></pre></div>
</div>
<div class="paragraph">
<p>is building an array <strong>and</strong> declaring a slice on it in the same statement. Itâ€™s a more concise way of doing something like this:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">myArray <span style="color:#666">:=</span> [<span style="color:#666">6</span>]<span style="color:#b00040">int</span>{<span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#666">5</span>, <span style="color:#666">7</span>, <span style="color:#666">11</span>, <span style="color:#666">13</span>}
s <span style="color:#666">:=</span> myArray[:]
</code></pre></div>
</div>
<div class="paragraph">
<p>When we appear to reassign <code>s</code> to a new value</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[:<span style="color:#666">0</span>]
</code></pre></div>
</div>
<div class="paragraph">
<p>Itâ€™s actually declaring <code>s</code> as a slice as a before, <strong>based on the pointer against the original array</strong>. We can infer this from the fact that the <em>capacity</em> of the slice remains as 6</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[:<span style="color:#666">0</span>]
<span style="color:#408080;font-style:italic">// len=0 cap=6 []
</span></code></pre></div>
</div>
<div class="paragraph">
<p>and thus when we extend it, itâ€™s still against the original array that we were pointing to:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[:<span style="color:#666">4</span>]
<span style="color:#408080;font-style:italic">// len=4 cap=6 [2 3 5 7]
</span></code></pre></div>
</div>
<div class="paragraph">
<p>So <code>s</code> is a slice on top of the same array each time, just with a different definition (thus the <em>length</em> changes, not the <em>capacity</em>).</p>
</div>
<hr/>
<div class="paragraph">
<p>The second bit that puzzled me was, given the above explanation of <code>s</code> being a pointer to the same array, how can resizing it down and then up still retain the values and capacityâ€¦</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[:<span style="color:#666">0</span>]
<span style="color:#408080;font-style:italic">// len=0 cap=6 []
</span><span style="color:#408080;font-style:italic"></span>s = s[:<span style="color:#666">4</span>]
<span style="color:#408080;font-style:italic">// len=4 cap=6 [2 3 5 7]
</span></code></pre></div>
</div>
<div class="paragraph">
<p>whilst also resizing it down and up <em>not</em> retain the values and capacityâ€¦</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">s = s[<span style="color:#666">2</span>:]
<span style="color:#408080;font-style:italic">// len=2 cap=4 [5 7]
</span><span style="color:#408080;font-style:italic"></span>s = s[<span style="color:#666">0</span>:<span style="color:#666">4</span>]
<span style="color:#408080;font-style:italic">// len=4 cap=4 [5 7 11 13]
</span></code></pre></div>
</div>
<div class="paragraph">
<p>The answer is related to the first point above - pointers. When we declare the slice and increase the lower bound (<code>[2:]</code>) weâ€™re actually <strong>moving the offset of the pointer against the underlying array</strong>. Any subsequent references are now based on the pointer to this offset, and not the original one.</p>
</div>
<div class="paragraph">
<p>Hereâ€™s another example that I worked through to help figure it out:</p>
</div>
<div class="paragraph">
<p>(try it on <a href="https://play.golang.org/p/hO5QJzy2q2n">Go playground</a>)</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#008000;font-weight:bold">package</span> main

<span style="color:#008000;font-weight:bold">import</span> (
	<span style="color:#ba2121">&#34;fmt&#34;</span>
)

<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
	myArray <span style="color:#666">:=</span> [<span style="color:#666">6</span>]<span style="color:#b00040">int</span>{<span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#666">5</span>, <span style="color:#666">7</span>, <span style="color:#666">11</span>, <span style="color:#666">13</span>}

	<span style="color:#408080;font-style:italic">// y is a slice on myArray
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// With no bounds specified it defaults to the lowest (zero) and 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  highest (five) of the array
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// There are six entries (len=6) and the array that it points to 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  has six entries (cap=6)
</span><span style="color:#408080;font-style:italic"></span>	y <span style="color:#666">:=</span> myArray[:]
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 6	cap 6	value [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>	

	<span style="color:#408080;font-style:italic">// y is a slice against the same array that y *pointed to* previously
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// This time we take the first four entries (len=4). The slice is still
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  pointing to the same original array which has six entries (cap=6)
</span><span style="color:#408080;font-style:italic"></span>	y = y[<span style="color:#666">0</span>:<span style="color:#666">4</span>]
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 4	cap 6	value [2 3 5 7]
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>

	<span style="color:#408080;font-style:italic">// y is a slice against the same array that y *pointed to* previously
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// This time we take no entries (len=0). The slice is still
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  pointing to the same original array which has six entries (cap=6)
</span><span style="color:#408080;font-style:italic"></span>	y = y[:<span style="color:#666">0</span>]
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 0	cap 6	value []
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>

	<span style="color:#408080;font-style:italic">// Now we do something different from the above pattern. We shift the 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  point to which y points, and now it starts from the fifth position
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  of the underlying array (it&#39;s zero based so fifth position=4). 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// There are two entries (five and six) so len=2, and because we&#39;re now 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  actually pointing to the array starting at the second entry the capacity
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  changes too (cap=2)
</span><span style="color:#408080;font-style:italic"></span>	y = y[<span style="color:#666">4</span>:<span style="color:#666">6</span>]
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 2	cap 2	value [11 13]
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>	

	<span style="color:#408080;font-style:italic">// Now that we&#39;ve shifted the pointer to a different offset in the source array
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  our bounds have different references. 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// This refers to the second position (zero based, so 1) in the array but starting
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">//  from the redefined start offset that we created in the above slice 
</span><span style="color:#408080;font-style:italic"></span>	y = y[<span style="color:#666">1</span>:<span style="color:#666">2</span>]
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 1	cap 1	value [13]
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 13]
</span><span style="color:#408080;font-style:italic"></span>	

	<span style="color:#408080;font-style:italic">// Since the slice is just a pointer to the underlying array we can change the array and 
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// the slice will reflect this
</span><span style="color:#408080;font-style:italic"></span>	myArray[<span style="color:#666">5</span>]=<span style="color:#666">100</span>
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 1	cap 1	value [100]
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 100]
</span><span style="color:#408080;font-style:italic"></span>	

	<span style="color:#408080;font-style:italic">// Conversely, changing the slice value reflects in the array too
</span><span style="color:#408080;font-style:italic"></span>	y[<span style="color:#666">0</span>]=<span style="color:#666">200</span>
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;y       len %d\tcap %d\tvalue %v\n&#34;</span>, <span style="color:#008000">len</span>(y), <span style="color:#008000">cap</span>(y),y)
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;myArray len %d\tcap %d\tvalue %v\n\n&#34;</span>, <span style="color:#008000">len</span>(myArray), <span style="color:#008000">cap</span>(myArray),myArray)
	<span style="color:#408080;font-style:italic">// y       len 1	cap 1	value [200]
</span><span style="color:#408080;font-style:italic"></span>	<span style="color:#408080;font-style:italic">// myArray len 6	cap 6	value [2 3 5 7 11 200]
</span><span style="color:#408080;font-style:italic"></span>
}
</code></pre></div>
</div>
<div class="paragraph">
<p><a href="https://blog.golang.org/slices-intro">This blog post</a> goes into some lower-level stuff around Slices that was very useful. A concept it uses that Iâ€™d not come across yet was the underscore, which is explained well in <a href="https://stackoverflow.com/a/27764432/350613">this StackOverflow answer</a> (and then gets covered soon after in the Tour [<a href="https://tour.golang.org/moretypes/17">here</a>).</p>
</div>
<div class="paragraph">
<p>Other references that were useful:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.callicoder.com/golang-slices/" class="bare">https://www.callicoder.com/golang-slices/</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/50713681/extend-the-length-and-keep-the-value" class="bare">https://stackoverflow.com/questions/50713681/extend-the-length-and-keep-the-value</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/43294449/decreasing-slice-capacity" class="bare">https://stackoverflow.com/questions/43294449/decreasing-slice-capacity</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/47256103/golang-slice-variable-assign-from-tutorial" class="bare">https://stackoverflow.com/questions/47256103/golang-slice-variable-assign-from-tutorial</a></p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_appending_to_a_slice_why_doesnt_the_capacity_match_the_length">Appending to a slice - why doesnâ€™t the capacity match the length?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ðŸ‘‰ <a href="https://tour.golang.org/moretypes/15">A Tour of Go : Appending to a slice</a></p>
</div>
<div class="paragraph">
<p>This all made sense, except for when I noticed the <code>cap</code> (6) wasnâ€™t in line with the <code>len</code> (5) in the final example.</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
	<span style="color:#008000;font-weight:bold">var</span> s []<span style="color:#b00040">int</span>
	<span style="color:#408080;font-style:italic">// len=0 cap=0 []
</span><span style="color:#408080;font-style:italic"></span>	
	s = <span style="color:#008000">append</span>(s, <span style="color:#666">0</span>)
	<span style="color:#408080;font-style:italic">// len=1 cap=1 [0]
</span><span style="color:#408080;font-style:italic"></span>
	s = <span style="color:#008000">append</span>(s, <span style="color:#666">1</span>)
	<span style="color:#408080;font-style:italic">// len=2 cap=2 [0 1]
</span><span style="color:#408080;font-style:italic"></span>
	s = <span style="color:#008000">append</span>(s, <span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#666">4</span>)
	<span style="color:#408080;font-style:italic">// len=5 cap=6 [0 1 2 3 4]
</span><span style="color:#408080;font-style:italic"></span>}
</code></pre></div>
</div>
<div class="paragraph">
<p>Poking around a bit more with this I saw that the capacity doubled each time it needed to be increased:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#008000;font-weight:bold">package</span> main

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#34;fmt&#34;</span>

<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
	<span style="color:#008000;font-weight:bold">var</span> s []<span style="color:#b00040">int</span>
	
	<span style="color:#008000;font-weight:bold">for</span> i<span style="color:#666">:=</span><span style="color:#666">0</span>;i&lt;<span style="color:#666">20</span>; i<span style="color:#666">++</span> {
		s = <span style="color:#008000">append</span>(s,i)
		<span style="color:#00f">printSlice</span>(s)
	}
}


<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">printSlice</span>(s []<span style="color:#b00040">int</span>) {
	fmt.<span style="color:#00f">Printf</span>(<span style="color:#ba2121">&#34;len=%d \tcap=%d \n&#34;</span>, <span style="color:#008000">len</span>(s), <span style="color:#008000">cap</span>(s))
}
</code></pre></div>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">len=<span style="color:#666">1</span> 	cap=<span style="color:#666">1</span> 
len=<span style="color:#666">2</span> 	cap=<span style="color:#666">2</span> 
len=<span style="color:#666">3</span> 	cap=<span style="color:#666">4</span> 
len=<span style="color:#666">4</span> 	cap=<span style="color:#666">4</span> 
len=<span style="color:#666">5</span> 	cap=<span style="color:#666">8</span> 
len=<span style="color:#666">6</span> 	cap=<span style="color:#666">8</span> 
len=<span style="color:#666">7</span> 	cap=<span style="color:#666">8</span> 
len=<span style="color:#666">8</span> 	cap=<span style="color:#666">8</span> 
len=<span style="color:#666">9</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">10</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">11</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">12</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">13</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">14</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">15</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">16</span> 	cap=<span style="color:#666">16</span> 
len=<span style="color:#666">17</span> 	cap=<span style="color:#666">32</span> 
len=<span style="color:#666">18</span> 	cap=<span style="color:#666">32</span> 
len=<span style="color:#666">19</span> 	cap=<span style="color:#666">32</span> 
len=<span style="color:#666">20</span> 	cap=<span style="color:#666">32</span> 
</code></pre></div>
</div>
<div class="paragraph">
<p>This is discussed in this <a href="https://stackoverflow.com/a/23532202/350613">StackOverflow answer</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_slices">Exercise: Slices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ðŸ‘‰ <a href="https://tour.golang.org/moretypes/18" class="bare">https://tour.golang.org/moretypes/18</a> [A Tour of Go : Exercise: Slices]</p>
</div>
<div class="paragraph">
<p>This dropped me in at the fairly deep end, and I only just kept my head above water ;-)</p>
</div>
<div class="paragraph">
<p>I went back to previous examples, particularly <a href="https://tour.golang.org/moretypes/13">Creating a slice with make</a> and <a href="https://tour.golang.org/moretypes/14">Slices of slices</a>, but I couldnâ€™t figure out how to combine the two concepts. This kind of thing didnâ€™t work</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">p <span style="color:#666">:=</span> <span style="color:#008000">make</span>([]<span style="color:#008000">make</span>([]<span style="color:#b00040">uint8</span>,dx),dy)
</code></pre></div>
</div>
<div class="paragraph">
<p>Iâ€™d have liked to see a hints or work answer for the exercise, but with the power of Google it was easy enough to find a few :) These answers got me on the right tracks to first create the slice and then create within it iteratively the additional slice (which to be fair the exercise text does specify, with hindsight)</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#008000;font-weight:bold">package</span> main

<span style="color:#008000;font-weight:bold">import</span> <span style="color:#ba2121">&#34;golang.org/x/tour/pic&#34;</span>

<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">Pic</span>(dx, dy <span style="color:#b00040">int</span>) [][]<span style="color:#b00040">uint8</span> {
	p <span style="color:#666">:=</span> <span style="color:#008000">make</span>([][]<span style="color:#b00040">uint8</span>,dy)
	
	<span style="color:#008000;font-weight:bold">for</span> i <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p {
		p[i] = <span style="color:#008000">make</span>([]<span style="color:#b00040">uint8</span>,dx)
	}

	<span style="color:#008000;font-weight:bold">return</span> p
}

<span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
	pic.<span style="color:#00f">Show</span>(Pic)
}
</code></pre></div>
</div>
<div class="paragraph">
<p>When you run this you get a nice blue square. Now to add some pattern to it.</p>
</div>
<div class="paragraph">
<p>Just to experiment with what was going on I tried something, anything â€¦ :)</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#008000;font-weight:bold">for</span> y <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p {
		<span style="color:#008000;font-weight:bold">for</span> x <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p[y] {
			p[y][x]=(<span style="color:#008000">uint8</span>(x)<span style="color:#666">+</span><span style="color:#008000">uint8</span>(y))
		}
	}
</code></pre></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2020/06/slice01.png" alt="slice01"/>
</div>
</div>
<div class="paragraph">
<p>Casting <code>uint8</code> was necessary (and is mentioned as a hint in the exercise text) because otherwise it fails  with <code>./prog.go:14:11: cannot use x + y (type int) as type uint8 in assignment</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>I thought that this would work, to declare the variable types first, but it didnâ€™t and threw the same error.</p>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#008000;font-weight:bold">var</span> x,y <span style="color:#b00040">uint8</span>
	<span style="color:#008000;font-weight:bold">for</span> y <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p {
		<span style="color:#008000;font-weight:bold">for</span> x <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p[y] {
			p[y][x]=(x<span style="color:#666">+</span>y)
		}
	}
</code></pre></div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other patterns:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#008000;font-weight:bold">for</span> y <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p {
		<span style="color:#008000;font-weight:bold">for</span> x <span style="color:#666">:=</span> <span style="color:#008000;font-weight:bold">range</span> p[y] {
			p[y][x]=(<span style="color:#008000">uint8</span>(x)<span style="color:#666">*</span><span style="color:#008000">uint8</span>(y))
		}
	}
</code></pre></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2020/06/slice02.png" alt="slice02"/>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="_more_episodes">ðŸ“º More Episodesâ€¦</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Kafka and Go</p>
<div class="ulist">
<ul>
<li>
<p><a href="/2020/07/08/learning-golang-some-rough-notes-s02e00-kafka-and-go/">S02E00 - Kafka and Go</a></p>
</li>
<li>
<p><a href="/2020/07/08/learning-golang-some-rough-notes-s02e01-my-first-kafka-go-producer/">S02E01 - My First Kafka Go Producer</a></p>
</li>
<li>
<p><a href="/2020/07/10/learning-golang-some-rough-notes-s02e02-adding-error-handling-to-the-producer/">S02E02 - Adding error handling to the Producer</a></p>
</li>
<li>
<p><a href="/2020/07/14/learning-golang-some-rough-notes-s02e03-kafka-go-consumer-channel-based/">S02E03 - Kafka Go Consumer (Channel-based)</a></p>
</li>
<li>
<p><a href="/2020/07/14/learning-golang-some-rough-notes-s02e04-kafka-go-consumer-function-based/">S02E04 - Kafka Go Consumer (Function-based)</a></p>
</li>
<li>
<p><a href="/2020/07/15/learning-golang-some-rough-notes-s02e05-kafka-go-adminclient/">S02E05 - Kafka Go AdminClient</a></p>
</li>
<li>
<p><a href="/2020/07/15/learning-golang-some-rough-notes-s02e06-putting-the-producer-in-a-function-and-handling-errors-in-a-go-routine/">S02E06 - Putting the Producer in a function and handling errors in a Go routine</a></p>
</li>
<li>
<p><a href="/2020/07/16/learning-golang-some-rough-notes-s02e07-splitting-go-code-into-separate-source-files-and-building-a-binary-executable/">S02E07 - Splitting Go code into separate source files and building a binary executable</a></p>
</li>
<li>
<p><a href="/2020/07/17/learning-golang-some-rough-notes-s02e08-checking-kafka-advertised.listeners-with-go/">S02E08 - Checking Kafka advertised.listeners with Go</a></p>
</li>
<li>
<p><a href="/2020/07/23/learning-golang-some-rough-notes-s02e09-processing-chunked-responses-before-eof-is-reached/">S02E09 - Processing chunked responses before EOF is reached</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Learning Go</p>
<div class="ulist">
<ul>
<li>
<p><a href="/2020/06/25/learning-golang-some-rough-notes-s01e00/">S01E00 - Background</a></p>
</li>
<li>
<p><a href="/2020/06/25/learning-golang-some-rough-notes-s01e01-pointers/">S01E01 - Pointers</a></p>
</li>
<li>
<p><a href="/2020/06/25/learning-golang-some-rough-notes-s01e02-slices/">S01E02 - Slices</a></p>
</li>
<li>
<p><a href="/2020/06/29/learning-golang-some-rough-notes-s01e03-maps/">S01E03 - Maps</a></p>
</li>
<li>
<p><a href="/2020/06/29/learning-golang-some-rough-notes-s01e04-function-closures/">S01E04 - Function Closures</a></p>
</li>
<li>
<p><a href="/2020/06/30/learning-golang-some-rough-notes-s01e05-interfaces/">S01E05 - Interfaces</a></p>
</li>
<li>
<p><a href="/2020/07/01/learning-golang-some-rough-notes-s01e06-errors/">S01E06 - Errors</a></p>
</li>
<li>
<p><a href="/2020/07/01/learning-golang-some-rough-notes-s01e07-readers/">S01E07 - Readers</a></p>
</li>
<li>
<p><a href="/2020/07/02/learning-golang-some-rough-notes-s01e08-images/">S01E08 - Images</a></p>
</li>
<li>
<p><a href="/2020/07/02/learning-golang-some-rough-notes-s01e09-concurrency-channels-goroutines/">S01E09 - Concurrency (Channels, Goroutines)</a></p>
</li>
<li>
<p><a href="/2020/07/03/learning-golang-some-rough-notes-s01e10-concurrency-web-crawler/">S01E10 - Concurrency (Web Crawler)</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</article>

		</main>
		
				<div class="hide-print sans-serif f6 f5-l mt5 ph3 pb6 center nested-copy-line-height lh-copy nested-links mw-100 measure-wide">
		<div class="about-the-author">
		
			
			
				
					<hr>
<p><img src="/images/2018/05/ksldn18-01.jpg" alt="Robin Moffatt"></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --> <em>Robin Moffatt is a Senior Developer Advocate at Confluent, and an Oracle ACE Director (Alumnus). He likes writing about himself in the third person, eating good breakfasts, and drinking good beer.</em></p>

				
			
		
		</div>
		
	</div>

		
		
		
		<footer class="hide-print sans-serif f6 fw1 bg-black near-white bottom-0 w-100 pa3" role="contentinfo">
			<p class="w-50 fr tr">
			<a class="no-underline near-white" href="https://github.com/xaprb/story"><img class="dib" title="Made with Hugo and Story" alt="Story logo" src="https://rmoff.net/img/story-logo-white.svg" style="width: 1.5rem; height: 1.5rem" /></a>
			</p>
			<p class="w-50 near-white">
				&copy; 2020 
			</p>
		</footer>
		
	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-75492960-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

	
	</body>
</html>
