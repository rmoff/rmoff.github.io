<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" as="image" href="https://rmoff.net/images/2020/03/IMG_3358.jpeg" >
		
		<title>Streaming Wi-Fi trace data from Raspberry Pi to Apache Kafka with Confluent Cloud</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2020/03/11/streaming-wi-fi-trace-data-from-raspberry-pi-to-apache-kafka-with-confluent-cloud/">
		
		

		
		<meta property="og:title" content="Streaming Wi-Fi trace data from Raspberry Pi to Apache Kafka with Confluent Cloud" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/images/2020/03/IMG_3358.jpeg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2020/03/11/streaming-wi-fi-trace-data-from-raspberry-pi-to-apache-kafka-with-confluent-cloud/" />
		<meta property="og:site_name" content="Streaming Wi-Fi trace data from Raspberry Pi to Apache Kafka with Confluent Cloud" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<style>
			html { background-color: #FAF8F5; color: #2D2926; }
			body { opacity: 0; transition: opacity 0.1s ease; }
			body.loaded { opacity: 1; }
			.site-header { height: 60px; background-color: #FAF8F5; border-bottom: 1px solid #E8421E; }
		</style>

		
		
		<link rel="stylesheet" href="https://rmoff.net/css/redesign.css" />
		
		<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap">
		<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
		<noscript><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet"></noscript>
		

		

		
		<script>
			!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
            posthog.init('phc_93NEP79Ju4xqXYWXnoLbr4HMW0Iaepj1BGOVoEXYX6P',{api_host:'https://eu.i.posthog.com', person_profiles: 'identified_only'})
		</script>

		
		<script src="https://rmoff.net/js/story.js"></script>
		<script src="https://rmoff.net/js/toc.js"></script>
		<script src="https://rmoff.net/js/medium-mirror.js"></script>
	</head>
	<body class="ma0 section-post page-kind-page is-page-true ">
		<script>document.body.classList.add('loaded');</script>

		<header class="site-header hide-print">
	<div class="site-header-inner">
		<a href="https://rmoff.net/" class="site-title">rmoff's random ramblings</a>
		<nav class="site-nav">
			<a href="/categories/interesting-links/" class="nav-il"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> Interesting Links</a>
			<span class="nav-sep"></span>
			<a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg> Categories</a>
			<a href="https://rmoff.net/search/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg> Search</a>
			<a href="https://rmoff.net/index.xml"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg> RSS</a>
			<div class="nav-social">
				<a href="https://www.linkedin.com/in/robinmoffatt/" title="linkedin"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
				<a href="https://twitter.com/rmoff/" title="twitter"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
				<a href="https://bsky.app/profile/rmoff.net" title="bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 568 501" fill="currentColor"><path d="M123.121 33.664C188.241 82.553 258.281 181.68 284 234.873c25.719-53.192 95.759-152.32 160.879-201.21C491.866-1.611 568-28.906 568 57.947c0 17.346-9.945 145.713-15.778 166.555-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281-2.462-7.227-3.614-10.608-3.631-7.733-.017-2.875-1.169.506-3.631 7.733-13.43 39.422-65.842 193.273-185.702 70.281-63.111-64.76-33.89-129.52 80.986-149.071-65.72 11.185-139.6-7.295-159.875-79.748C10.945 203.659 1 75.291 1 57.946 1-28.906 76.135-1.612 123.121 33.664z"/></svg></a>
				<a href="https://www.youtube.com/c/rmoff" title="youtube"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
				<a href="https://talks.rmoff.net" title="talks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="0"/><line x1="12" y1="17" x2="12" y2="22"/><line x1="8" y1="22" x2="16" y2="22"/><polyline points="7 8 12 12 17 8"/></svg></a>
				<a href="https://github.com/rmoff/" title="github"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
			</div>
		</nav>
		<button class="nav-toggle" onclick="document.querySelector('.mobile-nav').classList.toggle('open')" aria-label="Menu">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
		</button>
	</div>
	<nav class="mobile-nav">
		<a href="https://rmoff.net/">Home</a>
		<a href="/categories/">Categories</a>
		<a href="/categories/interesting-links/">Interesting Links</a>
		<a href="https://rmoff.net/search/">Search</a>
		<a href="https://rmoff.net/index.xml">RSS</a>
		<a href="https://www.linkedin.com/in/robinmoffatt/">linkedin</a>
		<a href="https://twitter.com/rmoff/">twitter</a>
		<a href="https://bsky.app/profile/rmoff.net">bluesky</a>
		<a href="https://www.youtube.com/c/rmoff">youtube</a>
		<a href="https://talks.rmoff.net">talks</a>
		<a href="https://github.com/rmoff/">github</a>
	</nav>
</header>


		<main role="main">
		

<div class="article-hero" style="background-image: url('https://rmoff.net/images/2020/03/IMG_3358.jpeg');">
	<div class="article-hero-overlay">
		<div class="article-hero-content">
			<h1>Streaming Wi-Fi trace data from Raspberry Pi to Apache Kafka with Confluent Cloud</h1>
			<p class="article-hero-meta">
				
					<time datetime="2020-03-11T11:58:13Z">11 Mar 2020</time>
					<span class="display-print">by </span>
					 &middot; <a href="https://rmoff.net/categories/raspberry-pi">Raspberry pi</a>, <a href="https://rmoff.net/categories/kcat-kafkacat">kcat (kafkacat)</a>, <a href="https://rmoff.net/categories/confluent-cloud">Confluent Cloud</a>, <a href="https://rmoff.net/categories/wireshark">wireshark</a>, <a href="https://rmoff.net/categories/tshark">tshark</a>, <a href="https://rmoff.net/categories/tcpdump">tcpdump</a>
					<span class="display-print">at https://rmoff.net/2020/03/11/streaming-wi-fi-trace-data-from-raspberry-pi-to-apache-kafka-with-confluent-cloud/</span>
				
			</p>
		</div>
	</div>
</div>


<details class="toc-mobile">
	<summary>Table of Contents</summary>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#_kit_list">Kit list</a></li>
    <li><a href="#_set_up_the_wireless_interface">Set up the wireless interface</a></li>
    <li><a href="#_here_comes_the_tools">Here comes the tools</a></li>
    <li><a href="#_writing_structured_json_from_tshark">Writing structured JSON from <code>tshark</code></a></li>
    <li><a href="#_streaming_wi_fi_data_into_apache_kafka">Streaming Wi-Fi data into Apache Kafka</a></li>
    <li><a href="#_whats_next">Whatâ€™s next?</a>
      <ul>
        <li><a href="#_acknowledments_and_references">Acknowledments and References</a></li>
      </ul>
    </li>
  </ul>
</nav>
</details>

<div class="container-fluid docs">
	<div class="row">
		<main class="docs-content" role="main">

<article class="article" data-pagefind-body>
	<span data-pagefind-filter="category" style="display:none">Raspberry pi</span><span data-pagefind-filter="category" style="display:none">kcat (kafkacat)</span><span data-pagefind-filter="category" style="display:none">Confluent Cloud</span><span data-pagefind-filter="category" style="display:none">wireshark</span><span data-pagefind-filter="category" style="display:none">tshark</span><span data-pagefind-filter="category" style="display:none">tcpdump</span>
	<img data-pagefind-meta="image[src]" src="https://rmoff.net/images/2020/03/IMG_3358.jpeg" style="display:none" alt="">
	
<div class="paragraph">
<p>Wi-fi is now ubiquitous in most populated areas, and the way the devices communicate leaves a lot of &#39;digital exhaust&#39;. Usually a computer will have a Wi-Fi device thatâ€™s configured to connect to a given network, but often these devices can be configured instead to pick up the background Wi-Fi chatter of surrounding devices.</p>
</div>
<div class="paragraph">
<p>There are good reasonsâ€”and badâ€”for doing this. Just like taking apart equipment to understand how it works teaches us things, so being able to <a href="/2019/11/29/using-tcpdump-with-docker/">dissect and examine protocol traffic</a> lets us learn about this. However, by collecting this type of traffic it can be possible to track and analyse behaviour in ways that we may or may not feel comfortable with. <a href="https://tfl.gov.uk/corporate/privacy-and-cookies/wi-fi-data-collection">Improving public transport</a>? Sure. <a href="https://www.theguardian.com/technology/datablog/2014/jan/10/how-tracking-customers-in-store-will-soon-be-the-norm">Tracking shopper behaviour</a>? Meh, less sure.</p>
</div>
<div class="paragraph">
<p>So, hereâ€™s how to do it, and go ahead and make sure youâ€™re doing it for the right reasons. A plague o&#39; your house if you donâ€™t!</p>
</div>
<div class="sect1">
<h2 id="_kit_list">Kit list&nbsp;<a class="headline-hash" href="#_kit_list">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Raspberry Pi Model B Rev 2, 512MB, running Raspbian GNU/Linux 10 (buster)</p>
</li>
<li>
<p><a href="https://www.amazon.co.uk/gp/product/B00CM83SC0/">ASUS USB-BT400 3Mbps USB Bluetooth v4.0 Mini Dongle</a></p>
</li>
<li>
<p><a href="https://confluent.cloud/signup">Confluent Cloud</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I had the Raspberry Pi plugged into my network on its Ethernet port, since the Wi-Fi dongle will be otherwise occupied :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_the_wireless_interface">Set up the wireless interface&nbsp;<a class="headline-hash" href="#_set_up_the_wireless_interface">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>First up, delete the existing wireless network interface thatâ€™s probably there already:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo iw dev wlan0 del</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Check that that Wi-Fi physical device supports <em>monitor</em> mode (which is what weâ€™re using), and make a note of its name (here, <code>phy0</code>):</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo iw phy
</span></span><span style="display:flex;"><span>Wiphy phy0
</span></span><span style="display:flex;"><span>	max <span style="color:#408080;font-style:italic"># scan SSIDs: 4</span>
</span></span><span style="display:flex;"><span>	max scan IEs length: <span style="color:#666">2257</span> bytes
</span></span><span style="display:flex;"><span>â€¦
</span></span><span style="display:flex;"><span>	Supported interface modes:
</span></span><span style="display:flex;"><span>		 * IBSS
</span></span><span style="display:flex;"><span>		 * managed
</span></span><span style="display:flex;"><span>		 * AP
</span></span><span style="display:flex;"><span>		 * AP/VLAN
</span></span><span style="display:flex;"><span>		 * monitor
</span></span><span style="display:flex;"><span>		 * mesh point
</span></span><span style="display:flex;"><span>â€¦         </span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Now create a new monitoring interface (<code>type monitor</code>) bound to the physical device (<code>phy0</code>), and bring it up.</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo iw phy phy0 interface add mon0 <span style="color:#008000">type</span> monitor
</span></span><span style="display:flex;"><span>sudo ifconfig mon0 up</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>If you check its status you should see it in monitor mode:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iwconfig mon0
</span></span><span style="display:flex;"><span>mon0      IEEE 802.11  Mode:Monitor  Frequency:2.417 GHz  Tx-Power<span style="color:#666">=</span><span style="color:#666">20</span> dBm
</span></span><span style="display:flex;"><span>          Retry short  long limit:2   RTS thr:off   Fragment thr:off
</span></span><span style="display:flex;"><span>          Power Management:off</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>You should have a network config that looks something like this - a loopback (<code>lo</code>), a network connection to your LAN (<code>eth0</code>), and a monitor interface (<code>mon0</code>):</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ip a
</span></span><span style="display:flex;"><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span style="color:#666">65536</span> qdisc noqueue state UNKNOWN group default qlen <span style="color:#666">1000</span>
</span></span><span style="display:flex;"><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style="display:flex;"><span>    inet 127.0.0.1/8 scope host lo
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>    inet6 ::1/128 scope host
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style="color:#666">1500</span> qdisc pfifo_fast state UP group default qlen <span style="color:#666">1000</span>
</span></span><span style="display:flex;"><span>    link/ether b8:27:eb:3f:dc:66 brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>    inet 192.168.10.106/24 brd 192.168.10.255 scope global noprefixroute eth0
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>    inet6 fd00::1:6332:fcea:9237:246c/64 scope global dynamic mngtmpaddr noprefixroute
</span></span><span style="display:flex;"><span>       valid_lft 7158sec preferred_lft 7158sec
</span></span><span style="display:flex;"><span>    inet6 fe80::8b6b:8c75:94a0:1aac/64 scope link
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>4: mon0: &lt;BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP&gt; mtu <span style="color:#666">1500</span> qdisc mq state UNKNOWN group default qlen <span style="color:#666">1000</span>
</span></span><span style="display:flex;"><span>    link/ieee802.11/radiotap 00:0f:60:04:ef:a4 brd ff:ff:ff:ff:ff:ff</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_here_comes_the_tools">Here comes the tools&nbsp;<a class="headline-hash" href="#_here_comes_the_tools">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Letâ€™s install some useful things:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo apt-get install -y tcpdump tshark jq kafkacat</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Check everythingâ€™s working by running <code>tcpdump</code> to dump out the Wi-Fi traffic as itâ€™s received:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo tcpdump -i mon0 -n
</span></span><span style="display:flex;"><span>tcpdump: verbose output suppressed, use -v or -vv <span style="color:#008000;font-weight:bold">for</span> full protocol decode
</span></span><span style="display:flex;"><span>listening on mon0, link-type IEEE802_11_RADIO <span style="color:#666">(</span>802.11 plus radiotap header<span style="color:#666">)</span>, capture size <span style="color:#666">262144</span> bytes
</span></span><span style="display:flex;"><span>10:36:49.640924 1.0 Mb/s <span style="color:#666">2417</span> MHz 11b -81dBm signal antenna <span style="color:#666">1</span> Data IV:28ee Pad <span style="color:#666">20</span> KeyID <span style="color:#666">2</span>
</span></span><span style="display:flex;"><span>10:36:55.497519 1.0 Mb/s <span style="color:#666">2417</span> MHz 11b -77dBm signal antenna <span style="color:#666">1</span> Probe Request <span style="color:#666">(</span>RNM0<span style="color:#666">)</span> <span style="color:#666">[</span>1.0 2.0 5.5 11.0 Mbit<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span>10:36:57.511322 1.0 Mb/s <span style="color:#666">2417</span> MHz 11b -69dBm signal antenna <span style="color:#666">1</span> Probe Request <span style="color:#666">(</span>RNM0<span style="color:#666">)</span> <span style="color:#666">[</span>1.0* 2.0* 5.5* 6.0 9.0 11.0* 12.0 18.0 Mbit<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span>10:36:57.512419 1.0 Mb/s <span style="color:#666">2417</span> MHz 11b -69dBm signal antenna <span style="color:#666">1</span> Probe Request <span style="color:#666">()</span> <span style="color:#666">[</span>1.0* 2.0* 5.5* 6.0 9.0 11.0* 12.0 18.0 Mbit<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span>10:36:57.679522 1.0 Mb/s <span style="color:#666">2417</span> MHz 11b -67dBm signal antenna <span style="color:#666">1</span> Acknowledgment RA:48:d3:43:xx:xx:xx</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Thereâ€™s five packets of real live Wi-Fi data! And thereâ€™s a bunch you can do with <code>tcpdump</code> and filters etc, but because we want this data out in a structured manner (i.e. key/values) Iâ€™m going to cut over to <code>tshark</code> now.</p>
</div>
<div class="paragraph">
<p><code>tshark</code> is the CLI companion to the well known network tool, Wireshark. You can use it standalone, or you can even use it as a source for Wireshark - which is pretty cool.</p>
</div>
<div class="paragraph">
<p>Letâ€™s start with a quick <code>tshark</code>:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo tshark -i mon0
</span></span><span style="display:flex;"><span>Running as user <span style="color:#ba2121">&#34;root&#34;</span> and group <span style="color:#ba2121">&#34;root&#34;</span>. This could be dangerous.
</span></span><span style="display:flex;"><span>Capturing on <span style="color:#ba2121">&#39;mon0&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">1</span> 0.000000000 Apple_17:17:d3 â†’ Broadcast    802.11 <span style="color:#666">175</span> Probe Request, <span style="color:#19177c">SN</span><span style="color:#666">=</span>672, <span style="color:#19177c">FN</span><span style="color:#666">=</span>0, <span style="color:#19177c">Flags</span><span style="color:#666">=</span>........, <span style="color:#19177c">SSID</span><span style="color:#666">=</span>RNM0
</span></span><span style="display:flex;"><span>    <span style="color:#666">2</span> 0.009712480 Apple_17:17:d3 â†’ Broadcast    802.11 <span style="color:#666">175</span> Probe Request, <span style="color:#19177c">SN</span><span style="color:#666">=</span>673, <span style="color:#19177c">FN</span><span style="color:#666">=</span>0, <span style="color:#19177c">Flags</span><span style="color:#666">=</span>........, <span style="color:#19177c">SSID</span><span style="color:#666">=</span>RNM0
</span></span><span style="display:flex;"><span>    <span style="color:#666">3</span> 20.711944424 66:9f:b3:xx:xx:xx â†’ Broadcast    802.11 <span style="color:#666">106</span> Probe Request, <span style="color:#19177c">SN</span><span style="color:#666">=</span>772, <span style="color:#19177c">FN</span><span style="color:#666">=</span>0, <span style="color:#19177c">Flags</span><span style="color:#666">=</span>........, <span style="color:#19177c">SSID</span><span style="color:#666">=</span>Wildcard <span style="color:#666">(</span>Broadcast<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">4</span> 20.719399794              â†’ Bskyb_13:16:82 <span style="color:#666">(</span>3c:89:94:xx:xx:xx<span style="color:#666">)</span> <span style="color:#666">(</span>RA<span style="color:#666">)</span> 802.11 <span style="color:#666">28</span> Acknowledgement, <span style="color:#19177c">Flags</span><span style="color:#666">=</span>........</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Thereâ€™s that Wi-Fi data again!</p>
</div>
<div class="paragraph">
<p>But how to get this data out in a truly structured way thatâ€™s going to be useful in subsequent processing?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_structured_json_from_tshark">Writing structured JSON from <code>tshark</code>&nbsp;<a class="headline-hash" href="#_writing_structured_json_from_tshark">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you can see from above <code>tshark</code> by default writes data in a loosely-structured way that would be impossible to parse programatically. We want a structured format such as JSON, and thatâ€™s <em>kind of</em> possible with the <code>-T</code> flag and <code>ek</code> argument:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo tshark -i mon0 -T ek
</span></span><span style="display:flex;"><span>Running as user <span style="color:#ba2121">&#34;root&#34;</span> and group <span style="color:#ba2121">&#34;root&#34;</span>. This could be dangerous.
</span></span><span style="display:flex;"><span>Capturing on <span style="color:#ba2121">&#39;mon0&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">{</span><span style="color:#ba2121">&#34;index&#34;</span> : <span style="color:#666">{</span><span style="color:#ba2121">&#34;_index&#34;</span>: <span style="color:#ba2121">&#34;packets-2020-03-11&#34;</span>, <span style="color:#ba2121">&#34;_type&#34;</span>: <span style="color:#ba2121">&#34;pcap_file&#34;</span><span style="color:#666">}}</span>
</span></span><span style="display:flex;"><span><span style="color:#666">{</span><span style="color:#ba2121">&#34;timestamp&#34;</span> : <span style="color:#ba2121">&#34;1583923701818&#34;</span>, <span style="color:#ba2121">&#34;layers&#34;</span> : <span style="color:#666">{</span><span style="color:#ba2121">&#34;frame&#34;</span>: <span style="color:#666">{</span><span style="color:#ba2121">&#34;frame_frame_interface_id&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;frame_interface_id_frame_interface_name&#34;</span>: <span style="color:#ba2121">&#34;mon0&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_encap_type&#34;</span>: <span style="color:#ba2121">&#34;23&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_time&#34;</span>: <span style="color:#ba2121">&#34;Mar 11, 2020 10:48:21.818766344 GMT&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_offset_shift&#34;</span>: <span style="color:#ba2121">&#34;0.000000000&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_time_epoch&#34;</span>: <span style="color:#ba2121">&#34;1583923701.818766344&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_time_delta&#34;</span>: <span style="color:#ba2121">&#34;0.000000000&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_time_delta_displayed&#34;</span>: <span style="color:#ba2121">&#34;0.000000000&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_time_relative&#34;</span>: <span style="color:#ba2121">&#34;0.000000000&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_number&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_len&#34;</span>: <span style="color:#ba2121">&#34;28&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_cap_len&#34;</span>: <span style="color:#ba2121">&#34;28&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_marked&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_ignored&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;frame_frame_protocols&#34;</span>: <span style="color:#ba2121">&#34;radiotap:wlan_radio:wlan&#34;</span><span style="color:#666">}</span>,<span style="color:#ba2121">&#34;radiotap&#34;</span>: <span style="color:#666">{</span><span style="color:#ba2121">&#34;radiotap_radiotap_version&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_pad&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_length&#34;</span>: <span style="color:#ba2121">&#34;18&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_present&#34;</span>: <span style="color:#ba2121">&#34;&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_radiotap_present_word&#34;</span>: <span style="color:#ba2121">&#34;0x0000482e&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_tsft&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_flags&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_rate&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_channel&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_fhss&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_dbm_antsignal&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_dbm_antnoise&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_lock_quality&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_tx_attenuation&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_db_tx_attenuation&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_dbm_tx_power&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_antenna&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_db_antsignal&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_db_antnoise&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_rxflags&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_xchannel&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_mcs&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_ampdu&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_vht&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_timestamp&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_he&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_he_mu&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_reserved&#34;</span>: <span style="color:#ba2121">&#34;0x00000000&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_rtap_ns&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_vendor_ns&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_present_word_radiotap_present_ext&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_flags&#34;</span>: <span style="color:#ba2121">&#34;0x00000000&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_cfp&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_preamble&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_wep&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_frag&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_fcs&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_datapad&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_badfcs&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_flags_radiotap_flags_shortgi&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_datarate&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_channel_freq&#34;</span>: <span style="color:#ba2121">&#34;2417&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_channel_flags&#34;</span>: <span style="color:#ba2121">&#34;0x000000a0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_turbo&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_cck&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_ofdm&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_2ghz&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_5ghz&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_passive&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_dynamic&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_gfsk&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_gsm&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_sturbo&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_half&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_channel_flags_radiotap_channel_flags_quarter&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_dbm_antsignal&#34;</span>: <span style="color:#ba2121">&#34;-69&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_antenna&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;radiotap_radiotap_rxflags&#34;</span>: <span style="color:#ba2121">&#34;0x00000000&#34;</span>,<span style="color:#ba2121">&#34;radiotap_rxflags_radiotap_rxflags_badplcp&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span><span style="color:#666">}</span>,<span style="color:#ba2121">&#34;wlan_radio&#34;</span>: <span style="color:#666">{</span><span style="color:#ba2121">&#34;wlan_radio_wlan_radio_phy&#34;</span>: <span style="color:#ba2121">&#34;4&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_wlan_radio_short_preamble&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_wlan_radio_data_rate&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_wlan_radio_channel&#34;</span>: <span style="color:#ba2121">&#34;2&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_wlan_radio_frequency&#34;</span>: <span style="color:#ba2121">&#34;2417&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_wlan_radio_signal_dbm&#34;</span>: <span style="color:#ba2121">&#34;-69&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_wlan_radio_duration&#34;</span>: <span style="color:#ba2121">&#34;272&#34;</span>,<span style="color:#ba2121">&#34;wlan_radio_duration_wlan_radio_preamble&#34;</span>: <span style="color:#ba2121">&#34;192&#34;</span><span style="color:#666">}</span>,<span style="color:#ba2121">&#34;wlan&#34;</span>: <span style="color:#666">{</span><span style="color:#ba2121">&#34;wlan_wlan_fc_type_subtype&#34;</span>: <span style="color:#ba2121">&#34;29&#34;</span>,<span style="color:#ba2121">&#34;wlan_wlan_fc&#34;</span>: <span style="color:#ba2121">&#34;0x0000d400&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_wlan_fc_version&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_wlan_fc_type&#34;</span>: <span style="color:#ba2121">&#34;1&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_wlan_fc_subtype&#34;</span>: <span style="color:#ba2121">&#34;13&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_wlan_flags&#34;</span>: <span style="color:#ba2121">&#34;0x00000000&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_ds&#34;</span>: <span style="color:#ba2121">&#34;0x00000000&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_tods&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_fromds&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_frag&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_retry&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_pwrmgt&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_moredata&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_protected&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_flags_wlan_fc_order&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_wlan_duration&#34;</span>: <span style="color:#ba2121">&#34;0&#34;</span>,<span style="color:#ba2121">&#34;wlan_wlan_ra&#34;</span>: <span style="color:#ba2121">&#34;c8:d1:2a:xx:xx:xx&#34;</span>,<span style="color:#ba2121">&#34;wlan_wlan_ra_resolved&#34;</span>: <span style="color:#ba2121">&#34;Comtrend_96:cc:64&#34;</span>,<span style="color:#ba2121">&#34;wlan_wlan_addr&#34;</span>: <span style="color:#ba2121">&#34;c8:d1:2a:xx:xx:xx&#34;</span>,<span style="color:#ba2121">&#34;wlan_wlan_addr_resolved&#34;</span>: <span style="color:#ba2121">&#34;Comtrend_96:cc:64&#34;</span><span style="color:#666">}}}</span></span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Thereâ€™s a couple of points to deal with here. The first is that for each packet there are <em>two</em> rows emitted; an index header for Elasticsearch (since <code>ek</code> is designed for ingest into it), and then the <em>full</em> payload. We donâ€™t want the whole payload but just a few columns. We can use the <code>-e</code> parameter to specify the fields that weâ€™re interested in, and a simple <code>grep</code> to drop the Elasticsearch header message. Iâ€™ve also added <code>-l</code> to stop the output being buffered:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo tshark -i mon0 <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -T ek <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -l <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.fc.type <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.fc.type_subtype <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan_radio.channel | <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>        grep timestamp</span></span></code></pre></div>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{<span style="color:#ba2121">&#34;timestamp&#34;</span> <span style="color:#666">:</span> <span style="color:#ba2121">&#34;1583923966878&#34;</span>, <span style="color:#ba2121">&#34;layers&#34;</span> <span style="color:#666">:</span> {<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;1&#34;</span>],<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;27&#34;</span>],<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;2&#34;</span>]}}
</span></span><span style="display:flex;"><span>{<span style="color:#ba2121">&#34;timestamp&#34;</span> <span style="color:#666">:</span> <span style="color:#ba2121">&#34;1583923967196&#34;</span>, <span style="color:#ba2121">&#34;layers&#34;</span> <span style="color:#666">:</span> {<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;1&#34;</span>],<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;27&#34;</span>],<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;2&#34;</span>]}}
</span></span><span style="display:flex;"><span>{<span style="color:#ba2121">&#34;timestamp&#34;</span> <span style="color:#666">:</span> <span style="color:#ba2121">&#34;1583923967296&#34;</span>, <span style="color:#ba2121">&#34;layers&#34;</span> <span style="color:#666">:</span> {<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;1&#34;</span>],<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;27&#34;</span>],<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span><span style="color:#666">:</span> [<span style="color:#ba2121">&#34;2&#34;</span>]}}</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>This is starting to look rather useful. Letâ€™s add in a bit of <code>jq</code> magic to merge the <code>timestamp</code> field in with the rest of the payload which weâ€™ll pull up to the root level:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo tshark -i mon0 <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -T ek <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -l <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.fc.type <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.fc.type_subtype <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan_radio.channel | <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>        grep timestamp | <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>        jq --unbuffered -c <span style="color:#ba2121">&#39;{timestamp: .timestamp} + .layers&#39;</span> </span></span></code></pre></div>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{<span style="color:#ba2121">&#34;timestamp&#34;</span><span style="color:#666">:</span><span style="color:#ba2121">&#34;1583924233530&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;0&#34;</span>],<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;4&#34;</span>],<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;2&#34;</span>]}
</span></span><span style="display:flex;"><span>{<span style="color:#ba2121">&#34;timestamp&#34;</span><span style="color:#666">:</span><span style="color:#ba2121">&#34;1583924235474&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;1&#34;</span>],<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;25&#34;</span>],<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;2&#34;</span>]}
</span></span><span style="display:flex;"><span>{<span style="color:#ba2121">&#34;timestamp&#34;</span><span style="color:#666">:</span><span style="color:#ba2121">&#34;1583924235613&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;1&#34;</span>],<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;25&#34;</span>],<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span><span style="color:#666">:</span>[<span style="color:#ba2121">&#34;2&#34;</span>]}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_streaming_wi_fi_data_into_apache_kafka">Streaming Wi-Fi data into Apache Kafka&nbsp;<a class="headline-hash" href="#_streaming_wi_fi_data_into_apache_kafka">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now, letâ€™s stream this data into Kafka. Once itâ€™s in Kafka we can use it for lots of things! We can use Kafka Connect to stream it onwards to places like Elasticsearch, Neo4j, S3. We can write ksqlDB applications to analyse and aggregate it. We can use it to drive services that subscribe to a stream of Wi-Fi data. The world will be our oyster!</p>
</div>
<div class="paragraph">
<p>Instead of the faff of running Kafka for myself Iâ€™m using Confluent Cloud. Its <a href="https://www.confluent.io/confluent-cloud-faqs/#how-is-pricing-calculated-for-confluent-cloud">pricing</a> is such that you just pay for the data you use, making it very cheap to start playing around with, especially with the current $50 credit per month for first three months offer. <a href="https://confluent.cloud/signup">Sign up</a> and create your cluster and get your API key and broker details.</p>
</div>
<div class="paragraph">
<p>Create a file with your Confluent Cloud details in:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat .env
</span></span><span style="display:flex;"><span><span style="color:#19177c">CCLOUD_BROKER_HOST</span><span style="color:#666">=</span>foo-bar.us-central1.gcp.confluent.cloud
</span></span><span style="display:flex;"><span><span style="color:#19177c">CCLOUD_API_KEY</span><span style="color:#666">=</span>XXXXXXXXXXX
</span></span><span style="display:flex;"><span><span style="color:#19177c">CCLOUD_API_SECRET</span><span style="color:#666">=</span>YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>We installed <code>kafkacat</code> above, and can now use it to connect to our cloud environment. The <code>-L</code> argument tells <code>kafkacat</code> to do a metadata query across the brokers and topics:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#008000">source</span> .env
</span></span><span style="display:flex;"><span>$ kafkacat -X security.protocol<span style="color:#666">=</span>SASL_SSL -X sasl.mechanisms<span style="color:#666">=</span>PLAIN -X api.version.request<span style="color:#666">=</span><span style="color:#008000">true</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -b <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_BROKER_HOST</span><span style="color:#b68;font-weight:bold">}</span>:9092 <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -X sasl.username<span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_API_KEY</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -X sasl.password<span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_API_SECRET</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -L</span></span></code></pre></div>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Metadata <span style="color:#008000;font-weight:bold">for</span> all topics <span style="color:#666">(</span>from broker -1: sasl_ssl://foobar.us-central1.gcp.confluent.cloud:9092/bootstrap<span style="color:#666">)</span>:
</span></span><span style="display:flex;"><span> <span style="color:#666">18</span> brokers:
</span></span><span style="display:flex;"><span>  broker <span style="color:#666">0</span> at b0-foobar.us-central1.gcp.confluent.cloud:9092
</span></span><span style="display:flex;"><span>  broker <span style="color:#666">5</span> at b5-foobar.us-central1.gcp.confluent.cloud:9092
</span></span><span style="display:flex;"><span>  broker <span style="color:#666">10</span> at b10-foobar.us-central1.gcp.confluent.cloud:9092
</span></span><span style="display:flex;"><span>  broker <span style="color:#666">15</span> at b15-foobar.us-central1.gcp.confluent.cloud:9092
</span></span><span style="display:flex;"><span>  broker <span style="color:#666">9</span> at b9-foobar.us-central1.gcp.confluent.cloud:9092
</span></span><span style="display:flex;"><span>â€¦
</span></span><span style="display:flex;"><span> <span style="color:#666">8</span> topics:
</span></span><span style="display:flex;"><span>  topic <span style="color:#ba2121">&#34;wibble&#34;</span> with <span style="color:#666">6</span> partitions:
</span></span><span style="display:flex;"><span>    partition 0, leader 13, replicas: 13,2,5, isrs: 13,2,5
</span></span><span style="display:flex;"><span>    partition 1, leader 14, replicas: 14,6,7, isrs: 14,6,7
</span></span><span style="display:flex;"><span>â€¦    </span></span></code></pre></div>
</div>
<div class="paragraph">
<p>Now that this is working, go ahead and create a topic called <code>pcap</code>, either through the Confluent Cloud web UI or the command line tool. Itâ€™s important that you create this topic, as auto-topic creation is not enabled on Confluent Cloud.</p>
</div>
<div class="paragraph">
<p>With the topic created, letâ€™s populate it! We are going to hook up the output from <code>tshark</code> in the previous section with the mighty power of <code>kafkacat</code> courtesy of unix pipes:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo tshark -i mon0 <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -T ek <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -l <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.fc.type -e wlan.fc.type_subtype -e wlan_radio.channel <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan_radio.signal_dbm -e wlan_radio.duration -e wlan.ra <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.ra_resolved -e wlan.da -e wlan.da_resolved <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.ta -e wlan.ta_resolved -e wlan.sa <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.sa_resolved -e wlan.staa -e wlan.staa_resolved <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.tagged.all -e wlan.tag.vendor.data -e wlan.tag.vendor.oui.type <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wlan.tag.oui -e wlan.ssid -e wlan.country_info.code <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -e wps.device_name |<span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>    grep timestamp|<span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>    jq -c <span style="color:#ba2121">&#39;{timestamp: .timestamp} + .layers&#39;</span> |<span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>    kafkacat -X security.protocol<span style="color:#666">=</span>SASL_SSL -X sasl.mechanisms<span style="color:#666">=</span>PLAIN -X api.version.request<span style="color:#666">=</span>true<span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -b <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_BROKER_HOST</span><span style="color:#b68;font-weight:bold">}</span>:9092 <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -X sasl.username<span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_API_KEY</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -X sasl.password<span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_API_SECRET</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -P <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -t pcap <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>            -T</span></span></code></pre></div>
</div>
<div class="paragraph">
<p>A few notes about whatâ€™s going on here. Weâ€™ve added in a bunch more fields from the Wi-Fi payload to capture in <code>tshark</code>. Weâ€™re also specifying <code>-P</code> to tell <code>kafkacat</code> to act as producer, <code>-t</code> to specify the topic, and <code>-T</code> to echo the messages to stdout as well as write them to the topic (just like <code>tee</code> does).</p>
</div>
<div class="paragraph">
<p>With this running youâ€™ll see the messages arriving in the topic, either through <code>kafkacat</code> run as a consumer:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kafkacat -X security.protocol<span style="color:#666">=</span>SASL_SSL -X sasl.mechanisms<span style="color:#666">=</span>PLAIN -X api.version.request<span style="color:#666">=</span><span style="color:#008000">true</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>           -b <span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_BROKER_HOST</span><span style="color:#b68;font-weight:bold">}</span>:9092 <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>           -X sasl.username<span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_API_KEY</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> -X sasl.password<span style="color:#666">=</span><span style="color:#ba2121">&#34;</span><span style="color:#b68;font-weight:bold">${</span><span style="color:#19177c">CCLOUD_API_SECRET</span><span style="color:#b68;font-weight:bold">}</span><span style="color:#ba2121">&#34;</span> <span style="color:#b62;font-weight:bold">\
</span></span></span><span style="display:flex;"><span><span style="color:#b62;font-weight:bold"></span>           -C -t pcap 
</span></span><span style="display:flex;"><span><span style="color:#666">{</span><span style="color:#ba2121">&#34;timestamp&#34;</span>:<span style="color:#ba2121">&#34;1583925922825&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;2&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;36&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;2&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_signal_dbm&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;-71&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_duration&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;384&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_da&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_da_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ta&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ta_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_sa&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_sa_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_staa&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_staa_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]}</span>
</span></span><span style="display:flex;"><span><span style="color:#666">{</span><span style="color:#ba2121">&#34;timestamp&#34;</span>:<span style="color:#ba2121">&#34;1583925941754&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;1&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;29&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;2&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_signal_dbm&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;-71&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_duration&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;272&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;Comtrend_96:cc:64&#34;</span><span style="color:#666">]}</span>
</span></span><span style="display:flex;"><span><span style="color:#666">{</span><span style="color:#ba2121">&#34;timestamp&#34;</span>:<span style="color:#ba2121">&#34;1583925963170&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;1&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;28&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;2&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_signal_dbm&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;-71&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_duration&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;40&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;Broadcom_08:04:20&#34;</span><span style="color:#666">]}</span>
</span></span><span style="display:flex;"><span><span style="color:#666">{</span><span style="color:#ba2121">&#34;timestamp&#34;</span>:<span style="color:#ba2121">&#34;1583925991920&#34;</span>,<span style="color:#ba2121">&#34;wlan_fc_type&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;2&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_fc_type_subtype&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;36&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_channel&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;2&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_signal_dbm&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;-79&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_radio_duration&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;384&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ra_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_da&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_da_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ta&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_ta_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_sa&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_sa_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_staa&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]</span>,<span style="color:#ba2121">&#34;wlan_staa_resolved&#34;</span>:<span style="color:#666">[</span><span style="color:#ba2121">&#34;00:11:22:33:44:55&#34;</span><span style="color:#666">]}</span></span></span></code></pre></div>
</div>
<div class="paragraph">
<p>or through the Confluent Cloud UI:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2020/03/ccloud_pcap_01.png" alt="ccloud pcap 01"/>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_next">Whatâ€™s next?&nbsp;<a class="headline-hash" href="#_whats_next">ðŸ”—</a> </h2>
<div class="sectionbody">
<div class="paragraph">
<p>So now weâ€™ve got the data streaming into Kafka, whatâ€™s next? Well, how about some <a href="https://ksqldb.io/">ksqlDB</a> to analyse it:</p>
</div>
<div class="paragraph">
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>ksql<span style="color:#666">&gt;</span><span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>TIMESTAMPTOSTRING(WINDOWSTART,<span style="color:#ba2121">&#39;yyyy-MM-dd HH:mm:ss&#39;</span>,<span style="color:#ba2121">&#39;Europe/London&#39;</span>)<span style="color:#bbb"> </span><span style="color:#008000;font-weight:bold">AS</span><span style="color:#bbb"> </span>WINDOW_START_TS,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#bbb">       </span>DISTINCT_TA_MACS,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#bbb">       </span>DISTINCT_RA_MACS,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#bbb">       </span>EVENT_COUNT<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#008000;font-weight:bold">FROM</span><span style="color:#bbb">   </span>PROBE_REQUESTS_BY_5MIN<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#008000;font-weight:bold">WHERE</span><span style="color:#bbb">  </span>ROWKEY<span style="color:#666">=</span><span style="color:#666">4</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">AND</span><span style="color:#bbb">  </span>WINDOWSTART<span style="color:#bbb"> </span><span style="color:#666">&gt;</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;2020-03-11T08:00:00.000&#39;</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">&gt;</span><span style="color:#bbb">  </span><span style="color:#008000;font-weight:bold">AND</span><span style="color:#bbb">  </span>WINDOWSTART<span style="color:#bbb"> </span><span style="color:#666">&lt;=</span><span style="color:#bbb"> </span><span style="color:#ba2121">&#39;2020-03-11T09:00:00.000&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">+</span><span style="color:#408080;font-style:italic">----------------------+------------------+------------------+-------------+
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#666">|</span>WINDOW_START_TS<span style="color:#bbb">       </span><span style="color:#666">|</span>DISTINCT_TA_MACS<span style="color:#bbb">  </span><span style="color:#666">|</span>DISTINCT_RA_MACS<span style="color:#bbb">  </span><span style="color:#666">|</span>EVENT_COUNT<span style="color:#bbb">  </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">+</span><span style="color:#408080;font-style:italic">----------------------+------------------+------------------+-------------+
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">05</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">13</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">2</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">30</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">10</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">15</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">63</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">15</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">9</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">2</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">29</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">20</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">10</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">28</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">25</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">8</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">37</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">30</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">12</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">2</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">57</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">35</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">14</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">42</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">40</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">22</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">77</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">45</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">21</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">2</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">64</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">50</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">10</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">40</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">08</span>:<span style="color:#666">55</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">17</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">1</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">58</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">|</span><span style="color:#666">2020</span><span style="color:#666">-</span><span style="color:#666">03</span><span style="color:#666">-</span><span style="color:#666">11</span><span style="color:#bbb"> </span><span style="color:#666">09</span>:<span style="color:#666">00</span>:<span style="color:#666">00</span><span style="color:#bbb">   </span><span style="color:#666">|</span><span style="color:#666">27</span><span style="color:#bbb">                </span><span style="color:#666">|</span><span style="color:#666">2</span><span style="color:#bbb">                 </span><span style="color:#666">|</span><span style="color:#666">54</span><span style="color:#bbb">           </span><span style="color:#666">|</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>Query<span style="color:#bbb"> </span>terminated<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>ksql<span style="color:#666">&gt;</span></span></span></code></pre></div>
</div>
<div class="paragraph">
<p>or property graph analysis to look at the relationship between things like SSIDs and devices?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/images/2020/03/elastic_graph_01.png" alt="elastic graph 01"/>
</div>
</div>
<div class="paragraph">
<p>Stay tuned!</p>
</div>
<div class="sect2">
<h3 id="_acknowledments_and_references">Acknowledments and References&nbsp;<a class="headline-hash" href="#_acknowledments_and_references">ðŸ”—</a> </h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://frdmtoplay.com/counting-wireless-devices-on-a-raspberry-pi-with-tcpdump/" class="bare">https://frdmtoplay.com/counting-wireless-devices-on-a-raspberry-pi-with-tcpdump/</a></p>
</li>
<li>
<p><a href="https://sandilands.info/sgordon/capturing-wifi-in-monitor-mode-with-iw" class="bare">https://sandilands.info/sgordon/capturing-wifi-in-monitor-mode-with-iw</a></p>
</li>
<li>
<p><a href="https://www.cisco.com/c/en/us/support/docs/wireless-mobility/80211/200527-Fundamentals-of-802-11-Wireless-Sniffing.html" class="bare">https://www.cisco.com/c/en/us/support/docs/wireless-mobility/80211/200527-Fundamentals-of-802-11-Wireless-Sniffing.html</a></p>
</li>
<li>
<p><a href="https://www.semfionetworks.com/uploads/2/9/8/3/29831147/wireshark_802.11_filters_-_reference_sheet.pdf" class="bare">https://www.semfionetworks.com/uploads/2/9/8/3/29831147/wireshark_802.11_filters_-_reference_sheet.pdf</a></p>
</li>
<li>
<p><a href="https://www.wireshark.org/docs/dfref/w/wlan.html" class="bare">https://www.wireshark.org/docs/dfref/w/wlan.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>

	<hr>
	<div class="giscus-container">
		<script src="https://giscus.app/client.js"
				data-repo="rmoff/rmoff-blog"
				data-repo-id="MDEwOlJlcG9zaXRvcnkxNTE3NDg2MTE="
				data-category="Announcements"
				data-category-id="DIC_kwDOCQuAA84CvP5T"
				data-mapping="pathname"
				data-strict="1"
				data-reactions-enabled="1"
				data-emit-metadata="0"
				data-input-position="bottom"
				data-theme="light"
				data-lang="en"
				crossorigin="anonymous"
				async>
		</script>
	</div>
</article>
      </main>
    
      
      <div class="docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">On this page</a></li>
        </ul>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#_kit_list">Kit list</a></li>
    <li><a href="#_set_up_the_wireless_interface">Set up the wireless interface</a></li>
    <li><a href="#_here_comes_the_tools">Here comes the tools</a></li>
    <li><a href="#_writing_structured_json_from_tshark">Writing structured JSON from <code>tshark</code></a></li>
    <li><a href="#_streaming_wi_fi_data_into_apache_kafka">Streaming Wi-Fi data into Apache Kafka</a></li>
    <li><a href="#_whats_next">Whatâ€™s next?</a>
      <ul>
        <li><a href="#_acknowledments_and_references">Acknowledments and References</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
      
    
    </div>
  </div>
</div>


		</main>

		

		
		<footer class="site-footer hide-print" role="contentinfo">
			<span>&copy; 2026 </span>
		</footer>
		

		
	</body>
</html>
