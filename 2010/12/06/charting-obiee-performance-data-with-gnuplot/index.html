<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" as="image" href="https://rmoff.net/img/default-header-img.webp" type="image/webp">
		
		<title>Charting OBIEE performance data with gnuplot</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2010/12/06/charting-obiee-performance-data-with-gnuplot/">
		
		

		
		<meta property="og:title" content="Charting OBIEE performance data with gnuplot" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/img/default-header-img.jpg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2010/12/06/charting-obiee-performance-data-with-gnuplot/" />
		<meta property="og:site_name" content="Charting OBIEE performance data with gnuplot" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<style>
			html { background-color: #FAF8F5; color: #2D2926; }
			body { opacity: 0; transition: opacity 0.1s ease; }
			body.loaded { opacity: 1; }
			.site-header { height: 60px; background-color: #FAF8F5; border-bottom: 1px solid #E8421E; }
		</style>

		
		
		<link rel="stylesheet" href="https://rmoff.net/css/redesign.css" />
		
		<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap">
		<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
		<noscript><link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,400;12..96,600;12..96,700;12..96,800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet"></noscript>
		

		

		
		<script>
			!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
            posthog.init('phc_93NEP79Ju4xqXYWXnoLbr4HMW0Iaepj1BGOVoEXYX6P',{api_host:'https://eu.i.posthog.com', person_profiles: 'identified_only'})
		</script>

		
		<script src="https://rmoff.net/js/story.js"></script>
		<script src="https://rmoff.net/js/toc.js"></script>
		<script src="https://rmoff.net/js/medium-mirror.js"></script>
	</head>
	<body class="ma0 section-post page-kind-page is-page-true ">
		<script>document.body.classList.add('loaded');</script>

		<header class="site-header hide-print">
	<div class="site-header-inner">
		<a href="https://rmoff.net/" class="site-title">rmoff's random ramblings</a>
		<nav class="site-nav">
			<a href="/categories/interesting-links/" class="nav-il"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> Interesting Links</a>
			<span class="nav-sep"></span>
			<a href="/categories/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg> Categories</a>
			<a href="https://rmoff.net/search/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg> Search</a>
			<a href="https://rmoff.net/index.xml"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg> RSS</a>
			<div class="nav-social">
				<a href="https://www.linkedin.com/in/robinmoffatt/" title="linkedin"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
				<a href="https://twitter.com/rmoff/" title="twitter"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
				<a href="https://bsky.app/profile/rmoff.net" title="bluesky"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 568 501" fill="currentColor"><path d="M123.121 33.664C188.241 82.553 258.281 181.68 284 234.873c25.719-53.192 95.759-152.32 160.879-201.21C491.866-1.611 568-28.906 568 57.947c0 17.346-9.945 145.713-15.778 166.555-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281-2.462-7.227-3.614-10.608-3.631-7.733-.017-2.875-1.169.506-3.631 7.733-13.43 39.422-65.842 193.273-185.702 70.281-63.111-64.76-33.89-129.52 80.986-149.071-65.72 11.185-139.6-7.295-159.875-79.748C10.945 203.659 1 75.291 1 57.946 1-28.906 76.135-1.612 123.121 33.664z"/></svg></a>
				<a href="https://www.youtube.com/c/rmoff" title="youtube"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
				<a href="https://talks.rmoff.net" title="talks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="0"/><line x1="12" y1="17" x2="12" y2="22"/><line x1="8" y1="22" x2="16" y2="22"/><polyline points="7 8 12 12 17 8"/></svg></a>
				<a href="https://github.com/rmoff/" title="github"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
			</div>
		</nav>
		<button class="nav-toggle" onclick="document.querySelector('.mobile-nav').classList.toggle('open')" aria-label="Menu">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
		</button>
	</div>
	<nav class="mobile-nav">
		<a href="https://rmoff.net/">Home</a>
		<a href="/categories/">Categories</a>
		<a href="/categories/interesting-links/">Interesting Links</a>
		<a href="https://rmoff.net/search/">Search</a>
		<a href="https://rmoff.net/index.xml">RSS</a>
		<a href="https://www.linkedin.com/in/robinmoffatt/">linkedin</a>
		<a href="https://twitter.com/rmoff/">twitter</a>
		<a href="https://bsky.app/profile/rmoff.net">bluesky</a>
		<a href="https://www.youtube.com/c/rmoff">youtube</a>
		<a href="https://talks.rmoff.net">talks</a>
		<a href="https://github.com/rmoff/">github</a>
	</nav>
</header>


		<main role="main">
		

<div class="article-hero" style="background-image: url('https://rmoff.net/img/default-header-img.webp');">
	<div class="article-hero-overlay">
		<div class="article-hero-content">
			<h1>Charting OBIEE performance data with gnuplot</h1>
			<p class="article-hero-meta">
				
					<time datetime="2010-12-06T00:00:00Z">06 Dec 2010</time>
					<span class="display-print">by </span>
					 &middot; <a href="https://rmoff.net/categories/gnuplot">gnuplot</a>, <a href="https://rmoff.net/categories/jmx">jmx</a>, <a href="https://rmoff.net/categories/monitoring">monitoring</a>, <a href="https://rmoff.net/categories/obiee">OBIEE</a>, <a href="https://rmoff.net/categories/unix">unix</a>, <a href="https://rmoff.net/categories/visualisation">visualisation</a>
					<span class="display-print">at https://rmoff.net/2010/12/06/charting-obiee-performance-data-with-gnuplot/</span>
				
			</p>
		</div>
	</div>
</div>


<details class="toc-mobile">
	<summary>Table of Contents</summary>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#gnuplot">gnuplot</a></li>
    <li><a href="#plotting-multiple-datasets">Plotting multiple datasets</a></li>
    <li><a href="#generating-gnuplot-scripts-automagically">Generating gnuplot scripts automagically</a></li>
    <li><a href="#plotting-subsets-of-data">Plotting subsets of data</a></li>
    <li><a href="#refreshing-your-graphs-automagically">Refreshing your graphs automagically</a></li>
    <li><a href="#what-next">What next?</a></li>
  </ul>
</nav>
</details>

<div class="container-fluid docs">
	<div class="row">
		<main class="docs-content" role="main">

<article class="article" data-pagefind-body>
	<span data-pagefind-filter="category" style="display:none">gnuplot</span><span data-pagefind-filter="category" style="display:none">jmx</span><span data-pagefind-filter="category" style="display:none">monitoring</span><span data-pagefind-filter="category" style="display:none">OBIEE</span><span data-pagefind-filter="category" style="display:none">unix</span><span data-pagefind-filter="category" style="display:none">visualisation</span>
	<img data-pagefind-meta="image[src]" src="https://rmoff.net/img/default-header-img.jpg" style="display:none" alt="">
	<h2 id="introduction">Introduction&nbsp;<a class="headline-hash" href="#introduction">ðŸ”—</a> </h2>
<p>This is the second part of three detailed articles making up a mini-series about <a href="/2010/12/06/obiee-monitoring/">OBIEE monitoring</a>. It demonstrates how to capture OBIEE performance information, and optionally graph it out and serve it through an auto-updating webpage.</p>
<p>This article takes data that <a href="/2010/12/06/collecting-obiee-systems-management-data-with-jmx/">part one</a> showed you how to collect into a tab-separated file that looks something like this:</p>
<p>[sourcecode] 2010-11-29-14:48:18 1 0 11 0 3 2 1 676 340 0 53 1 0 41 0 3 0 2010-11-29-14:49:18 1 0 11 0 3 2 1 676 0 0 0 1 0 0 0 3 0 2010-11-29-14:50:18 2 0 16 1 4 3 1 679 0 0 0 1 0 0 0 4 0 2010-11-29-14:51:18 2 2 19 1 4 3 1 679 32 0 53 1 0 58 0 4 0 2010-11-29-14:52:18 2 1 19 1 4 3 4 682 0 0 0 1 0 0 0 4 0 2010-11-29-14:53:18 2 1 19 1 4 3 4 682 0 0 0 1 0 0 0 4 0 2010-11-29-14:54:18 2 0 19 1 4 3 1 682 0 0 0 1 0 0 0 4 0 [/sourcecode]</p>
<p>and plot it into something like looks like this: <img src="/images/rnm1978/summary-6hr.png" alt="" title="summary.6hr"></p>
<h2 id="gnuplot">gnuplot&nbsp;<a class="headline-hash" href="#gnuplot">ðŸ”—</a> </h2>
<p>Depending on what you&rsquo;re wanting to use the data for, and your level of comfort with command-line tools, you may just want to take your datafile and plot it with something like Excel for ad-hoc analysis. However, for fully automated data capture and rendering, I&rsquo;d recommend giving gnuplot a go. It&rsquo;s not the simplest of tools and the documentation is so vast as to be overwhelming - but if you&rsquo;ve the time to tweak it then you will find it very flexible.</p>
<p>gnuplot can be run interactively (which is useful for trialling settings) or as part of batch script, and can output to screen or file (eg. png). It assumes that your data is tab separated (which it should be if you&rsquo;ve used my script).</p>
<p>The key bit to understand is the &ldquo;plot xxx using yyy&rdquo; statement. In this, xxx is your data file, whilst yyy is the columns to plot for x and y data respectively. So assuming that your x-axis is time and the first column in your datafile, and you want to plot the number of Active Sessions (which in my script is the fourth metric, so the fifth column - time being the first), you would have &ldquo;using 1:5&rdquo;. [sourcecode] plot &ldquo;datafile.jmx&rdquo; using 1:5 with lines [/sourcecode]</p>
<p>To plot to a PNG file, use a script like this:</p>
<p>[sourcecode language=&ldquo;bash&rdquo;] gnuplot &laquo;EOF set xdata time set timefmt &ldquo;%Y-%m-%d-%H:%M:%S&rdquo; set format x &ldquo;%d %b\n%H:%M&rdquo; set yrange[0:30] set grid set key box outside below set terminal png font &ldquo;arial, 7&rdquo; size 410,200 enhanced truecolor set output &ldquo;graph01.png&rdquo; set title &ldquo;Oracle BI PS Sessions\nActive Sessions&rdquo; plot &ldquo;datafile.jmx&rdquo; using 1:5 with lines [/sourcecode]</p>
<p>This line invokes gnuplot, and &laquo;EOF tells it to pass the subsequent lines to gnuplot until end of file (or you put EOF literal in the file).</p>
<p>[sourcecode] gnuplot &laquo;EOF [/sourcecode]</p>
<p>This sets the x-axis as a time axis, gnuplot then scales it appropriately. The timefmt defines the format of the time data in the input file.</p>
<p>[sourcecode] set xdata time set timefmt &ldquo;%Y-%m-%d-%H:%M:%S&rdquo; [/sourcecode]</p>
<p>The format of the axis labels on the x-axis is defined thus:</p>
<p>[sourcecode] set format x &ldquo;%d %b\n%H:%M&rdquo; [/sourcecode]</p>
<p>This hard-codes the y-axis range. Use &ldquo;set autoscale&rdquo; to revert to the default of gnuplot setting the range.</p>
<p>[sourcecode] set yrange[0:30] [/sourcecode]</p>
<p>This puts a grid on the chart, and defines the title</p>
<p>[sourcecode] set grid set title &ldquo;Oracle BI PS Sessions\nActive Sessions&rdquo; [/sourcecode]</p>
<p>This tells gnuplot to write to a png file, using arial 7pt font, 410x200 pixels, and higher resolution. The &ldquo;set output&rdquo; command defines the actual filename.</p>
<p>[sourcecode] set terminal png font &ldquo;arial, 7&rdquo; size 410,200 enhanced truecolor set output &ldquo;graph01.png&rdquo; [/sourcecode]</p>
<p>If you omit the &ldquo;set terminal png [&hellip;]&rdquo; line you&rsquo;ll get an interactive graph from gnuplot, which can be useful for testing different settings.</p>
<h2 id="plotting-multiple-datasets">Plotting multiple datasets&nbsp;<a class="headline-hash" href="#plotting-multiple-datasets">ðŸ”—</a> </h2>
<p>You can visualise multiple datasets alongside each other easily in gnuplot. You might want to do this for related metrics (eg Active Sessions vs Current Sessions), or a clustered OBIEE deployment:</p>
<p><img src="/images/rnm1978/obia_6hr.png" alt="" title="obia_6hr"></p>
<p><img src="/images/rnm1978/summary-6hr.png" alt="" title="summary.6hr"></p>
<p>To do this you append multiple statements to the &ldquo;plot&rdquo; command, separated by a comma: [sourcecode] plot &ldquo;datafile_server01.jmx&rdquo; using 1:4 with lines title &ldquo;Server 01&rdquo;\ , &ldquo;datafile_server02.jmx&rdquo; using 1:4 with lines title &ldquo;Server 02&rdquo; [/sourcecode] (the \ is a line-continuation character)</p>
<p>The title for each dataset is defined as part of the statement as is seen above. This can be shown in a key which is enabled by default and can be moved to the bottom of the graph by using: [sourcecode] set key box outside below [/sourcecode]</p>
<h2 id="generating-gnuplot-scripts-automagically">Generating gnuplot scripts automagically&nbsp;<a class="headline-hash" href="#generating-gnuplot-scripts-automagically">ðŸ”—</a> </h2>
<p>You may have realised by now that this is all quite fiddly to set up. Here are two scripts that will help generate gnuplot scripts. It&rsquo;s based on the tcl script from <a href="/2010/12/06/collecting-obiee-systems-management-data-with-jmx/">part one</a> and uses the first item in the array, ID, to determine the column number that a metric will appear in in the datafile.</p>
<p>This first one writes a series of gnuplot statements to plot each metric out on an individual graph, and assumes you have a two-server cluster so plots the datafiles from two servers on the same graph. [sourcecode language=&ldquo;bash&rdquo;] cat gnuplot_header grep lappend obieejmx_server01.tcl|\ sed s/{//g|\ sed s/}//g|\ sed s/&ldquo;lappend mbeanattrs &ldquo;//g|\ sed s/&ldquo;Oracle BI Management:Oracle BI=Performance,AppName=&rdquo;//g|\ sed s/&ldquo;Oracle BI Server,&rdquo;/&ldquo;BI&rdquo;/g|\ sed s/&ldquo;name=Oracle BI General&rdquo;/&rdquo;&quot;/g|\ sed s/&ldquo;type=Oracle BI Physical DB,name=Oracle Data Warehouse&rdquo;/&ldquo;DB&rdquo;/g|\ sed s/&ldquo;type=Oracle BI DB Connection Pool,name=Star_Oracle Data Warehouse_Oracle Data Warehouse Connection Pool&rdquo;/&ldquo;Conn Pool&rdquo;/g|\ sed s/&ldquo;Oracle BI Presentation Server,name=Oracle BI PS &ldquo;/&ldquo;BIPS&rdquo;/g|\ sed s/&ldquo;Connection&rdquo;/&ldquo;Conn&rdquo;/g|\ sed s/&ldquo;Current&rdquo;/&ldquo;Curr&rdquo;/g|\ sed s/&ldquo;Sessions&rdquo;/&ldquo;Sess&rdquo;/g|\ awk &lsquo;FS=&rdquo;\t&rdquo; { $1+=1 print &ldquo;set output \&rdquo;&quot;$1&rdquo;.png\&quot;&quot; print &ldquo;set title \&rdquo;&quot; $2 &ldquo;\\n&rdquo; $3 &ldquo;\&rdquo;&quot; print &ldquo;plot \&ldquo;server01.jmx\&rdquo; using 1:&rdquo; $1 &quot; with lines title \&ldquo;server01\&rdquo;,\&ldquo;server02.jmx\&rdquo; using 1:&quot; $1 &quot; with lines title \&ldquo;server02\&rdquo;&quot; }&rsquo; [/sourcecode]</p>
<p>gnuplot_header is a file you need to create in the same directory, and can just be a copy of the example gnuplot statement above.</p>
<p>This script plots multiple metrics for a single server onto the same graph. You may want to break the statements up into separate graph plots to group together related metrics or ones with similar ranges - this script will at least give you the correct column and titles to get you started. [sourcecode language=&ldquo;bash&rdquo;] cat gnuplot_header grep lappend obieejmx_server01.tcl|\ sed s/{//g|\ sed s/}//g|\ sed s/&ldquo;lappend mbeanattrs &ldquo;//g|\ sed s/&ldquo;Oracle BI Management:Oracle BI=Performance,AppName=&rdquo;//g|\ sed s/&ldquo;Oracle BI Server,&rdquo;/&ldquo;BI&rdquo;/g|\ sed s/&ldquo;name=Oracle BI General&rdquo;/&rdquo;&quot;/g|\ sed s/&ldquo;type=Oracle BI Physical DB,name=Oracle Data Warehouse&rdquo;/&ldquo;DB&rdquo;/g|\ sed s/&ldquo;type=Oracle BI DB Connection Pool,name=Star_Oracle Data Warehouse_Oracle Data Warehouse Connection Pool&rdquo;/&ldquo;Conn Pool&rdquo;/g|\ sed s/&ldquo;Oracle BI Presentation Server,name=Oracle BI PS &ldquo;/&ldquo;BIPS&rdquo;/g|\ sed s/&ldquo;Connection&rdquo;/&ldquo;Conn&rdquo;/g|\ sed s/&ldquo;Current&rdquo;/&ldquo;Curr&rdquo;/g|\ sed s/&ldquo;Sessions&rdquo;/&ldquo;Sess&rdquo;/g|\ awk &lsquo;BEGIN { FS=&rdquo;\t&rdquo; print &ldquo;set output \&ldquo;server01.png\&rdquo;&rdquo; print &ldquo;set title \&ldquo;server01\&rdquo;&rdquo; printf &ldquo;plot &quot; } { $1+=1 if (NR&gt;1) {printf &ldquo;\\\n,&rdquo;} printf &quot; \&ldquo;server01.jmx\&rdquo; using 1:&rdquo; $1 &quot; with lines title \&rdquo;&quot; $2 &ldquo;:&rdquo; $3 &ldquo;\&rdquo;&quot; } END {print &ldquo;&rdquo;}&rsquo; [/sourcecode]</p>
<p>Both scripts use a series of sed statements to try and trim down the MBean names into something shorter for plotting on the graph key.</p>
<p>An example output would look something like this: [sourcecode language=&ldquo;bash&rdquo;] # One metric per graph, across two servers gnuplot &ndash;persist &laquo;EOF set xdata time set timefmt &ldquo;%Y-%m-%d-%H:%M:%S&rdquo; set format x &ldquo;%d %b\n%H:%M&rdquo; set grid set key box outside below set terminal png font &ldquo;arial, 7&rdquo; size 410,200 enhanced truecolor set yrange [0:30] set output &ldquo;2.obiee.png&rdquo; set title &ldquo;Oracle BI Presentation Server - Oracle BI PS Connection Pool\nCurrent Open Connections&rdquo; plot &ldquo;server01.jmx&rdquo; using 1:2 with lines title &ldquo;server01&rdquo;,&ldquo;server02.jmx&rdquo; using 1:2 with lines title &ldquo;server02&rdquo; set output &ldquo;3.obiee.png&rdquo; set title &ldquo;Oracle BI Presentation Server - Oracle BI PS Query Cache\nCurrent Running Queries&rdquo; plot &ldquo;server01.jmx&rdquo; using 1:3 with lines title &ldquo;server01&rdquo;,&ldquo;server02.jmx&rdquo; using 1:3 with lines title &ldquo;server02&rdquo; set output &ldquo;5.obiee.png&rdquo; set title &ldquo;Oracle BI Presentation Server - Oracle BI PS Sessions\nActive Sessions&rdquo; plot &ldquo;server01.jmx&rdquo; using 1:5 with lines title &ldquo;server01&rdquo;,&ldquo;server02.jmx&rdquo; using 1:5 with lines title &ldquo;server02&rdquo; set output &ldquo;6.obiee.png&rdquo; set title &ldquo;Oracle BI Presentation Server - Oracle BI PS Sessions\nCurrent Sessions&rdquo; plot &ldquo;server01.jmx&rdquo; using 1:6 with lines title &ldquo;server01&rdquo;,&ldquo;server02.jmx&rdquo; using 1:6 with lines title &ldquo;server02&rdquo; set output &ldquo;7.obiee.png&rdquo; set title &ldquo;Oracle BI Presentation Server - Oracle BI PS Sessions\nSessions Logged On&rdquo; plot &ldquo;server01.jmx&rdquo; using 1:7 with lines title &ldquo;server01&rdquo;,&ldquo;server02.jmx&rdquo; using 1:7 with lines title &ldquo;server02&rdquo; set output &ldquo;8.obiee.png&rdquo; [/sourcecode]</p>
<p>[sourcecode language=&ldquo;bash&rdquo;] # Single server, multiple metrics on one graph gnuplot &ndash;persist &laquo;EOF set xdata time set timefmt &ldquo;%Y-%m-%d-%H:%M:%S&rdquo; set format x &ldquo;%d %b\n%H:%M&rdquo; set grid set key box outside right set terminal png font &ldquo;arial,9&rdquo; size 1224,500 enhanced truecolor</p>
<p>set output &ldquo;server01.png&rdquo; set title &ldquo;server01&rdquo; set yrange[0:30] plot &ldquo;server01.jmx&rdquo; using 1:2 with lines title &ldquo;BIPSConn Pool:Curr Open Conns&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:3 with lines title &ldquo;BIPSQuery Cache:Curr Running Queries&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:5 with lines title &ldquo;BIPSSess:Active Sess&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:6 with lines title &ldquo;BIPSSess:Curr Sess&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:7 with lines title &ldquo;BIPSSess:Sess Logged On&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:8 with lines title &ldquo;BIConn Pool:Curr Busy Conn Count&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:13 with lines title &ldquo;BI:Active Execute Requests&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:14 with lines title &ldquo;BI:Active Fetch Requests&rdquo;\ , &ldquo;server01.jmx&rdquo; using 1:17 with lines title &ldquo;BI:Total sessions&rdquo; [/sourcecode]</p>
<h2 id="plotting-subsets-of-data">Plotting subsets of data&nbsp;<a class="headline-hash" href="#plotting-subsets-of-data">ðŸ”—</a> </h2>
<p>You may well want to plot out subsets of the graph data, for example, the last 24 hours. This is simple to do, just run the jmx datafile through something like tail first: [sourcecode language=&ldquo;bash&rdquo;] # Create 24 hour extract of data # Data is sampled every minute, so the last 24 hours will be 60*24 = 1440 tail -n 1440 server01.jmx &gt; server01.24hr.jmx [/sourcecode]</p>
<h2 id="refreshing-your-graphs-automagically">Refreshing your graphs automagically&nbsp;<a class="headline-hash" href="#refreshing-your-graphs-automagically">ðŸ”—</a> </h2>
<p>Assuming you&rsquo;ve got your graph plotting script(s) in separate shell file(s), create a wrapper like this: [sourcecode language=&ldquo;bash&rdquo;] # Uncomment this for debug, to echo each statement as it&rsquo;s executed # set -x # # This will loop for ever and ever # (or until one becomes less than two) while [ 1 -lt 2 ] do # create any subset data files, using tail, as described above ./create_6hr_logs.sh ./create_24hr_logs.sh # plot your graph(s) ./plot_by_server.sh ./plot_by_server_summary.sh ./plot_by_server_6hr.sh ./plot_by_server_6hr_summary.sh ./plot_6hr_graphs.sh ./plot_24hr_graphs.sh # Copy all output png files to a tmp folder # from where they&rsquo;ll be served up as a web page # (I told you it was a hack) cp *.png /tmp/obieejmx chmod g+r /tmp/obieejmx/*.png # # Write the current time, for debug purposes date # Wait for a minute sleep 60 done [/sourcecode]</p>
<p>And then run your wrapper in the same way as the metric collection, using nohup and &amp; [sourcecode language=&ldquo;bash&rdquo;] nohup ./run_graphs_forever.sh &amp; [/sourcecode]</p>
<h2 id="what-next">What next?&nbsp;<a class="headline-hash" href="#what-next">ðŸ”—</a> </h2>
<p>So you&rsquo;ve got your data &hellip; you&rsquo;ve got your graphs &hellip; now why not serve them up through a convenient webpage that refreshes automatically? <a href="/2010/12/06/adding-obiee-monitoring-graphs-into-oas/">Click here for part three</a> that shows you how to bolt this onto an existing OAS installation.</p>

	<hr>
	<div class="giscus-container">
		<script src="https://giscus.app/client.js"
				data-repo="rmoff/rmoff-blog"
				data-repo-id="MDEwOlJlcG9zaXRvcnkxNTE3NDg2MTE="
				data-category="Announcements"
				data-category-id="DIC_kwDOCQuAA84CvP5T"
				data-mapping="pathname"
				data-strict="1"
				data-reactions-enabled="1"
				data-emit-metadata="0"
				data-input-position="bottom"
				data-theme="light"
				data-lang="en"
				crossorigin="anonymous"
				async>
		</script>
	</div>
</article>
      </main>
    
      
      <div class="docs-toc">
        <ul class="nav toc-top">
          <li><a href="#" id="back_to_top" class="docs-toc-title">On this page</a></li>
        </ul>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#gnuplot">gnuplot</a></li>
    <li><a href="#plotting-multiple-datasets">Plotting multiple datasets</a></li>
    <li><a href="#generating-gnuplot-scripts-automagically">Generating gnuplot scripts automagically</a></li>
    <li><a href="#plotting-subsets-of-data">Plotting subsets of data</a></li>
    <li><a href="#refreshing-your-graphs-automagically">Refreshing your graphs automagically</a></li>
    <li><a href="#what-next">What next?</a></li>
  </ul>
</nav>
      </div>
      
    
    </div>
  </div>
</div>


		</main>

		

		
		<footer class="site-footer hide-print" role="contentinfo">
			<span>&copy; 2026 </span>
		</footer>
		

		
	</body>
</html>
