<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>awk - split a fixed width file into separate files named on content</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2010/10/19/awk-split-a-fixed-width-file-into-separate-files-named-on-content/">
		
		
		
		
		
		<meta property="og:title" content="awk - split a fixed width file into separate files named on content" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/img/default-header-img.jpg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2010/10/19/awk-split-a-fixed-width-file-into-separate-files-named-on-content/" />
		<meta property="og:site_name" content="awk - split a fixed width file into separate files named on content" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<link rel="stylesheet" href="https://rmoff.net/css/tachyons.min.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/story.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/descartes.css" />
		
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans:400,400i,700,700i|Quattrocento:400,700|Spectral:400,400i,700,700i&amp;subset=latin-ext" rel="stylesheet">
		

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		
		<script src="https://rmoff.net/js/story.js"></script>

	</head>
	<body class="ma0 bg-white section-post page-kind-page is-page-true ">
		
		<header class="cover bg-top" style="background-image: url('https://rmoff.net/img/default-header-img.jpg'); background-position: center;">
			<div class="bg-black-30 bb bt">

				<nav class="hide-print sans-serif  border-box pa3 ph5-l">
					<a href="https://rmoff.net" title="Home">
						<img src="https://rmoff.net/img/logo.jpg" class="w2 h2 br-100" alt="rmoff&#39;s random ramblings" />
					</a>
					<div class="fr h2 pv2 tr">
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net/bio">about</a>
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net">talks</a>
						<a class="link f5 ml2 dim near-white" href="https://www.youtube.com/c/rmoff"><i class="fab fa-youtube-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://twitter.com/rmoff/"><i class="fab fa-twitter-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://github.com/rmoff/"><i class="fab fa-github-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://www.linkedin.com/in/robinmoffatt/"><i class="fab fa-linkedin"></i></a>
						<a class="link f5 ml2 dim near-white fas fa-rss-square" href="https://rmoff.net/index.xml" title="RSS Feed"></a>
						<a class="link f5 ml2 dim near-white fas fa-search" href="https://rmoff.net/search/" role="search" title="Search"></a>
					</div>
				</nav>

				<div id="hdr" class="tc-l pv4-ns pv5-l pv2 ph3 ph4-ns">
					<h1 class="near-white mt1-ns f2 fw3 mb0 mt0 lh-title">awk - split a fixed width file into separate files named on content</h1>
					<h2 class="near-white mt3-l mb4-l fw1 f6 f3-l measure-wide-l center lh-copy mt2 mb3">
						
						
							
								Published
								<time datetime="2010-10-19T00:00:00Z">Oct 19, 2010</time>
								<span class="display-print">by </span>
								 in <a href="https://rmoff.net/categories/obiee" class="no-underline category near-white dim">Obiee</a>
								<span class="display-print">at https://rmoff.net/2010/10/19/awk-split-a-fixed-width-file-into-separate-files-named-on-content/</span>
							
						
					</h2>
				</div>

				
				
				
				

			</div>
		</header>
		
		<main role="main">
		
<article class="center bg-white br-3 pv1 ph4 lh-copy f5 nested-links mw8">
	<p>More of a unix thing than DW/BI this post, but I have a beard so am semi-qualified&hellip;.</p>
<p>The requirement was to improve the performance of some ODI processing that as part of its work was taking one huge input file, and splitting it into chunks based on content in the file. To add some (minor) spice the file was fixed width with no deliminators, so the easy awk answers that I found on google weren&rsquo;t applicable.</p>
<p>Source file, to be split based on cols 14-16: [sourcecode] 0000000010069583000A 0000000010083583000A 0000000011600583000B 0000000011936584000D 0000000010101584000E 0000000010903584000G 0000000010517585000Q [/sourcecode]</p>
<p>Output files: prefix.583.dat [sourcecode] 0000000010069583000A 0000000010083583000A 0000000011600583000B [/sourcecode]</p>
<p>prefix.584.dat [sourcecode] 0000000011936584000D 0000000010101584000E 0000000010903584000G [/sourcecode]</p>
<p>prefix.585.dat [sourcecode] 0000000010517585000Q [/sourcecode]</p>
<p>So without further ado, my little command-line gem: [sourcecode language=&ldquo;bash&rdquo;] awk &lsquo;{fn=substr($0,14,3);print &gt; (&ldquo;prefix.&rdquo; fn &ldquo;.dat&rdquo;)}&rsquo; file.dat [/sourcecode] Where:</p>
<ul>
<li>the output filename is made up of characters from column 14 in the input record for 3 characters</li>
<li>file.dat is the input filename</li>
</ul>
<p>For extra brownie points, incorporate components of the input filename in the output filenames: [sourcecode language=&ldquo;bash&rdquo;] awk &lsquo;BEGIN {dt=substr(FILENAME,6,8)} {fn=substr($0,14,3);print &gt; (&ldquo;prefix.&rdquo; fn &ldquo;.&rdquo; dt &ldquo;.dat&rdquo;)}&rsquo; file.20101018.dat [/sourcecode]</p>
<p>As a sidenote, this is an example of choosing the right tools for the job - when there&rsquo;s simple commandline tools that can be scripted like this, using a heavyweight tool like ODI is overkill and can indeed land you with performance problems.</p>
<p>[edit] Ted Dziuba has written a great article here on how unix utilities can often be the right tool for the job: <a href="http://teddziuba.com/2010/10/taco-bell-programming.html">Taco Bell Programming</a>. [/edit]</p>

</article>

		</main>
		
				<div class="hide-print sans-serif f6 f5-l mt5 ph3 pb6 center nested-copy-line-height lh-copy nested-links mw-100 measure-wide">
		<div class="about-the-author">
		
			
			
				
					<hr>
<p><img src="/images/2018/05/ksldn18-01.jpg" alt="Robin Moffatt"></p>
<p><a href="https://www.youtube.com/c/rmoff"><b class="fab fa-youtube-square"></b></a> <a href="https://www.linkedin.com/in/robinmoffatt/"><b class="fab fa-linkedin"></b></a> <em><a rel="me" href="https://data-folks.masto.host/@rmoff">Robin Moffatt</a> is a Principal Developer Advocate at Confluent, and an Oracle ACE Director (Alumnus). He likes writing about himself in the third person, eating good breakfasts, and drinking good beer.</em></p>

				
			
		
		</div>
		
	</div>

		
		
		
		<footer class="hide-print sans-serif f6 fw1 bg-black near-white bottom-0 w-100 pa3" role="contentinfo">
			<p class="w-50 fr tr">
			<a class="no-underline near-white" href="https://github.com/xaprb/story"><img class="dib" title="Made with Hugo and Story" alt="Story logo" src="https://rmoff.net/img/story-logo-white.svg" style="width: 1.5rem; height: 1.5rem" /></a>
			</p>
			<p class="w-50 near-white">
				&copy; 2022 
			</p>
		</footer>
		
	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-75492960-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

	
	</body>
</html>
