<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Identify your OBIEE users by setting Client ID in Oracle connection</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="https://rmoff.net/index.xml">
		<link rel="canonical" href="https://rmoff.net/2010/01/26/identify-your-obiee-users-by-setting-client-id-in-oracle-connection/">
		
		
		
		
		
		<meta property="og:title" content="Identify your OBIEE users by setting Client ID in Oracle connection" />
		<meta property="og:type" content="article" />
		<meta property="og:image" content="https://rmoff.net/img/default-header-img.jpg" />
		<meta property="og:description" content="" />
		<meta property="og:url" content="https://rmoff.net/2010/01/26/identify-your-obiee-users-by-setting-client-id-in-oracle-connection/" />
		<meta property="og:site_name" content="Identify your OBIEE users by setting Client ID in Oracle connection" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@" />


		
		<link rel="stylesheet" href="https://rmoff.net/css/tachyons.min.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/story.css" />
		<link rel="stylesheet" href="https://rmoff.net/css/descartes.css" />
		
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans:400,400i,700,700i|Quattrocento:400,700|Spectral:400,400i,700,700i&amp;subset=latin-ext" rel="stylesheet">
		

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		
		<script src="https://rmoff.net/js/story.js"></script>

	</head>
	<body class="ma0 bg-white section-post page-kind-page is-page-true ">
		
		<header class="cover bg-top" style="background-image: url('https://rmoff.net/img/default-header-img.jpg'); background-position: center;">
			<div class="bg-black-30 bb bt">

				<nav class="hide-print sans-serif  border-box pa3 ph5-l">
					<a href="https://rmoff.net" title="Home">
						<img src="https://rmoff.net/img/logo.jpg" class="w2 h2 br-100" alt="rmoff&#39;s random ramblings" />
					</a>
					<div class="fr h2 pv2 tr">
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net/bio">about</a>
						<a class="link f5 ml2 dim near-white" href="https://talks.rmoff.net">talks</a>
						<a class="link f5 ml2 dim near-white" href="https://www.youtube.com/c/rmoff"><i class="fab fa-youtube-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://data-folks.masto.host/@rmoff"><i class="fab fa-mastodon"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://twitter.com/rmoff/"><i class="fab fa-twitter-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://github.com/rmoff/"><i class="fab fa-github-square"></i></a>
						<a class="link f5 ml2 dim near-white" href="https://www.linkedin.com/in/robinmoffatt/"><i class="fab fa-linkedin"></i></a>
						<a class="link f5 ml2 dim near-white fas fa-rss-square" href="https://rmoff.net/index.xml" title="RSS Feed"></a>
						<a class="link f5 ml2 dim near-white fas fa-search" href="https://rmoff.net/search/" role="search" title="Search"></a>
					</div>
				</nav>

				<div id="hdr" class="tc-l pv4-ns pv5-l pv2 ph3 ph4-ns">
					<h1 class="near-white mt1-ns f2 fw3 mb0 mt0 lh-title">Identify your OBIEE users by setting Client ID in Oracle connection</h1>
					<h2 class="near-white mt3-l mb4-l fw1 f6 f3-l measure-wide-l center lh-copy mt2 mb3">
						
						
							
								Published
								<time datetime="2010-01-26T00:00:00Z">Jan 26, 2010</time>
								<span class="display-print">by </span>
								 in <a href="https://rmoff.net/categories/obiee" class="no-underline category near-white dim">Obiee</a>, <a href="https://rmoff.net/categories/oracle" class="no-underline category near-white dim">Oracle</a>, <a href="https://rmoff.net/categories/support" class="no-underline category near-white dim">Support</a>
								<span class="display-print">at https://rmoff.net/2010/01/26/identify-your-obiee-users-by-setting-client-id-in-oracle-connection/</span>
							
						
					</h2>
				</div>

				
				
				
				

			</div>
		</header>
		
		<main role="main">
		
<article class="center bg-white br-3 pv1 ph4 lh-copy f5 nested-links mw8">
	<p>You get a call from your friendly DBA. He says the production database is up the spout, and it&rsquo;s &ldquo;that bee eye thingumy causing it&rdquo;. What do you do now? All you&rsquo;ve got to go on is a program name in the Oracle session tables of &ldquo;nqsserver@MYSERVER (TNS V1-V3)&rdquo; and the SQL the DBA sent you that if you&rsquo;re lucky will look as presentable as this: <img src="/images/rnm1978/2010-01-25_145658.png" alt="" title="2010-01-25_145658"> The username against the SQL is the generic User ID that you had created for connections to the database from OBIEE.</p>
<p>So you turn to Usage Tracking and discover that when that particular SQL ran there were twenty users all running reports. And not only that, but the SQL that&rsquo;s recorded is the Logical SQL, not the physical SQL.</p>
<p>So how do you identify the originating report that spawned the SQL that broke the database that upset the DBA that phoned you? &hellip;</p>
<p>With a large hat-tip to <a href="http://www.rittmanmead.com">Mark Rittman</a>, here&rsquo;s one thing you can do to help matters. Within the Connection Pool object in the RPD you can add statements to execute at the beginning of each connection. In this case, we can set the Client ID for the user running the request. [sourcecode] call dbms_session.set_identifier(&lsquo;VALUEOF(NQ_SESSION.USER)&rsquo;) [/sourcecode]</p>
<p><img src="/images/rnm1978/2010-01-25_150200.png" alt="" title="2010-01-25_150200"> <img src="/images/rnm1978/2010-01-25_150232.png" alt="" title="2010-01-25_150232"> <img src="/images/rnm1978/2010-01-25_150305.png" alt="" title="2010-01-25_150305"><img src="/images/rnm1978/2010-01-25_150721.png" alt="" title="2010-01-25_150721"></p>
<p>Now when you look at the queries from OBIEE running on the database you&rsquo;ll see the Client ID column is populated : <img src="/images/rnm1978/2010-01-25_155437.png" alt="" title="2010-01-25_155437"> <img src="/images/rnm1978/2010-01-26_090730.png" alt="" title="2010-01-26_090730"><img src="/images/rnm1978/2010-01-26_090712.png" alt="" title="2010-01-26_090712"><img src="/images/rnm1978/2010-01-26_090647.png" alt="" title="2010-01-26_090647"> This helps you trace SQL from the database back to the originating user.</p>
<p>My only question about this is with regards to connection pooling. <a href="http://download.oracle.com/docs/cd/E10415_01/doc/bi.1013/b31770.pdf">The documentation</a> states that the Execute on Connect is run &ldquo;&hellip;each time a connection is made to the database.&rdquo; - but if connection pooling is enabled then by definition the connection is re-used so the client ID will only be set for the first user into the connection pool. <strong>However</strong> this doesn&rsquo;t seem to be the case as on the database I see different Client IDs against the same session.</p>

</article>

		</main>
		
				<div class="hide-print sans-serif f6 f5-l mt5 ph3 pb6 center nested-copy-line-height lh-copy nested-links mw-100 measure-wide">
		<div class="about-the-author">
		
			
			
				
					<hr>
<p><img src="/images/2018/05/ksldn18-01.jpg" alt="Robin Moffatt"></p>
<p><a href="https://www.youtube.com/c/rmoff"><b class="fab fa-youtube-square"></b></a> <a href="https://www.linkedin.com/in/robinmoffatt/"><b class="fab fa-linkedin"></b></a> <em><a rel="me" href="https://data-folks.masto.host/@rmoff">Robin Moffatt</a> is a Principal DevEx Engineer at LakeFS. He likes writing about himself in the third person, eating good breakfasts, and drinking good beer.</em></p>

				
			
		
		</div>
		
	</div>

		
		
		
		<footer class="hide-print sans-serif f6 fw1 bg-black near-white bottom-0 w-100 pa3" role="contentinfo">
			<p class="w-50 fr tr">
			<a class="no-underline near-white" href="https://github.com/xaprb/story"><img class="dib" title="Made with Hugo and Story" alt="Story logo" src="https://rmoff.net/img/story-logo-white.svg" style="width: 1.5rem; height: 1.5rem" /></a>
			</p>
			<p class="w-50 near-white">
				&copy; 2023 
			</p>
		</footer>
		
	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-75492960-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

	
	</body>
</html>
